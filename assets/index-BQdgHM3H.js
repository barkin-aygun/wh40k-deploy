(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Un=!1;var na=Array.isArray,qi=Array.prototype.indexOf,In=Array.from,ja=Object.defineProperty,Tr=Object.getOwnPropertyDescriptor,Ya=Object.getOwnPropertyDescriptors,Gi=Object.prototype,Ji=Array.prototype,aa=Object.getPrototypeOf,_a=Object.isExtensible;const xr=()=>{};function Qi(e){return e()}function En(e){for(var r=0;r<e.length;r++)e[r]()}function Ha(){var e,r,n=new Promise((a,i)=>{e=a,r=i});return{promise:n,resolve:e,reject:r}}const yt=2,Tn=4,hn=8,Ba=1<<24,dr=16,fr=32,Ir=64,ia=128,It=512,ht=1024,_t=2048,Vt=4096,Pt=8192,sr=16384,sa=32768,Fr=65536,ma=1<<17,Fa=1<<18,qr=1<<19,Xa=1<<20,ir=1<<25,Ar=32768,Kn=1<<21,oa=1<<22,_r=1<<23,Pr=Symbol("$state"),es=Symbol("legacy props"),ts=Symbol(""),Wr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function la(){throw new Error("https://svelte.dev/e/invalid_default_snippet")}function Ua(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function rs(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function ns(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function as(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function is(e){throw new Error("https://svelte.dev/e/effect_orphan")}function ss(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function os(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function ls(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function cs(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function us(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function ds(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const fs=1,vs=2,Ka=4,hs=8,ys=16,gs=2,ps=4,xs=8,Za=1,_s=2,vt=Symbol(),ms="http://www.w3.org/1999/xhtml";function bs(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function za(e){return e===this.v}function Va(e,r){return e!=e?r==r:e!==r||e!==null&&typeof e=="object"||typeof e=="function"}function qa(e){return!Va(e,this.v)}let Gr=!1,ws=!1;function Ls(){Gr=!0}let Qe=null;function Xr(e){Qe=e}function jt(e,r=!1,n){Qe={p:Qe,i:!1,c:null,e:null,s:e,x:null,l:Gr&&!r?{s:null,u:null,$:[]}:null}}function Yt(e){var r=Qe,n=r.e;if(n!==null){r.e=null;for(var a of n)hi(a)}return e!==void 0&&(r.x=e),r.i=!0,Qe=r.p,e??{}}function yn(){return!Gr||Qe!==null&&Qe.l===null}let Er=[];function Ga(){var e=Er;Er=[],En(e)}function Jr(e){if(Er.length===0&&!ln){var r=Er;queueMicrotask(()=>{r===Er&&Ga()})}Er.push(e)}function Ss(){for(;Er.length>0;)Ga()}function Ja(e){var r=We;if(r===null)return Ce.f|=_r,e;if((r.f&sa)===0){if((r.f&ia)===0)throw e;r.b.error(e)}else Ur(e,r)}function Ur(e,r){for(;r!==null;){if((r.f&ia)!==0)try{r.b.error(e);return}catch(n){e=n}r=r.parent}throw e}const ks=-7169;function lt(e,r){e.f=e.f&ks|r}function ca(e){(e.f&It)!==0||e.deps===null?lt(e,ht):lt(e,Vt)}function Qa(e){if(e!==null)for(const r of e)(r.f&yt)===0||(r.f&Ar)===0||(r.f^=Ar,Qa(r.deps))}function ei(e,r,n){(e.f&_t)!==0?r.add(e):(e.f&Vt)!==0&&n.add(e),Qa(e.deps),lt(e,ht)}const pn=new Set;let Fe=null,kn=null,Ot=null,At=[],On=null,Zn=!1,ln=!1;class Kt{committed=!1;current=new Map;previous=new Map;#t=new Set;#s=new Set;#e=0;#a=0;#i=null;#n=new Set;#r=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#a>0}process(r){At=[],kn=null,this.apply();var n=[],a=[];for(const i of r)this.#o(i,n,a);this.is_fork||this.#c(),this.is_deferred()?(this.#l(a),this.#l(n)):(kn=this,Fe=null,ba(a),ba(n),kn=null,this.#i?.resolve()),Ot=null}#o(r,n,a){r.f^=ht;for(var i=r.first,s=null;i!==null;){var o=i.f,c=(o&(fr|Ir))!==0,l=c&&(o&ht)!==0,f=l||(o&Pt)!==0||this.skipped_effects.has(i);if(!f&&i.fn!==null){c?i.f^=ht:s!==null&&(o&(Tn|hn|Ba))!==0?s.b.defer_effect(i):(o&Tn)!==0?n.push(i):en(i)&&((o&dr)!==0&&this.#n.add(i),Zr(i));var v=i.first;if(v!==null){i=v;continue}}var g=i.parent;for(i=i.next;i===null&&g!==null;)g===s&&(s=null),i=g.next,g=g.parent}}#l(r){for(var n=0;n<r.length;n+=1)ei(r[n],this.#n,this.#r)}capture(r,n){n!==vt&&!this.previous.has(r)&&this.previous.set(r,n),(r.f&_r)===0&&(this.current.set(r,r.v),Ot?.set(r,r.v))}activate(){Fe=this,this.apply()}deactivate(){Fe===this&&(Fe=null,Ot=null)}flush(){if(this.activate(),At.length>0){if(ti(),Fe!==null&&Fe!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const r of this.#s)r(this);this.#s.clear()}#c(){if(this.#a===0){for(const r of this.#t)r();this.#t.clear()}this.#e===0&&this.#u()}#u(){if(pn.size>1){this.previous.clear();var r=Ot,n=!0;for(const i of pn){if(i===this){n=!1;continue}const s=[];for(const[c,l]of this.current){if(i.current.has(c))if(n&&l!==i.current.get(c))i.current.set(c,l);else continue;s.push(c)}if(s.length===0)continue;const o=[...i.current.keys()].filter(c=>!this.current.has(c));if(o.length>0){var a=At;At=[];const c=new Set,l=new Map;for(const f of s)ri(f,o,c,l);if(At.length>0){Fe=i,i.apply();for(const f of At)i.#o(f,[],[]);i.deactivate()}At=a}}Fe=null,Ot=r}this.committed=!0,pn.delete(this)}increment(r){this.#e+=1,r&&(this.#a+=1)}decrement(r){this.#e-=1,r&&(this.#a-=1),this.revive()}revive(){for(const r of this.#n)this.#r.delete(r),lt(r,_t),ur(r);for(const r of this.#r)lt(r,Vt),ur(r);this.flush()}oncommit(r){this.#t.add(r)}ondiscard(r){this.#s.add(r)}settled(){return(this.#i??=Ha()).promise}static ensure(){if(Fe===null){const r=Fe=new Kt;pn.add(Fe),ln||Kt.enqueue(()=>{Fe===r&&r.flush()})}return Fe}static enqueue(r){Jr(r)}apply(){}}function Ms(e){var r=ln;ln=!0;try{for(var n;;){if(Ss(),At.length===0&&(Fe?.flush(),At.length===0))return On=null,n;ti()}}finally{ln=r}}function ti(){var e=Dr;Zn=!0;var r=null;try{var n=0;for($n(!0);At.length>0;){var a=Kt.ensure();if(n++>1e3){var i,s;Es()}a.process(At),mr.clear()}}finally{Zn=!1,$n(e),On=null}}function Es(){try{ss()}catch(e){Ur(e,On)}}let er=null;function ba(e){var r=e.length;if(r!==0){for(var n=0;n<r;){var a=e[n++];if((a.f&(sr|Pt))===0&&en(a)&&(er=new Set,Zr(a),a.deps===null&&a.first===null&&a.nodes===null&&(a.teardown===null&&a.ac===null?pi(a):a.fn=null),er?.size>0)){mr.clear();for(const i of er){if((i.f&(sr|Pt))!==0)continue;const s=[i];let o=i.parent;for(;o!==null;)er.has(o)&&(er.delete(o),s.push(o)),o=o.parent;for(let c=s.length-1;c>=0;c--){const l=s[c];(l.f&(sr|Pt))===0&&Zr(l)}}er.clear()}}er=null}}function ri(e,r,n,a){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const i of e.reactions){const s=i.f;(s&yt)!==0?ri(i,r,n,a):(s&(oa|dr))!==0&&(s&_t)===0&&ni(i,r,a)&&(lt(i,_t),ur(i))}}function ni(e,r,n){const a=n.get(e);if(a!==void 0)return a;if(e.deps!==null)for(const i of e.deps){if(r.includes(i))return!0;if((i.f&yt)!==0&&ni(i,r,n))return n.set(i,!0),!0}return n.set(e,!1),!1}function ur(e){for(var r=On=e;r.parent!==null;){r=r.parent;var n=r.f;if(Zn&&r===We&&(n&dr)!==0&&(n&Fa)===0)return;if((n&(Ir|fr))!==0){if((n&ht)===0)return;r.f^=ht}}At.push(r)}function Ts(e){let r=0,n=Cr(0),a;return()=>{fa()&&(t(n),Qr(()=>(r===0&&(a=u(()=>e(()=>cn(n)))),r+=1,()=>{Jr(()=>{r-=1,r===0&&(a?.(),a=void 0,cn(n))})})))}}var Ps=Fr|qr|ia;function $s(e,r,n){new Ds(e,r,n)}class Ds{parent;is_pending=!1;#t;#s=null;#e;#a;#i;#n=null;#r=null;#o=null;#l=null;#c=null;#u=0;#d=0;#v=!1;#h=new Set;#y=new Set;#f=null;#m=Ts(()=>(this.#f=Cr(this.#u),()=>{this.#f=null}));constructor(r,n,a){this.#t=r,this.#e=n,this.#a=a,this.parent=We.b,this.is_pending=!!this.#e.pending,this.#i=va(()=>{We.b=this;{var i=this.#x();try{this.#n=Ct(()=>a(i))}catch(s){this.error(s)}this.#d>0?this.#p():this.is_pending=!1}return()=>{this.#c?.remove()}},Ps)}#b(){try{this.#n=Ct(()=>this.#a(this.#t))}catch(r){this.error(r)}}#w(){const r=this.#e.pending;r&&(this.#r=Ct(()=>r(this.#t)),Kt.enqueue(()=>{var n=this.#x();this.#n=this.#g(()=>(Kt.ensure(),Ct(()=>this.#a(n)))),this.#d>0?this.#p():($r(this.#r,()=>{this.#r=null}),this.is_pending=!1)}))}#x(){var r=this.#t;return this.is_pending&&(this.#c=or(),this.#t.before(this.#c),r=this.#c),r}defer_effect(r){ei(r,this.#h,this.#y)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(r){var n=We,a=Ce,i=Qe;zt(this.#i),bt(this.#i),Xr(this.#i.ctx);try{return r()}catch(s){return Ja(s),null}finally{zt(n),bt(a),Xr(i)}}#p(){const r=this.#e.pending;this.#n!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#c),mi(this.#n,this.#l)),this.#r===null&&(this.#r=Ct(()=>r(this.#t)))}#_(r){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(r);return}if(this.#d+=r,this.#d===0){this.is_pending=!1;for(const n of this.#h)lt(n,_t),ur(n);for(const n of this.#y)lt(n,Vt),ur(n);this.#h.clear(),this.#y.clear(),this.#r&&$r(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null)}}update_pending_count(r){this.#_(r),this.#u+=r,this.#f&&Kr(this.#f,this.#u)}get_effect_pending(){return this.#m(),t(this.#f)}error(r){var n=this.#e.onerror;let a=this.#e.failed;if(this.#v||!n&&!a)throw r;this.#n&&(wt(this.#n),this.#n=null),this.#r&&(wt(this.#r),this.#r=null),this.#o&&(wt(this.#o),this.#o=null);var i=!1,s=!1;const o=()=>{if(i){bs();return}i=!0,s&&ds(),Kt.ensure(),this.#u=0,this.#o!==null&&$r(this.#o,()=>{this.#o=null}),this.is_pending=this.has_pending_snippet(),this.#n=this.#g(()=>(this.#v=!1,Ct(()=>this.#a(this.#t)))),this.#d>0?this.#p():this.is_pending=!1};var c=Ce;try{bt(null),s=!0,n?.(r,o),s=!1}catch(l){Ur(l,this.#i&&this.#i.parent)}finally{bt(c)}a&&Jr(()=>{this.#o=this.#g(()=>{Kt.ensure(),this.#v=!0;try{return Ct(()=>{a(this.#t,()=>r,()=>o)})}catch(l){return Ur(l,this.#i.parent),null}finally{this.#v=!1}})})}}function Rs(e,r,n,a){const i=yn()?ua:Xe;if(n.length===0&&e.length===0){a(r.map(i));return}var s=Fe,o=We,c=As();function l(){Promise.all(n.map(f=>Cs(f))).then(f=>{c();try{a([...r.map(i),...f])}catch(v){(o.f&sr)===0&&Ur(v,o)}s?.deactivate(),Pn()}).catch(f=>{Ur(f,o)})}e.length>0?Promise.all(e).then(()=>{c();try{return l()}finally{s?.deactivate(),Pn()}}):l()}function As(){var e=We,r=Ce,n=Qe,a=Fe;return function(s=!0){zt(e),bt(r),Xr(n),s&&a?.activate()}}function Pn(){zt(null),bt(null),Xr(null)}function ua(e){var r=yt|_t,n=Ce!==null&&(Ce.f&yt)!==0?Ce:null;return We!==null&&(We.f|=qr),{ctx:Qe,deps:null,effects:null,equals:za,f:r,fn:e,reactions:null,rv:0,v:vt,wv:0,parent:n??We,ac:null}}function Cs(e,r,n){let a=We;a===null&&rs();var i=a.b,s=void 0,o=Cr(vt),c=!Ce,l=new Map;return Xs(()=>{var f=Ha();s=f.promise;try{Promise.resolve(e()).then(f.resolve,f.reject).then(()=>{v===Fe&&v.committed&&v.deactivate(),Pn()})}catch(h){f.reject(h),Pn()}var v=Fe;if(c){var g=i.is_rendered();i.update_pending_count(1),v.increment(g),l.get(v)?.reject(Wr),l.delete(v),l.set(v,f)}const _=(h,S=void 0)=>{if(v.activate(),S)S!==Wr&&(o.f|=_r,Kr(o,S));else{(o.f&_r)!==0&&(o.f^=_r),Kr(o,h);for(const[E,w]of l){if(l.delete(E),E===v)break;w.reject(Wr)}}c&&(i.update_pending_count(-1),v.decrement(g))};f.promise.then(_,h=>_(null,h||"unknown"))}),Wn(()=>{for(const f of l.values())f.reject(Wr)}),new Promise(f=>{function v(g){function _(){g===s?f(o):v(s)}g.then(_,_)}v(s)})}function Xe(e){const r=ua(e);return r.equals=qa,r}function ai(e){var r=e.effects;if(r!==null){e.effects=null;for(var n=0;n<r.length;n+=1)wt(r[n])}}function Is(e){for(var r=e.parent;r!==null;){if((r.f&yt)===0)return(r.f&sr)===0?r:null;r=r.parent}return null}function da(e){var r,n=We;zt(Is(e));try{e.f&=~Ar,ai(e),r=Si(e)}finally{zt(n)}return r}function ii(e){var r=da(e);if(!e.equals(r)&&(e.wv=wi(),(!Fe?.is_fork||e.deps===null)&&(e.v=r,e.deps===null))){lt(e,ht);return}br||(Ot!==null?(fa()||Fe?.is_fork)&&Ot.set(e,r):ca(e))}let zn=new Set;const mr=new Map;let si=!1;function Cr(e,r){var n={f:0,v:e,reactions:null,equals:za,rv:0,wv:0};return n}function hr(e,r){const n=Cr(e);return Zs(n),n}function R(e,r=!1,n=!0){const a=Cr(e);return r||(a.equals=qa),Gr&&n&&Qe!==null&&Qe.l!==null&&(Qe.l.s??=[]).push(a),a}function m(e,r,n=!1){Ce!==null&&(!Nt||(Ce.f&ma)!==0)&&yn()&&(Ce.f&(yt|dr|oa|ma))!==0&&!lr?.includes(e)&&us();let a=n?jr(r):r;return Kr(e,a)}function Kr(e,r){if(!e.equals(r)){var n=e.v;br?mr.set(e,r):mr.set(e,n),e.v=r;var a=Kt.ensure();if(a.capture(e,n),(e.f&yt)!==0){const i=e;(e.f&_t)!==0&&da(i),ca(i)}e.wv=wi(),oi(e,_t),yn()&&We!==null&&(We.f&ht)!==0&&(We.f&(fr|Ir))===0&&(Rt===null?zs([e]):Rt.push(e)),!a.is_fork&&zn.size>0&&!si&&Os()}return r}function Os(){si=!1;var e=Dr;$n(!0);const r=Array.from(zn);try{for(const n of r)(n.f&ht)!==0&&lt(n,Vt),en(n)&&Zr(n)}finally{$n(e)}zn.clear()}function cn(e){m(e,e.v+1)}function oi(e,r){var n=e.reactions;if(n!==null)for(var a=yn(),i=n.length,s=0;s<i;s++){var o=n[s],c=o.f;if(!(!a&&o===We)){var l=(c&_t)===0;if(l&&lt(o,r),(c&yt)!==0){var f=o;Ot?.delete(f),(c&Ar)===0&&(c&It&&(o.f|=Ar),oi(f,Vt))}else l&&((c&dr)!==0&&er!==null&&er.add(o),ur(o))}}}function jr(e){if(typeof e!="object"||e===null||Pr in e)return e;const r=aa(e);if(r!==Gi&&r!==Ji)return e;var n=new Map,a=na(e),i=hr(0),s=Rr,o=c=>{if(Rr===s)return c();var l=Ce,f=Rr;bt(null),Sa(s);var v=c();return bt(l),Sa(f),v};return a&&n.set("length",hr(e.length)),new Proxy(e,{defineProperty(c,l,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&ls();var v=n.get(l);return v===void 0?v=o(()=>{var g=hr(f.value);return n.set(l,g),g}):m(v,f.value,!0),!0},deleteProperty(c,l){var f=n.get(l);if(f===void 0){if(l in c){const v=o(()=>hr(vt));n.set(l,v),cn(i)}}else m(f,vt),cn(i);return!0},get(c,l,f){if(l===Pr)return e;var v=n.get(l),g=l in c;if(v===void 0&&(!g||Tr(c,l)?.writable)&&(v=o(()=>{var h=jr(g?c[l]:vt),S=hr(h);return S}),n.set(l,v)),v!==void 0){var _=t(v);return _===vt?void 0:_}return Reflect.get(c,l,f)},getOwnPropertyDescriptor(c,l){var f=Reflect.getOwnPropertyDescriptor(c,l);if(f&&"value"in f){var v=n.get(l);v&&(f.value=t(v))}else if(f===void 0){var g=n.get(l),_=g?.v;if(g!==void 0&&_!==vt)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return f},has(c,l){if(l===Pr)return!0;var f=n.get(l),v=f!==void 0&&f.v!==vt||Reflect.has(c,l);if(f!==void 0||We!==null&&(!v||Tr(c,l)?.writable)){f===void 0&&(f=o(()=>{var _=v?jr(c[l]):vt,h=hr(_);return h}),n.set(l,f));var g=t(f);if(g===vt)return!1}return v},set(c,l,f,v){var g=n.get(l),_=l in c;if(a&&l==="length")for(var h=f;h<g.v;h+=1){var S=n.get(h+"");S!==void 0?m(S,vt):h in c&&(S=o(()=>hr(vt)),n.set(h+"",S))}if(g===void 0)(!_||Tr(c,l)?.writable)&&(g=o(()=>hr(void 0)),m(g,jr(f)),n.set(l,g));else{_=g.v!==vt;var E=o(()=>jr(f));m(g,E)}var w=Reflect.getOwnPropertyDescriptor(c,l);if(w?.set&&w.set.call(v,f),!_){if(a&&typeof l=="string"){var L=n.get("length"),O=Number(l);Number.isInteger(O)&&O>=L.v&&m(L,O+1)}cn(i)}return!0},ownKeys(c){t(i);var l=Reflect.ownKeys(c).filter(g=>{var _=n.get(g);return _===void 0||_.v!==vt});for(var[f,v]of n)v.v!==vt&&!(f in c)&&l.push(f);return l},setPrototypeOf(){cs()}})}var Yr,li,ci,ui;function Ns(){if(Yr===void 0){Yr=window,li=/Firefox/.test(navigator.userAgent);var e=Element.prototype,r=Node.prototype,n=Text.prototype;ci=Tr(r,"firstChild").get,ui=Tr(r,"nextSibling").get,_a(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),_a(n)&&(n.__t=void 0)}}function or(e=""){return document.createTextNode(e)}function nr(e){return ci.call(e)}function gn(e){return ui.call(e)}function x(e,r){return nr(e)}function xe(e,r=!1){{var n=nr(e);return n instanceof Comment&&n.data===""?gn(n):n}}function p(e,r=1,n=!1){let a=e;for(;r--;)a=gn(a);return a}function Ws(e){e.textContent=""}function di(){return!1}let wa=!1;function js(){wa||(wa=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const r of e.target.elements)r.__on_r?.()})},{capture:!0}))}function Nn(e){var r=Ce,n=We;bt(null),zt(null);try{return e()}finally{bt(r),zt(n)}}function fi(e,r,n,a=n){e.addEventListener(r,()=>Nn(n));const i=e.__on_r;i?e.__on_r=()=>{i(),a(!0)}:e.__on_r=()=>a(!0),js()}function vi(e){We===null&&(Ce===null&&is(),as()),br&&ns()}function Ys(e,r){var n=r.last;n===null?r.last=r.first=e:(n.next=e,e.prev=n,r.last=e)}function qt(e,r,n){var a=We;a!==null&&(a.f&Pt)!==0&&(e|=Pt);var i={ctx:Qe,deps:null,nodes:null,f:e|_t|It,first:null,fn:r,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Zr(i),i.f|=sa}catch(c){throw wt(i),c}else r!==null&&ur(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&qr)===0&&(s=s.first,(e&dr)!==0&&(e&Fr)!==0&&s!==null&&(s.f|=Fr)),s!==null&&(s.parent=a,a!==null&&Ys(s,a),Ce!==null&&(Ce.f&yt)!==0&&(e&Ir)===0)){var o=Ce;(o.effects??=[]).push(s)}return i}function fa(){return Ce!==null&&!Nt}function Wn(e){const r=qt(hn,null,!1);return lt(r,ht),r.teardown=e,r}function Vn(e){vi();var r=We.f,n=!Ce&&(r&fr)!==0&&(r&sa)===0;if(n){var a=Qe;(a.e??=[]).push(e)}else return hi(e)}function hi(e){return qt(Tn|Xa,e,!1)}function Hs(e){return vi(),qt(hn|Xa,e,!0)}function Bs(e){Kt.ensure();const r=qt(Ir|qr,e,!0);return(n={})=>new Promise(a=>{n.outro?$r(r,()=>{wt(r),a(void 0)}):(wt(r),a(void 0))})}function Fs(e){return qt(Tn,e,!1)}function q(e,r){var n=Qe,a={effect:null,ran:!1,deps:e};n.l.$.push(a),a.effect=Qr(()=>{e(),!a.ran&&(a.ran=!0,u(r))})}function wr(){var e=Qe;Qr(()=>{for(var r of e.l.$){r.deps();var n=r.effect;(n.f&ht)!==0&&n.deps!==null&&lt(n,Vt),en(n)&&Zr(n),r.ran=!1}})}function Xs(e){return qt(oa|qr,e,!0)}function Qr(e,r=0){return qt(hn|r,e,!0)}function Y(e,r=[],n=[],a=[]){Rs(a,r,n,i=>{qt(hn,()=>e(...i.map(t)),!0)})}function va(e,r=0){var n=qt(dr|r,e,!0);return n}function Ct(e){return qt(fr|qr,e,!0)}function yi(e){var r=e.teardown;if(r!==null){const n=br,a=Ce;La(!0),bt(null);try{r.call(null)}finally{La(n),bt(a)}}}function gi(e,r=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const i=n.ac;i!==null&&Nn(()=>{i.abort(Wr)});var a=n.next;(n.f&Ir)!==0?n.parent=null:wt(n,r),n=a}}function Us(e){for(var r=e.first;r!==null;){var n=r.next;(r.f&fr)===0&&wt(r),r=n}}function wt(e,r=!0){var n=!1;(r||(e.f&Fa)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Ks(e.nodes.start,e.nodes.end),n=!0),gi(e,r&&!n),Dn(e,0),lt(e,sr);var a=e.nodes&&e.nodes.t;if(a!==null)for(const s of a)s.stop();yi(e);var i=e.parent;i!==null&&i.first!==null&&pi(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Ks(e,r){for(;e!==null;){var n=e===r?null:gn(e);e.remove(),e=n}}function pi(e){var r=e.parent,n=e.prev,a=e.next;n!==null&&(n.next=a),a!==null&&(a.prev=n),r!==null&&(r.first===e&&(r.first=a),r.last===e&&(r.last=n))}function $r(e,r,n=!0){var a=[];xi(e,a,!0);var i=()=>{n&&wt(e),r&&r()},s=a.length;if(s>0){var o=()=>--s||i();for(var c of a)c.out(o)}else i()}function xi(e,r,n){if((e.f&Pt)===0){e.f^=Pt;var a=e.nodes&&e.nodes.t;if(a!==null)for(const c of a)(c.is_global||n)&&r.push(c);for(var i=e.first;i!==null;){var s=i.next,o=(i.f&Fr)!==0||(i.f&fr)!==0&&(e.f&dr)!==0;xi(i,r,o?n:!1),i=s}}}function ha(e){_i(e,!0)}function _i(e,r){if((e.f&Pt)!==0){e.f^=Pt,(e.f&ht)===0&&(lt(e,_t),ur(e));for(var n=e.first;n!==null;){var a=n.next,i=(n.f&Fr)!==0||(n.f&fr)!==0;_i(n,i?r:!1),n=a}var s=e.nodes&&e.nodes.t;if(s!==null)for(const o of s)(o.is_global||r)&&o.in()}}function mi(e,r){if(e.nodes)for(var n=e.nodes.start,a=e.nodes.end;n!==null;){var i=n===a?null:gn(n);r.append(n),n=i}}let Dr=!1;function $n(e){Dr=e}let br=!1;function La(e){br=e}let Ce=null,Nt=!1;function bt(e){Ce=e}let We=null;function zt(e){We=e}let lr=null;function Zs(e){Ce!==null&&(lr===null?lr=[e]:lr.push(e))}let xt=null,Et=0,Rt=null;function zs(e){Rt=e}let bi=1,fn=0,Rr=fn;function Sa(e){Rr=e}function wi(){return++bi}function en(e){var r=e.f;if((r&_t)!==0)return!0;if(r&yt&&(e.f&=~Ar),(r&Vt)!==0){for(var n=e.deps,a=n.length,i=0;i<a;i++){var s=n[i];if(en(s)&&ii(s),s.wv>e.wv)return!0}(r&It)!==0&&Ot===null&&lt(e,ht)}return!1}function Li(e,r,n=!0){var a=e.reactions;if(a!==null&&!lr?.includes(e))for(var i=0;i<a.length;i++){var s=a[i];(s.f&yt)!==0?Li(s,r,!1):r===s&&(n?lt(s,_t):(s.f&ht)!==0&&lt(s,Vt),ur(s))}}function Si(e){var r=xt,n=Et,a=Rt,i=Ce,s=lr,o=Qe,c=Nt,l=Rr,f=e.f;xt=null,Et=0,Rt=null,Ce=(f&(fr|Ir))===0?e:null,lr=null,Xr(e.ctx),Nt=!1,Rr=++fn,e.ac!==null&&(Nn(()=>{e.ac.abort(Wr)}),e.ac=null);try{e.f|=Kn;var v=e.fn,g=v(),_=e.deps;if(xt!==null){var h;if(Dn(e,Et),_!==null&&Et>0)for(_.length=Et+xt.length,h=0;h<xt.length;h++)_[Et+h]=xt[h];else e.deps=_=xt;if(fa()&&(e.f&It)!==0)for(h=Et;h<_.length;h++)(_[h].reactions??=[]).push(e)}else _!==null&&Et<_.length&&(Dn(e,Et),_.length=Et);if(yn()&&Rt!==null&&!Nt&&_!==null&&(e.f&(yt|Vt|_t))===0)for(h=0;h<Rt.length;h++)Li(Rt[h],e);return i!==null&&i!==e&&(fn++,Rt!==null&&(a===null?a=Rt:a.push(...Rt))),(e.f&_r)!==0&&(e.f^=_r),g}catch(S){return Ja(S)}finally{e.f^=Kn,xt=r,Et=n,Rt=a,Ce=i,lr=s,Xr(o),Nt=c,Rr=l}}function Vs(e,r){let n=r.reactions;if(n!==null){var a=qi.call(n,e);if(a!==-1){var i=n.length-1;i===0?n=r.reactions=null:(n[a]=n[i],n.pop())}}if(n===null&&(r.f&yt)!==0&&(xt===null||!xt.includes(r))){var s=r;(s.f&It)!==0&&(s.f^=It,s.f&=~Ar),ca(s),ai(s),Dn(s,0)}}function Dn(e,r){var n=e.deps;if(n!==null)for(var a=r;a<n.length;a++)Vs(e,n[a])}function Zr(e){var r=e.f;if((r&sr)===0){lt(e,ht);var n=We,a=Dr;We=e,Dr=!0;try{(r&(dr|Ba))!==0?Us(e):gi(e),yi(e);var i=Si(e);e.teardown=typeof i=="function"?i:null,e.wv=bi;var s;Un&&ws&&(e.f&_t)!==0&&e.deps}finally{Dr=a,We=n}}}async function qs(){await Promise.resolve(),Ms()}function t(e){var r=e.f,n=(r&yt)!==0;if(Ce!==null&&!Nt){var a=We!==null&&(We.f&sr)!==0;if(!a&&!lr?.includes(e)){var i=Ce.deps;if((Ce.f&Kn)!==0)e.rv<fn&&(e.rv=fn,xt===null&&i!==null&&i[Et]===e?Et++:xt===null?xt=[e]:xt.includes(e)||xt.push(e));else{(Ce.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[Ce]:s.includes(Ce)||s.push(Ce)}}}if(br&&mr.has(e))return mr.get(e);if(n){var o=e;if(br){var c=o.v;return((o.f&ht)===0&&o.reactions!==null||Mi(o))&&(c=da(o)),mr.set(o,c),c}var l=(o.f&It)===0&&!Nt&&Ce!==null&&(Dr||(Ce.f&It)!==0),f=o.deps===null;en(o)&&(l&&(o.f|=It),ii(o)),l&&!f&&ki(o)}if(Ot?.has(e))return Ot.get(e);if((e.f&_r)!==0)throw e.v;return e.v}function ki(e){if(e.deps!==null){e.f|=It;for(const r of e.deps)(r.reactions??=[]).push(e),(r.f&yt)!==0&&(r.f&It)===0&&ki(r)}}function Mi(e){if(e.v===vt)return!0;if(e.deps===null)return!1;for(const r of e.deps)if(mr.has(r)||(r.f&yt)!==0&&Mi(r))return!0;return!1}function u(e){var r=Nt;try{return Nt=!0,e()}finally{Nt=r}}function W(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Pr in e)qn(e);else if(!Array.isArray(e))for(let r in e){const n=e[r];typeof n=="object"&&n&&Pr in n&&qn(n)}}}function qn(e,r=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!r.has(e)){r.add(e),e instanceof Date&&e.getTime();for(let a in e)try{qn(e[a],r)}catch{}const n=aa(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const a=Ya(n);for(let i in a){const s=a[i].get;if(s)try{s.call(e)}catch{}}}}}const Gs=["touchstart","touchmove"];function Js(e){return Gs.includes(e)}const Qs=new Set,ka=new Set;function eo(e,r,n,a={}){function i(s){if(a.capture||rn.call(r,s),!s.cancelBubble)return Nn(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Jr(()=>{r.addEventListener(e,i,a)}):r.addEventListener(e,i,a),i}function U(e,r,n,a,i){var s={capture:a,passive:i},o=eo(e,r,n,s);(r===document.body||r===window||r===document||r instanceof HTMLMediaElement)&&Wn(()=>{r.removeEventListener(e,o,s)})}let Ma=null;function rn(e){var r=this,n=r.ownerDocument,a=e.type,i=e.composedPath?.()||[],s=i[0]||e.target;Ma=e;var o=0,c=Ma===e&&e.__root;if(c){var l=i.indexOf(c);if(l!==-1&&(r===document||r===window)){e.__root=r;return}var f=i.indexOf(r);if(f===-1)return;l<=f&&(o=l)}if(s=i[o]||e.target,s!==r){ja(e,"currentTarget",{configurable:!0,get(){return s||n}});var v=Ce,g=We;bt(null),zt(null);try{for(var _,h=[];s!==null;){var S=s.assignedSlot||s.parentNode||s.host||null;try{var E=s["__"+a];E!=null&&(!s.disabled||e.target===s)&&E.call(s,e)}catch(w){_?h.push(w):_=w}if(e.cancelBubble||S===r||S===null)break;s=S}if(_){for(let w of h)queueMicrotask(()=>{throw w});throw _}}finally{e.__root=r,delete e.currentTarget,bt(v),zt(g)}}}function Ei(e){var r=document.createElement("template");return r.innerHTML=e.replaceAll("<!>","<!---->"),r.content}function zr(e,r){var n=We;n.nodes===null&&(n.nodes={start:e,end:r,a:null,t:null})}function le(e,r){var n=(r&Za)!==0,a=(r&_s)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=Ei(s?e:"<!>"+e),n||(i=nr(i)));var o=a||li?document.importNode(i,!0):i.cloneNode(!0);if(n){var c=nr(o),l=o.lastChild;zr(c,l)}else zr(o,o);return o}}function to(e,r,n="svg"){var a=!e.startsWith("<!>"),i=(r&Za)!==0,s=`<${n}>${a?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var c=Ei(s),l=nr(c);if(i)for(o=document.createDocumentFragment();nr(l);)o.appendChild(nr(l));else o=nr(l)}var f=o.cloneNode(!0);if(i){var v=nr(f),g=f.lastChild;zr(v,g)}else zr(f,f);return f}}function ce(e,r){return to(e,r,"svg")}function Ti(e=""){{var r=or(e+"");return zr(r,r),r}}function tt(){var e=document.createDocumentFragment(),r=document.createComment(""),n=or();return e.append(r,n),zr(r,n),e}function b(e,r){e!==null&&e.before(r)}function ke(e,r){var n=r==null?"":typeof r=="object"?r+"":r;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function ro(e,r){return no(e,r)}const Or=new Map;function no(e,{target:r,anchor:n,props:a={},events:i,context:s,intro:o=!0}){Ns();var c=new Set,l=g=>{for(var _=0;_<g.length;_++){var h=g[_];if(!c.has(h)){c.add(h);var S=Js(h);r.addEventListener(h,rn,{passive:S});var E=Or.get(h);E===void 0?(document.addEventListener(h,rn,{passive:S}),Or.set(h,1)):Or.set(h,E+1)}}};l(In(Qs)),ka.add(l);var f=void 0,v=Bs(()=>{var g=n??r.appendChild(or());return $s(g,{pending:()=>{}},_=>{if(s){jt({});var h=Qe;h.c=s}i&&(a.$$events=i),f=e(_,a)||{},s&&Yt()}),()=>{for(var _ of c){r.removeEventListener(_,rn);var h=Or.get(_);--h===0?(document.removeEventListener(_,rn),Or.delete(_)):Or.set(_,h)}ka.delete(l),g!==n&&g.parentNode?.removeChild(g)}});return ao.set(f,v),f}let ao=new WeakMap;class io{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#i=!0;constructor(r,n=!0){this.anchor=r,this.#i=n}#n=()=>{var r=Fe;if(this.#t.has(r)){var n=this.#t.get(r),a=this.#s.get(n);if(a)ha(a),this.#a.delete(n);else{var i=this.#e.get(n);i&&(this.#s.set(n,i.effect),this.#e.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[s,o]of this.#t){if(this.#t.delete(s),s===r)break;const c=this.#e.get(o);c&&(wt(c.effect),this.#e.delete(o))}for(const[s,o]of this.#s){if(s===n||this.#a.has(s))continue;const c=()=>{if(Array.from(this.#t.values()).includes(s)){var f=document.createDocumentFragment();mi(o,f),f.append(or()),this.#e.set(s,{effect:o,fragment:f})}else wt(o);this.#a.delete(s),this.#s.delete(s)};this.#i||!a?(this.#a.add(s),$r(o,c,!1)):c()}}};#r=r=>{this.#t.delete(r);const n=Array.from(this.#t.values());for(const[a,i]of this.#e)n.includes(a)||(wt(i.effect),this.#e.delete(a))};ensure(r,n){var a=Fe,i=di();if(n&&!this.#s.has(r)&&!this.#e.has(r))if(i){var s=document.createDocumentFragment(),o=or();s.append(o),this.#e.set(r,{effect:Ct(()=>n(o)),fragment:s})}else this.#s.set(r,Ct(()=>n(this.anchor)));if(this.#t.set(a,r),i){for(const[c,l]of this.#s)c===r?a.skipped_effects.delete(l):a.skipped_effects.add(l);for(const[c,l]of this.#e)c===r?a.skipped_effects.delete(l.effect):a.skipped_effects.add(l.effect);a.oncommit(this.#n),a.ondiscard(this.#r)}else this.#n()}}function oe(e,r,n=!1){var a=new io(e),i=n?Fr:0;function s(o,c){a.ensure(o,c)}va(()=>{var o=!1;r((c,l=!0)=>{o=!0,s(l,c)}),o||s(!1,null)},i)}function Ie(e,r){return r}function so(e,r,n){for(var a=[],i=r.length,s,o=r.length,c=0;c<i;c++){let g=r[c];$r(g,()=>{if(s){if(s.pending.delete(g),s.done.add(g),s.pending.size===0){var _=e.outrogroups;Gn(In(s.done)),_.delete(s),_.size===0&&(e.outrogroups=null)}}else o-=1},!1)}if(o===0){var l=a.length===0&&n!==null;if(l){var f=n,v=f.parentNode;Ws(v),v.append(f),e.items.clear()}Gn(r,!l)}else s={pending:new Set(r),done:new Set},(e.outrogroups??=new Set).add(s)}function Gn(e,r=!0){for(var n=0;n<e.length;n++)wt(e[n],r)}var Ea;function Se(e,r,n,a,i,s=null){var o=e,c=new Map,l=(r&Ka)!==0;if(l){var f=e;o=f.appendChild(or())}var v=null,g=Xe(()=>{var L=n();return na(L)?L:L==null?[]:In(L)}),_,h=!0;function S(){w.fallback=v,oo(w,_,o,r,a),v!==null&&(_.length===0?(v.f&ir)===0?ha(v):(v.f^=ir,nn(v,null,o)):$r(v,()=>{v=null}))}var E=va(()=>{_=t(g);for(var L=_.length,O=new Set,F=Fe,G=di(),K=0;K<L;K+=1){var ue=_[K],fe=a(ue,K),j=h?null:c.get(fe);j?(j.v&&Kr(j.v,ue),j.i&&Kr(j.i,K),G&&F.skipped_effects.delete(j.e)):(j=lo(c,h?o:Ea??=or(),ue,fe,K,i,r,n),h||(j.e.f|=ir),c.set(fe,j)),O.add(fe)}if(L===0&&s&&!v&&(h?v=Ct(()=>s(o)):(v=Ct(()=>s(Ea??=or())),v.f|=ir)),!h)if(G){for(const[se,ee]of c)O.has(se)||F.skipped_effects.add(ee.e);F.oncommit(S),F.ondiscard(()=>{})}else S();t(g)}),w={effect:E,items:c,outrogroups:null,fallback:v};h=!1}function oo(e,r,n,a,i){var s=(a&hs)!==0,o=r.length,c=e.items,l=e.effect.first,f,v=null,g,_=[],h=[],S,E,w,L;if(s)for(L=0;L<o;L+=1)S=r[L],E=i(S,L),w=c.get(E).e,(w.f&ir)===0&&(w.nodes?.a?.measure(),(g??=new Set).add(w));for(L=0;L<o;L+=1){if(S=r[L],E=i(S,L),w=c.get(E).e,e.outrogroups!==null)for(const ee of e.outrogroups)ee.pending.delete(w),ee.done.delete(w);if((w.f&ir)!==0)if(w.f^=ir,w===l)nn(w,null,n);else{var O=v?v.next:l;w===e.effect.last&&(e.effect.last=w.prev),w.prev&&(w.prev.next=w.next),w.next&&(w.next.prev=w.prev),yr(e,v,w),yr(e,w,O),nn(w,O,n),v=w,_=[],h=[],l=v.next;continue}if((w.f&Pt)!==0&&(ha(w),s&&(w.nodes?.a?.unfix(),(g??=new Set).delete(w))),w!==l){if(f!==void 0&&f.has(w)){if(_.length<h.length){var F=h[0],G;v=F.prev;var K=_[0],ue=_[_.length-1];for(G=0;G<_.length;G+=1)nn(_[G],F,n);for(G=0;G<h.length;G+=1)f.delete(h[G]);yr(e,K.prev,ue.next),yr(e,v,K),yr(e,ue,F),l=F,v=ue,L-=1,_=[],h=[]}else f.delete(w),nn(w,l,n),yr(e,w.prev,w.next),yr(e,w,v===null?e.effect.first:v.next),yr(e,v,w),v=w;continue}for(_=[],h=[];l!==null&&l!==w;)(f??=new Set).add(l),h.push(l),l=l.next;if(l===null)continue}(w.f&ir)===0&&_.push(w),v=w,l=w.next}if(e.outrogroups!==null){for(const ee of e.outrogroups)ee.pending.size===0&&(Gn(In(ee.done)),e.outrogroups?.delete(ee));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||f!==void 0){var fe=[];if(f!==void 0)for(w of f)(w.f&Pt)===0&&fe.push(w);for(;l!==null;)(l.f&Pt)===0&&l!==e.fallback&&fe.push(l),l=l.next;var j=fe.length;if(j>0){var se=(a&Ka)!==0&&o===0?n:null;if(s){for(L=0;L<j;L+=1)fe[L].nodes?.a?.measure();for(L=0;L<j;L+=1)fe[L].nodes?.a?.fix()}so(e,fe,se)}}s&&Jr(()=>{if(g!==void 0)for(w of g)w.nodes?.a?.apply()})}function lo(e,r,n,a,i,s,o,c){var l=(o&fs)!==0?(o&ys)===0?R(n,!1,!1):Cr(n):null,f=(o&vs)!==0?Cr(i):null;return{v:l,i:f,e:Ct(()=>(s(r,l??n,f??i,c),()=>{e.delete(a)}))}}function nn(e,r,n){if(e.nodes)for(var a=e.nodes.start,i=e.nodes.end,s=r&&(r.f&ir)===0?r.nodes.start:n;a!==null;){var o=gn(a);if(s.before(a),a===i)return;a=o}}function yr(e,r,n){r===null?e.effect.first=n:r.next=n,n===null?e.effect.last=r:n.prev=r}function Pi(e,r,n,a,i){var s=r.$$slots?.[n],o=!1;s===!0&&(s=r.children,o=!0),s===void 0||s(e,o?()=>a:a)}const Ta=[...` 	
\r\fÂ \v\uFEFF`];function co(e,r,n){var a=e==null?"":""+e;if(n){for(var i in n)if(n[i])a=a?a+" "+i:i;else if(a.length)for(var s=i.length,o=0;(o=a.indexOf(i,o))>=0;){var c=o+s;(o===0||Ta.includes(a[o-1]))&&(c===a.length||Ta.includes(a[c]))?a=(o===0?"":a.substring(0,o))+a.substring(c+1):o=c}}return a===""?null:a}function uo(e,r){return e==null?null:String(e)}function Zt(e,r,n,a,i,s){var o=e.__className;if(o!==n||o===void 0){var c=co(n,a,s);c==null?e.removeAttribute("class"):r?e.className=c:e.setAttribute("class",c),e.__className=n}else if(s&&i!==s)for(var l in s){var f=!!s[l];(i==null||f!==!!i[l])&&e.classList.toggle(l,f)}return s}function fo(e,r,n,a){var i=e.__style;if(i!==r){var s=uo(r);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=r}return a}const vo=Symbol("is custom element"),ho=Symbol("is html");function yo(e,r){var n=$i(e);n.value===(n.value=r??void 0)||e.value===r&&(r!==0||e.nodeName!=="PROGRESS")||(e.value=r??"")}function d(e,r,n,a){var i=$i(e);i[r]!==(i[r]=n)&&(r==="loading"&&(e[ts]=n),n==null?e.removeAttribute(r):typeof n!="string"&&go(e).includes(r)?e[r]=n:e.setAttribute(r,n))}function $i(e){return e.__attributes??={[vo]:e.nodeName.includes("-"),[ho]:e.namespaceURI===ms}}var Pa=new Map;function go(e){var r=e.getAttribute("is")||e.nodeName,n=Pa.get(r);if(n)return n;Pa.set(r,n=[]);for(var a,i=e,s=Element.prototype;s!==i;){a=Ya(i);for(var o in a)a[o].set&&n.push(o);i=aa(i)}return n}function un(e,r,n=r){var a=new WeakSet;fi(e,"input",async i=>{var s=i?e.defaultValue:e.value;if(s=Fn(e)?Xn(s):s,n(s),Fe!==null&&a.add(Fe),await qs(),s!==(s=r())){var o=e.selectionStart,c=e.selectionEnd,l=e.value.length;if(e.value=s??"",c!==null){var f=e.value.length;o===c&&c===l&&f>l?(e.selectionStart=f,e.selectionEnd=f):(e.selectionStart=o,e.selectionEnd=Math.min(c,f))}}}),u(r)==null&&e.value&&(n(Fn(e)?Xn(e.value):e.value),Fe!==null&&a.add(Fe)),Qr(()=>{var i=r();if(e===document.activeElement){var s=kn??Fe;if(a.has(s))return}Fn(e)&&i===Xn(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function an(e,r,n=r){fi(e,"change",a=>{var i=a?e.defaultChecked:e.checked;n(i)}),u(r)==null&&n(e.checked),Qr(()=>{var a=r();e.checked=!!a})}function Fn(e){var r=e.type;return r==="number"||r==="range"}function Xn(e){return e===""?null:+e}function po(e,r,n){var a=Tr(e,r);a&&a.set&&(e[r]=n,Wn(()=>{e[r]=null}))}function $a(e,r){return e===r||e?.[Pr]===r}function Di(e={},r,n,a){return Fs(()=>{var i,s;return Qr(()=>{i=s,s=[],u(()=>{e!==n(...s)&&(r(e,...s),i&&$a(n(...i),e)&&r(null,...i))})}),()=>{Jr(()=>{s&&$a(n(...s),e)&&r(null,...s)})}}),e}function Da(e){return function(...r){var n=r[0];return n.stopPropagation(),e?.apply(this,r)}}function Gt(e=!1){const r=Qe,n=r.l.u;if(!n)return;let a=()=>W(r.s);if(e){let i=0,s={};const o=ua(()=>{let c=!1;const l=r.s;for(const f in l)l[f]!==s[f]&&(s[f]=l[f],c=!0);return c&&i++,i});a=()=>t(o)}n.b.length&&Hs(()=>{Ra(r,a),En(n.b)}),Vn(()=>{const i=u(()=>n.m.map(Qi));return()=>{for(const s of i)typeof s=="function"&&s()}}),n.a.length&&Vn(()=>{Ra(r,a),En(n.a)})}function Ra(e,r){if(e.l.s)for(const n of e.l.s)t(n);r()}function Aa(e,r){var n=e.$$events?.[r.type],a=na(n)?n.slice():n==null?[]:[n];for(var i of a)i.call(this,r)}function ya(e,r,n){if(e==null)return r(void 0),n&&n(void 0),xr;const a=u(()=>e.subscribe(r,n));return a.unsubscribe?()=>a.unsubscribe():a}const Nr=[];function xo(e,r){return{subscribe:ct(e,r).subscribe}}function ct(e,r=xr){let n=null;const a=new Set;function i(c){if(Va(e,c)&&(e=c,n)){const l=!Nr.length;for(const f of a)f[1](),Nr.push(f,e);if(l){for(let f=0;f<Nr.length;f+=2)Nr[f][0](Nr[f+1]);Nr.length=0}}}function s(c){i(c(e))}function o(c,l=xr){const f=[c,l];return a.add(f),a.size===1&&(n=r(i,s)||xr),c(e),()=>{a.delete(f),a.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:o}}function Lr(e,r,n){const a=!Array.isArray(e),i=a?[e]:e;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=r.length<2;return xo(n,(o,c)=>{let l=!1;const f=[];let v=0,g=xr;const _=()=>{if(v)return;g();const S=r(a?f[0]:f,o,c);s?o(S):g=typeof S=="function"?S:xr},h=i.map((S,E)=>ya(S,w=>{f[E]=w,v&=~(1<<E),l&&_()},()=>{v|=1<<E}));return l=!0,_(),function(){En(h),g(),l=!1}})}function cr(e){let r;return ya(e,n=>r=n)(),r}let xn=!1,Jn=Symbol();function Je(e,r,n){const a=n[r]??={store:null,source:R(void 0),unsubscribe:xr};if(a.store!==e&&!(Jn in n))if(a.unsubscribe(),a.store=e??null,e==null)a.source.v=void 0,a.unsubscribe=xr;else{var i=!0;a.unsubscribe=ya(e,s=>{i?a.source.v=s:m(a.source,s)}),i=!1}return e&&Jn in n?cr(e):t(a.source)}function _o(e,r){return e.set(r),r}function jn(){const e={};function r(){Wn(()=>{for(var n in e)e[n].unsubscribe();ja(e,Jn,{enumerable:!1,value:!0})})}return[e,r]}function mo(e){var r=xn;try{return xn=!1,[e(),xn]}finally{xn=r}}function be(e,r,n,a){var i=!Gr||(n&gs)!==0,s=(n&xs)!==0,o=a,c=!0,l=()=>(c&&(c=!1,o=a),o),f;{var v=Pr in e||es in e;f=Tr(e,r)?.set??(v&&r in e?O=>e[r]=O:void 0)}var g,_=!1;[g,_]=mo(()=>e[r]),g===void 0&&a!==void 0&&(g=l(),f&&(i&&os(),f(g)));var h;if(i?h=()=>{var O=e[r];return O===void 0?l():(c=!0,O)}:h=()=>{var O=e[r];return O!==void 0&&(o=void 0),O===void 0?o:O},i&&(n&ps)===0)return h;if(f){var S=e.$$legacy;return(function(O,F){return arguments.length>0?((!i||!F||S||_)&&f(F?h():O),O):h()})}var E=!1,w=Xe(()=>(E=!1,h()));t(w);var L=We;return(function(O,F){if(arguments.length>0){const G=F?t(w):i&&s?jr(O):O;return m(w,G),E=!0,o!==void 0&&(o=G),O}return br&&E||(L.f&sr)!==0?w.v:t(w)})}function tn(e){Qe===null&&Ua(),Gr&&Qe.l!==null?bo(Qe).m.push(e):Vn(()=>{const r=u(e);if(typeof r=="function")return r})}function Ri(e){Qe===null&&Ua(),tn(()=>()=>u(e))}function bo(e){var r=e.l;return r.u??={a:[],b:[],m:[]}}const wo="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(wo);Ls();function Lo(e,r,n,a){const i=Hr(n,a,e),s=Hr(n,a,r),o=Hr(e,r,n),c=Hr(e,r,a);return!!((i>0&&s<0||i<0&&s>0)&&(o>0&&c<0||o<0&&c>0)||i===0&&_n(n,a,e)||s===0&&_n(n,a,r)||o===0&&_n(e,r,n)||c===0&&_n(e,r,a))}function Hr(e,r,n){return(n.x-e.x)*(r.y-e.y)-(r.x-e.x)*(n.y-e.y)}function _n(e,r,n){return Math.min(e.x,r.x)<=n.x&&n.x<=Math.max(e.x,r.x)&&Math.min(e.y,r.y)<=n.y&&n.y<=Math.max(e.y,r.y)}function Ca(e,r,n,a=16){const i=[];for(let s=0;s<a;s++){const o=2*Math.PI*s/a;i.push({x:e+n*Math.cos(o),y:r+n*Math.sin(o)})}return i}function So(e,r,n,a,i=0,s=16){const o=[],c=2*(n+a),l=i*Math.PI/180,f=Math.cos(l),v=Math.sin(l),g=s/c,_=Math.max(1,Math.round(n*g)),h=Math.max(1,Math.round(a*g)),S=n/2,E=a/2,w=[];for(let L=0;L<_;L++){const O=L/_;w.push({x:-S+n*O,y:-E})}for(let L=0;L<h;L++){const O=L/h;w.push({x:S,y:-E+a*O})}for(let L=0;L<_;L++){const O=L/_;w.push({x:S-n*O,y:E})}for(let L=0;L<h;L++){const O=L/h;w.push({x:-S,y:E-a*O})}for(const L of w)o.push({x:e+L.x*f-L.y*v,y:r+L.x*v+L.y*f});if(o.length>s){const L=[],O=o.length/s;for(let F=0;F<s;F++)L.push(o[Math.floor(F*O)]);return L}return o}function ko(e,r,n,a,i=0,s=16){const o=[],c=i*Math.PI/180,l=Math.cos(c),f=Math.sin(c);for(let v=0;v<s;v++){const g=2*Math.PI*v/s,_=n*Math.cos(g),h=a*Math.sin(g);o.push({x:e+_*l-h*f,y:r+_*f+h*l})}return o}function Ia(e,r,n){const a=n.length;for(let i=0;i<a;i++){const s=n[i],o=n[(i+1)%a];if(Lo(e,r,s,o))return!0}return!1}function Ai(e,r,n){const a=n*Math.PI/180,i=Math.cos(a),s=Math.sin(a),o=e.x-r.x,c=e.y-r.y;return{x:r.x+o*i-c*s,y:r.y+o*s+c*i}}function Ci(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function vn(e){const r=Ci(e),n=e.rotation||0;return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}].map(i=>Ai(i,r,n))}function Mo(e){const i=e.x,s=e.y+e.height;return[{x:i,y:s},{x:i,y:s-8},{x:i+.5,y:s-8},{x:i+.5,y:s-.5},{x:i+4,y:s-.5},{x:i+4,y:s}]}function Eo(e){const r=Mo(e),n=Ci(e),a=e.rotation||0;return r.map(i=>Ai(i,n,a))}function To(e,r,n,a,i=.01){const s=Math.abs(Hr(e,r,n)),o=Math.abs(Hr(e,r,a)),c=Math.sqrt((r.x-e.x)**2+(r.y-e.y)**2),l=i*c;if(s>l||o>l)return!1;const f=r.x-e.x,v=r.y-e.y,g=Math.sqrt(f*f+v*v);if(g<i)return!1;const _=f/g,h=v/g,S=0,E=g,w=(n.x-e.x)*_+(n.y-e.y)*h,L=(a.x-e.x)*_+(a.y-e.y)*h,O=Math.min(S,E),F=Math.max(S,E),G=Math.min(w,L),K=Math.max(w,L),ue=Math.max(O,G);return Math.min(F,K)-ue>i}function Po(e,r,n=.1){const a=e.length,i=r.length;for(let s=0;s<a;s++){const o=e[s],c=e[(s+1)%a];for(let l=0;l<i;l++){const f=r[l],v=r[(l+1)%i];if(To(o,c,f,v,n))return!0}}return!1}function $o(e){const r=e.length;if(r===0)return new Map;const n=Array.from({length:r},(c,l)=>l);function a(c){return n[c]!==c&&(n[c]=a(n[c])),n[c]}function i(c,l){const f=a(c),v=a(l);f!==v&&(n[f]=v)}for(let c=0;c<r;c++)for(let l=c+1;l<r;l++)Po(e[c].vertices,e[l].vertices)&&i(c,l);const s=new Map;e.forEach((c,l)=>s.set(c.id,l));const o=new Map;return e.forEach((c,l)=>{o.set(c.id,a(l))}),o}function Do(e,r,n){const a=r.get(e);return a===void 0?[e]:n.filter(i=>r.get(i.id)===a).map(i=>i.id)}const mn=16;function Qn(e){return e.isRectangle&&e.width!==void 0&&e.height!==void 0?So(e.x,e.y,e.width,e.height,e.rotation||0,mn):e.radius!==void 0?Ca(e.x,e.y,e.radius,mn):e.rx!==void 0&&e.ry!==void 0?ko(e.x,e.y,e.rx,e.ry,e.rotation||0,mn):Ca(e.x,e.y,.5,mn)}function Oa(e,r){const n=Qn(e);for(const a of n)if(Na(a,r))return!0;return!!Na({x:e.x,y:e.y},r)}function Na(e,r){const n=r.length;let a=null;for(let i=0;i<n;i++){const s=r[i],o=r[(i+1)%n],c=(o.x-s.x)*(e.y-s.y)-(o.y-s.y)*(e.x-s.x);if(c!==0){const l=c>0;if(a===null)a=l;else if(a!==l)return!1}}return!0}function Ii(e,r,n,a){const i=Qn(e),s=Qn(r),o=$o(n),c=new Set;for(const g of n){const _=Oa(e,g.vertices),h=Oa(r,g.vertices);if(_||h){const S=Do(g.id,o,n);for(const E of S)c.add(E)}}const l=[];let f=!1,v=null;for(const g of i)for(const _ of s){const h={from:g,to:_,blocked:!1,blockedBy:null};let S=!1;for(const w of n)if(!c.has(w.id)&&Ia(g,_,w.vertices)){h.blocked=!0,h.blockedBy="terrain",S=!0;break}if(S){l.push(h);continue}let E=!1;for(const w of a)if(Ia(g,_,w)){h.blocked=!0,h.blockedBy="wall",E=!0;break}E||(h.blocked=!1,f||(v=h),f=!0),l.push(h)}return{canSee:f,rays:l,firstClearRay:v,terrainsIgnored:Array.from(c)}}const ye={width:60,height:44},Oi=ct([{id:"terrain1",x:20,y:16,width:6,height:12,rotation:0},{id:"terrain2",x:34,y:10,width:6,height:12,rotation:45},{id:"terrain3",x:44,y:20,width:6,height:12,rotation:-30}]);Lr(Oi,e=>e.map(r=>Eo(r)));Lr(Oi,e=>e.map(r=>({id:r.id,vertices:vn(r)})));const Wa=ct(!1);var Ro=ce('<line stroke="#3a4a3a" stroke-width="0.05"></line>'),Ao=ce('<line stroke="#3a4a3a" stroke-width="0.05"></line>'),Co=ce('<line stroke="#5a6a5a" stroke-width="0.08"></line>'),Io=ce('<line stroke="#5a6a5a" stroke-width="0.08"></line>'),Oo=ce('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),No=ce('<line stroke="#666"></line><!>',1),Wo=ce('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),jo=ce('<line stroke="#666"></line><!>',1),Yo=ce('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),Ho=ce('<line stroke="#666"></line><!>',1),Bo=ce('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),Fo=ce('<line stroke="#666"></line><!>',1),Xo=ce('<svg preserveAspectRatio="xMidYMid meet"><rect x="0" y="0" fill="#1a1a1a"></rect><rect fill="#4a5a4a"></rect><!><!><!><!><!><!><!><!><g><!></g></svg>');function Yn(e,r){jt(r,!1);const n=R(),a=R(),i=R(),s=R(),o=R(),c=R(),l=R();let f=R();const v=2,g=ye.width+v*2,_=ye.height+v*2;let h=R(1),S=R(0),E=R(0),w=R(!1),L={x:0,y:0},O=R(!1);const F=.5,G=4;function K(re,z){if(!t(f))return{x:0,y:0};const me=t(f).createSVGPoint();me.x=re,me.y=z;const X=me.matrixTransform(t(f).getScreenCTM().inverse());return{x:X.x-v,y:X.y-v}}function ue(re){re.preventDefault();const z=t(f).getBoundingClientRect(),me=re.clientX-z.left,X=re.clientY-z.top,at=t(i)+me/z.width*t(n),it=t(s)+X/z.height*t(a),Be=re.deltaY>0?.9:1.1,Re=Math.max(F,Math.min(G,t(h)*Be)),ot=g/Re,Ht=_/Re,Bt=at-me/z.width*ot,C=it-X/z.height*Ht;m(h,Re),m(S,Bt),m(E,C)}function fe(re){(re.button===1||re.button===0&&t(O))&&(re.preventDefault(),m(w,!0),L={x:re.clientX,y:re.clientY})}function j(re){if(!t(w))return;const z=t(f).getBoundingClientRect(),me=(re.clientX-L.x)/z.width*t(n),X=(re.clientY-L.y)/z.height*t(a);m(S,t(S)-me),m(E,t(E)-X),L={x:re.clientX,y:re.clientY}}function se(){m(w,!1)}function ee(re){re.code==="Space"&&!re.repeat&&re.target.tagName!=="INPUT"&&(re.preventDefault(),m(O,!0))}function Te(re){re.code==="Space"&&m(O,!1)}function Pe(){m(h,1),m(S,0),m(E,0)}q(()=>t(h),()=>{m(n,g/t(h))}),q(()=>t(h),()=>{m(a,_/t(h))}),q(()=>t(S),()=>{m(i,t(S))}),q(()=>t(E),()=>{m(s,t(E))}),q(()=>(t(i),t(s),t(n),t(a)),()=>{m(o,`${t(i)} ${t(s)} ${t(n)} ${t(a)}`)}),q(()=>ye,()=>{m(c,Array.from({length:ye.width+1},(re,z)=>z))}),q(()=>ye,()=>{m(l,Array.from({length:ye.height+1},(re,z)=>z))}),wr();var Ue={screenToSvg:K};Gt();var J=Xo();U("keydown",Yr,ee),U("keyup",Yr,Te),U("mouseup",Yr,se),U("mousemove",Yr,j);let de;var ve=x(J),Me=p(ve);d(Me,"x",v),d(Me,"y",v);var te=p(Me);Se(te,1,()=>(W(ye),u(()=>Array(ye.width+1))),Ie,(re,z,me)=>{var X=Ro();d(X,"x1",v+me),d(X,"y1",v),d(X,"x2",v+me),Y(()=>d(X,"y2",(W(ye),u(()=>v+ye.height)))),b(re,X)});var _e=p(te);Se(_e,1,()=>(W(ye),u(()=>Array(ye.height+1))),Ie,(re,z,me)=>{var X=Ao();d(X,"x1",v),d(X,"y1",v+me),d(X,"y2",v+me),Y(()=>d(X,"x2",(W(ye),u(()=>v+ye.width)))),b(re,X)});var V=p(_e);Se(V,1,()=>(W(ye),u(()=>Array(Math.floor(ye.width/6)+1))),Ie,(re,z,me)=>{var X=Co();d(X,"x1",v+me*6),d(X,"y1",v),d(X,"x2",v+me*6),Y(()=>d(X,"y2",(W(ye),u(()=>v+ye.height)))),b(re,X)});var Q=p(V);Se(Q,1,()=>(W(ye),u(()=>Array(Math.floor(ye.height/6)+1))),Ie,(re,z,me)=>{var X=Io();d(X,"x1",v),d(X,"y1",v+me*6),d(X,"y2",v+me*6),Y(()=>d(X,"x2",(W(ye),u(()=>v+ye.width)))),b(re,X)});var ge=p(Q);Se(ge,1,()=>t(c),Ie,(re,z)=>{var me=No(),X=xe(me);d(X,"y2",v);var at=p(X);{var it=Be=>{var Re=Oo();d(Re,"y",1.2);var ot=x(Re);Y(()=>{d(Re,"x",v+t(z)),ke(ot,`${t(z)??""}"`)}),b(Be,Re)};oe(at,Be=>{t(z)%6===0&&Be(it)})}Y(()=>{d(X,"x1",v+t(z)),d(X,"y1",t(z)%6===0?.5:v-.8),d(X,"x2",v+t(z)),d(X,"stroke-width",t(z)%6===0?.08:.04)}),b(re,me)});var ae=p(ge);Se(ae,1,()=>t(c),Ie,(re,z)=>{var me=jo(),X=xe(me),at=p(X);{var it=Be=>{var Re=Wo(),ot=x(Re);Y(()=>{d(Re,"x",v+t(z)),d(Re,"y",(W(ye),u(()=>v+ye.height+1.8))),ke(ot,`${t(z)??""}"`)}),b(Be,Re)};oe(at,Be=>{t(z)%6===0&&Be(it)})}Y(()=>{d(X,"x1",v+t(z)),d(X,"y1",(W(ye),u(()=>v+ye.height))),d(X,"x2",v+t(z)),d(X,"y2",(W(ye),t(z),u(()=>v+ye.height+(t(z)%6===0?1.5:.8)))),d(X,"stroke-width",t(z)%6===0?.08:.04)}),b(re,me)});var Z=p(ae);Se(Z,1,()=>t(l),Ie,(re,z)=>{var me=Ho(),X=xe(me);d(X,"x2",v);var at=p(X);{var it=Be=>{var Re=Yo();d(Re,"x",1);var ot=x(Re);Y(()=>{d(Re,"y",v+t(z)+.35),ke(ot,`${t(z)??""}"`)}),b(Be,Re)};oe(at,Be=>{t(z)%6===0&&Be(it)})}Y(()=>{d(X,"x1",t(z)%6===0?.5:v-.8),d(X,"y1",v+t(z)),d(X,"y2",v+t(z)),d(X,"stroke-width",t(z)%6===0?.08:.04)}),b(re,me)});var we=p(Z);Se(we,1,()=>t(l),Ie,(re,z)=>{var me=Fo(),X=xe(me),at=p(X);{var it=Be=>{var Re=Bo(),ot=x(Re);Y(()=>{d(Re,"x",(W(ye),u(()=>v+ye.width+1))),d(Re,"y",v+t(z)+.35),ke(ot,`${t(z)??""}"`)}),b(Be,Re)};oe(at,Be=>{t(z)%6===0&&Be(it)})}Y(()=>{d(X,"x1",(W(ye),u(()=>v+ye.width))),d(X,"y1",v+t(z)),d(X,"x2",(W(ye),t(z),u(()=>v+ye.width+(t(z)%6===0?1.5:.8)))),d(X,"y2",v+t(z)),d(X,"stroke-width",t(z)%6===0?.08:.04)}),b(re,me)});var De=p(we);d(De,"transform","translate(2, 2)");var rt=x(De);return Pi(rt,r,"default",{screenToSvg:K}),Di(J,re=>m(f,re),()=>t(f)),Y(()=>{d(J,"viewBox",t(o)),de=Zt(J,0,"battlefield svelte-n43bnt",null,de,{panning:t(w)||t(O)}),d(ve,"width",(W(ye),u(()=>ye.width+v*2))),d(ve,"height",(W(ye),u(()=>ye.height+v*2))),d(Me,"width",(W(ye),u(()=>ye.width))),d(Me,"height",(W(ye),u(()=>ye.height)))}),U("wheel",J,ue),U("mousedown",J,fe),U("dblclick",J,Pe),b(e,J),po(r,"screenToSvg",K),Yt(Ue)}var Uo=ce('<line stroke="#3b82f6" stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-trljjm"></circle>',1),Ko=ce('<g><g><rect role="button" tabindex="0" class="svelte-trljjm"></rect></g><!></g>');function Ni(e,r){jt(r,!1);const n=R(),a=R(),i=R(),s=R(),o=R();let c=be(r,"id",8),l=be(r,"x",8),f=be(r,"y",8),v=be(r,"width",8),g=be(r,"height",8),_=be(r,"rotation",8,0),h=be(r,"selected",8,!1),S=be(r,"screenToSvg",8),E=be(r,"onSelect",8,()=>{}),w=be(r,"onDrag",8,()=>{}),L=be(r,"onRotate",8,()=>{}),O=R(!1),F=!1,G={x:0,y:0};function K(te){te.stopPropagation(),E()(c())}function ue(te){if(te.button!==0)return;te.preventDefault(),te.stopPropagation(),E()(c()),m(O,!0);const _e=S()(te.clientX,te.clientY);G={x:_e.x-l(),y:_e.y-f()},window.addEventListener("mousemove",fe),window.addEventListener("mouseup",j)}function fe(te){if(!t(O))return;const _e=S()(te.clientX,te.clientY);let V=_e.x-G.x,Q=_e.y-G.y;te.shiftKey||(V=Math.round(V),Q=Math.round(Q));const ge=Math.max(v(),g())/2;V=Math.max(-ge,Math.min(ye.width-v()+ge,V)),Q=Math.max(-ge,Math.min(ye.height-g()+ge,Q)),w()(c(),V,Q)}function j(){m(O,!1),window.removeEventListener("mousemove",fe),window.removeEventListener("mouseup",j)}function se(te){te.preventDefault(),te.stopPropagation(),F=!0,window.addEventListener("mousemove",ee),window.addEventListener("mouseup",Te)}function ee(te){if(!F)return;const _e=S()(te.clientX,te.clientY),V=_e.x-t(n),Q=_e.y-t(a);let ge=Math.atan2(Q,V)*180/Math.PI+45;te.shiftKey||(ge=Math.round(ge/15)*15),L()(c(),ge)}function Te(){F=!1,window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",Te)}q(()=>(W(l()),W(v())),()=>{m(n,l()+v()/2)}),q(()=>(W(f()),W(g())),()=>{m(a,f()+g()/2)}),q(()=>(W(v()),W(g())),()=>{m(i,Math.max(v(),g())/2+1.5)}),q(()=>(t(n),t(i),W(_())),()=>{m(s,t(n)+t(i)*Math.cos((_()-45)*Math.PI/180))}),q(()=>(t(a),t(i),W(_())),()=>{m(o,t(a)+t(i)*Math.sin((_()-45)*Math.PI/180))}),wr(),Gt();var Pe=Ko();let Ue;var J=x(Pe),de=x(J),ve=p(J);{var Me=te=>{var _e=Uo(),V=xe(_e),Q=p(V);Y(()=>{d(V,"x1",t(n)),d(V,"y1",t(a)),d(V,"x2",t(s)),d(V,"y2",t(o)),d(Q,"cx",t(s)),d(Q,"cy",t(o))}),U("mousedown",Q,se),b(te,_e)};oe(ve,te=>{h()&&te(Me)})}Y(()=>{Ue=Zt(Pe,0,"terrain-rect svelte-trljjm",null,Ue,{selected:h(),dragging:t(O)}),d(J,"transform",`rotate(${_()??""}, ${t(n)??""}, ${t(a)??""})`),d(de,"x",l()),d(de,"y",f()),d(de,"width",v()),d(de,"height",g()),d(de,"fill",h()?"rgba(59, 130, 246, 0.3)":"rgba(139, 90, 43, 0.3)"),d(de,"stroke",h()?"#3b82f6":"#8b5a2b"),d(de,"stroke-width",h()?.15:.1)}),U("click",de,K),U("mousedown",de,ue),b(e,Pe),Yt()}const Wi="warhammer-deployment-layouts",ji=[{label:'6" x 12"',width:6,height:12},{label:'5" x 10"',width:5,height:10},{label:'4" x 6"',width:4,height:6}],ea=[{label:"L 4x8",shape:"L-4x8"},{label:"L 4x8 â",shape:"L-4x8-mirror"},{label:"C 4-8-4",shape:"C-4-8-4"},{label:"L 5x6",shape:"L-5x6"},{label:"L 5x6 â",shape:"L-5x6-mirror"},{label:"L 4x6",shape:"L-4x6"},{label:"L 4x6 â",shape:"L-4x6-mirror"}],Yi=[{name:"Layout 1",terrains:[{id:"a",x:28,y:0,width:4,height:6,rotation:0},{id:"b",x:28,y:38,width:4,height:6,rotation:0},{id:"c",x:6,y:5,width:6,height:12,rotation:0},{id:"d",x:48,y:27,width:6,height:12,rotation:0},{id:"e",x:16,y:28,width:6,height:12,rotation:0},{id:"f",x:7,y:19,width:6,height:12,rotation:90},{id:"g",x:38,y:4,width:6,height:12,rotation:0},{id:"h",x:47,y:13,width:6,height:12,rotation:90},{id:"i",x:32.74,y:23.59,width:5,height:10,rotation:135},{id:"j",x:35.06,y:19.5,width:4,height:6,rotation:45},{id:"k",x:22.07,y:10.17,width:5,height:10,rotation:-45},{id:"l",x:20.72,y:18.23,width:4,height:6,rotation:45}],walls:[{id:"wa",x:38,y:6,shape:"C-4-8-4",rotation:0},{id:"wb",x:18,y:30,shape:"C-4-8-4",rotation:180},{id:"wc",x:13.33,y:20.15,shape:"L-4x8-mirror",rotation:-90},{id:"wd",x:49.67,y:15.93,shape:"L-4x8-mirror",rotation:90},{id:"we",x:48.2,y:30.88,shape:"L-4x8",rotation:0},{id:"wf",x:7.84,y:5.01,shape:"L-4x8",rotation:180},{id:"wg",x:27.06,y:11.52,shape:"L-4x8-mirror",rotation:-45},{id:"wh",x:35.81,y:24.24,shape:"L-4x8-mirror",rotation:135}]},{name:"Layout 2",terrains:[{id:"a",x:31,y:7,width:4,height:6,rotation:-90},{id:"b",x:25,y:30,width:4,height:6,rotation:90},{id:"c",x:5,y:4,width:6,height:12,rotation:0},{id:"d",x:49,y:28,width:6,height:12,rotation:0},{id:"e",x:46,y:4,width:6,height:12,rotation:0},{id:"f",x:16.32,y:16.13,width:6,height:12,rotation:135},{id:"g",x:53,y:15,width:4,height:6,rotation:90},{id:"h",x:8,y:28,width:6,height:12,rotation:0},{id:"i",x:3,y:23,width:4,height:6,rotation:90},{id:"j",x:32.62,y:32.55,width:5,height:10,rotation:-90},{id:"k",x:22.48,y:.51,width:5,height:10,rotation:-90},{id:"l",x:37,y:16,width:6,height:12,rotation:135}],walls:[{id:"wa",x:49,y:32,shape:"L-4x8",rotation:0},{id:"wb",x:7,y:4,shape:"L-4x8",rotation:180},{id:"wc",x:46,y:8,shape:"L-4x8",rotation:0},{id:"wd",x:10,y:28,shape:"L-4x8",rotation:180},{id:"we",x:35.07,y:34.56,shape:"L-5x6-mirror",rotation:-90},{id:"wf",x:29.09,y:2.47,shape:"L-5x6-mirror",rotation:90},{id:"wg",x:17.86,y:17.53,shape:"C-4-8-4",rotation:135},{id:"wh",x:37.24,y:18.38,shape:"C-4-8-4",rotation:-45}]},{name:"Layout 3",terrains:[{id:"a",x:11,y:3,width:4,height:6,rotation:90},{id:"b",x:45,y:35,width:4,height:6,rotation:90},{id:"c",x:25,y:1,width:6,height:12,rotation:90},{id:"d",x:29,y:31,width:6,height:12,rotation:90},{id:"e",x:7.74,y:26.05,width:6,height:12,rotation:125.31},{id:"f",x:46.34,y:5.51,width:6,height:12,rotation:121.72},{id:"g",x:5.14,y:10.46,width:6,height:12,rotation:41.51},{id:"h",x:48.67,y:21.52,width:6,height:12,rotation:41.51},{id:"i",x:19.59,y:14.36,width:5,height:10,rotation:-38.13},{id:"j",x:20.69,y:24.37,width:4,height:6,rotation:-39.33},{id:"k",x:35.34,y:19.61,width:5,height:10,rotation:-38.13},{id:"l",x:35.31,y:13.5,width:4,height:6,rotation:-39.33}],walls:[{id:"aa",x:30,y:32,shape:"C-4-8-4",rotation:90},{id:"ab",x:26,y:4,shape:"C-4-8-4",rotation:-90},{id:"ac",x:8.19,y:11.64,shape:"L-4x8",rotation:222.46},{id:"ad",x:47.79,y:24.3,shape:"L-4x8",rotation:41.26},{id:"ae",x:38.64,y:20.09,shape:"L-5x6-mirror",rotation:141.31},{id:"af",x:25.26,y:17.9,shape:"L-5x6-mirror",rotation:-37.61},{id:"ag",x:14.37,y:28.38,shape:"L-4x8-mirror",rotation:-54.26},{id:"ah",x:48.75,y:7.3,shape:"L-4x8-mirror",rotation:122.02}]},{name:"Layout 4",terrains:[{id:"a",x:15,y:1,width:6,height:12,rotation:90},{id:"b",x:8,y:10,width:4,height:6,rotation:0},{id:"c",x:4,y:19,width:4,height:6,rotation:0},{id:"d",x:7.5,y:27.68,width:6,height:12,rotation:-48.57},{id:"e",x:46.53,y:4.24,width:6,height:12,rotation:-48.57},{id:"f",x:53,y:19,width:4,height:6,rotation:0},{id:"g",x:48,y:28,width:4,height:6,rotation:0},{id:"h",x:39,y:31,width:6,height:12,rotation:90},{id:"i",x:33.03,y:2.97,width:6,height:12,rotation:-37.25},{id:"j",x:20.96,y:28.96,width:6,height:12,rotation:-37.25},{id:"k",x:16.93,y:16.51,width:5,height:10,rotation:-41.85},{id:"l",x:37.96,y:17.43,width:5,height:10,rotation:-41.85}],walls:[{id:"aa",x:18,y:4,shape:"L-4x8",rotation:-90},{id:"ab",x:9.04,y:29.01,shape:"C-4-8-4",rotation:131.97},{id:"ac",x:47,y:7,shape:"C-4-8-4",rotation:-48.54},{id:"ad",x:38,y:32,shape:"L-4x8",rotation:90},{id:"ae",x:34.42,y:7.12,shape:"L-4x8",rotation:-37.53},{id:"af",x:21.57,y:28.8,shape:"L-4x8",rotation:142.46},{id:"ag",x:15.7,y:17.01,shape:"L-5x6",rotation:137.87},{id:"ah",x:39.17,y:20.85,shape:"L-5x6",rotation:-40.92}]},{name:"Layout 5",terrains:[{id:"aa",x:27,y:1,width:6,height:12,rotation:90},{id:"ab",x:36.53,y:12.48,width:5,height:10,rotation:-90},{id:"ac",x:13,y:3,width:4,height:6,rotation:90},{id:"ad",x:43,y:35,width:4,height:6,rotation:90},{id:"ae",x:27,y:31,width:6,height:12,rotation:90},{id:"af",x:18.43,y:21.49,width:5,height:10,rotation:-90},{id:"ag",x:1,y:23,width:4,height:6,rotation:90},{id:"ah",x:55,y:15,width:4,height:6,rotation:90},{id:"ai",x:7.83,y:30.22,width:6,height:12,rotation:-60},{id:"aj",x:46.32,y:1.58,width:6,height:12,rotation:-60},{id:"ak",x:8.74,y:10.19,width:6,height:12,rotation:65.22},{id:"al",x:45.22,y:21.75,width:6,height:12,rotation:65.22}],walls:[{id:"a1",x:28,y:32,shape:"C-4-8-4",rotation:90},{id:"a2",x:28,y:4,shape:"C-4-8-4",rotation:-90},{id:"a3",x:11.88,y:12.29,shape:"L-4x8",rotation:-114.74},{id:"a4",x:43.97,y:23.59,shape:"L-4x8",rotation:64.22},{id:"a5",x:24.91,y:23.52,shape:"L-5x6-mirror",rotation:-90.37},{id:"a6",x:39,y:14.51,shape:"L-5x6-mirror",rotation:89.9},{id:"a7",x:7.58,y:30.57,shape:"L-4x8",rotation:120.93},{id:"a8",x:48.51,y:5.28,shape:"L-4x8",rotation:-59.06}]},{name:"Layout 6",terrains:[{id:"aa",x:13,y:1,width:6,height:12,rotation:90},{id:"ab",x:6,y:10,width:4,height:6,rotation:0},{id:"ac",x:25,y:11,width:4,height:6,rotation:90},{id:"ad",x:7.34,y:27.57,width:6,height:12,rotation:-40.32},{id:"ae",x:46.69,y:4.57,width:6,height:12,rotation:-41.9},{id:"af",x:31,y:27,width:4,height:6,rotation:-90},{id:"ag",x:50,y:28,width:4,height:6,rotation:0},{id:"ah",x:41,y:31,width:6,height:12,rotation:90},{id:"ai",x:34,y:4,width:6,height:12,rotation:0},{id:"aj",x:20,y:28,width:6,height:12,rotation:0},{id:"ak",x:15.7,y:15.03,width:5,height:10,rotation:-41.85},{id:"al",x:39.43,y:19.24,width:5,height:10,rotation:-39.95}],walls:[{id:"a1",x:16,y:4,shape:"L-4x8",rotation:-90},{id:"a2",x:9.04,y:29.01,shape:"C-4-8-4",rotation:140.05},{id:"a3",x:47,y:7.16,shape:"C-4-8-4",rotation:-41.53},{id:"a4",x:40,y:32,shape:"L-4x8",rotation:90},{id:"a5",x:34.15,y:7.88,shape:"L-4x8",rotation:0},{id:"a6",x:22,y:28,shape:"L-4x8",rotation:180},{id:"a7",x:14.47,y:15.47,shape:"L-5x6",rotation:137.87},{id:"a8",x:40.53,y:22.78,shape:"L-5x6",rotation:-40.92}]},{name:"Layout 7",terrains:[{id:"aa",x:8,y:8,width:6,height:12,rotation:0},{id:"ab",x:6,y:28,width:6,height:12,rotation:0},{id:"ac",x:7,y:39,width:4,height:6,rotation:90},{id:"ad",x:18,y:26,width:5,height:10,rotation:0},{id:"ae",x:19,y:20,width:4,height:6,rotation:0},{id:"af",x:23,y:3,width:6,height:12,rotation:0},{id:"ag",x:31,y:29,width:6,height:12,rotation:0},{id:"ah",x:37,y:18,width:4,height:6,rotation:0},{id:"ai",x:37,y:8,width:5,height:10,rotation:0},{id:"aj",x:46,y:24,width:6,height:12,rotation:0},{id:"ak",x:48,y:4,width:6,height:12,rotation:0},{id:"al",x:49,y:-1,width:4,height:6,rotation:90}],walls:[{id:"a1",x:9,y:10,shape:"L-5x6",rotation:180},{id:"a2",x:11.44,y:31.97,shape:"L-4x8-mirror",rotation:0},{id:"a3",x:19,y:20,shape:"L-4x6",rotation:180},{id:"a4",x:22.53,y:30.02,shape:"L-5x6-mirror",rotation:0},{id:"a5",x:25,y:5,shape:"C-4-8-4",rotation:180},{id:"a6",x:31,y:31,shape:"C-4-8-4",rotation:0},{id:"a7",x:37,y:18,shape:"L-4x6",rotation:0},{id:"a8",x:41.51,y:8.09,shape:"L-5x6-mirror",rotation:180},{id:"a9",x:46,y:28,shape:"L-5x6",rotation:0},{id:"a10",x:51.51,y:4.01,shape:"L-4x8-mirror",rotation:180}]},{name:"Layout 8",terrains:[{id:"aa",x:23,y:22,width:4,height:6,rotation:0},{id:"ab",x:23,y:28,width:4,height:6,rotation:0},{id:"ac",x:33,y:16,width:4,height:6,rotation:0},{id:"ad",x:33,y:10,width:4,height:6,rotation:0},{id:"ae",x:41,y:19,width:6,height:12,rotation:0},{id:"af",x:13,y:13,width:6,height:12,rotation:0},{id:"ag",x:32,y:32,width:6,height:12,rotation:0},{id:"ah",x:22,y:0,width:6,height:12,rotation:0},{id:"ai",x:9.5,y:27.68,width:6,height:12,rotation:-48.69},{id:"aj",x:44.51,y:4.35,width:6,height:12,rotation:-48.69},{id:"ak",x:6.95,y:4,width:5,height:10,rotation:53.9},{id:"al",x:48,y:30,width:5,height:10,rotation:53.9}],walls:[{id:"a1",x:32,y:34,shape:"C-4-8-4",rotation:0},{id:"a2",x:24,y:2,shape:"C-4-8-4",rotation:180},{id:"a3",x:44.68,y:19.06,shape:"L-4x8-mirror",rotation:180},{id:"a4",x:18.43,y:16.91,shape:"L-4x8-mirror",rotation:0},{id:"a5",x:46.38,y:33.13,shape:"L-5x6",rotation:52.87},{id:"a6",x:8.55,y:4.89,shape:"L-5x6",rotation:-127.66},{id:"a7",x:16,y:30.28,shape:"L-4x8-mirror",rotation:-48.62},{id:"a8",x:46.91,y:5.85,shape:"L-4x8-mirror",rotation:132.19}]}];function Zo(){return"terrain-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function ar(){const e=localStorage.getItem(Wi);if(e)try{return JSON.parse(e)}catch(r){return console.error("Failed to parse saved layouts:",r),{}}return{}}function Rn(e){localStorage.setItem(Wi,JSON.stringify(e))}function Hi(){const{subscribe:e,set:r,update:n}=ct([]);return{subscribe:e,set:r,update:n,add(a,i){n(s=>[...s,{id:Zo(),x:30-a/2,y:22-i/2,width:a,height:i,rotation:0}])},updateTerrain(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])},save(a){const i=cr({subscribe:e}),s=ar();s[a]={terrains:i,savedAt:Date.now()},Rn(s)},load(a){const i=ar();return i[a]?(r(i[a].terrains),!0):!1},deleteLayout(a){const i=ar();delete i[a],Rn(i)},getSavedLayoutNames(){const a=ar();return Object.keys(a).map(i=>({name:i,savedAt:a[i].savedAt,terrainCount:a[i].terrains.length})).sort((i,s)=>s.savedAt-i.savedAt)},hasSaved(){const a=ar();return Object.keys(a).length>0}}}const Dt=Hi();function Bi(){const{subscribe:e,set:r,update:n}=ct([]);return{subscribe:e,set:r,update:n,add(a){n(i=>[...i,{id:"wall-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),x:30,y:22,shape:a,rotation:0}])},updateWall(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])}}}const Tt=Bi(),bn=Hi(),wn=Bi(),Ln=ct(null),Sn=ct(null);function Vr(e){switch(e){case"L-4x8":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];case"L-4x8-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:8},{x:-4+.5,y:8},{x:-4+.5,y:8-.5},{x:0,y:8-.5}];case"C-4-8-4":return[{x:0,y:0},{x:4,y:0},{x:4,y:.5},{x:.5,y:.5},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];case"L-5x6":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:5,y:6-.5},{x:5,y:6},{x:0,y:6}];case"L-5x6-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-5+.5,y:6},{x:-5+.5,y:6-.5},{x:0,y:6-.5}];case"L-4x6":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:4,y:6-.5},{x:4,y:6},{x:0,y:6}];case"L-4x6-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-4+.5,y:6},{x:-4+.5,y:6-.5},{x:0,y:6-.5}];default:return[]}}function ga(e,r,n,a){if(e.length===0)return[];const i=e.map(L=>L.x),s=e.map(L=>L.y),o=Math.min(...i),c=Math.max(...i),l=Math.min(...s),f=Math.max(...s),v=c-o,g=f-l,_=r+o+v/2,h=n+l+g/2,S=a*Math.PI/180,E=Math.cos(S),w=Math.sin(S);return e.map(L=>{const O=r+L.x,F=n+L.y,G=O-_,K=F-h;return{x:_+G*E-K*w,y:h+G*w+K*E}})}Lr(Tt,e=>e.map(r=>ga(Vr(r.shape),r.x,r.y,r.rotation)));const Xt=ct(null),Ut=ct(null),pa=ct([]);function zo(e,r=[]){const n=cr(Dt),a=cr(Tt),i=ar();i[e]={terrains:n,walls:a,models:r,savedAt:Date.now()},Rn(i)}function Vo(e){const r=ar();return r[e]?(Dt.set(r[e].terrains||[]),Tt.set(r[e].walls||[]),{terrains:r[e].terrains||[],walls:r[e].walls||[],models:r[e].models||[]}):null}function qo(e){const r=ar();delete r[e],Rn(r)}function Go(){const e=ar();return Object.keys(e).map(r=>({name:r,savedAt:e[r].savedAt,terrainCount:(e[r].terrains||[]).length,wallCount:(e[r].walls||[]).length,modelCount:(e[r].models||[]).length})).sort((r,n)=>n.savedAt-r.savedAt)}function sn(){pa.set(Go())}var Jo=ce('<line stroke="#3b82f6" stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-1tez9jd"></circle>',1),Qo=ce('<g><g><path role="button" tabindex="0" class="svelte-1tez9jd"></path></g><!></g>');function xa(e,r){jt(r,!1);const n=R(),a=R(),i=R(),s=R(),o=R(),c=R(),l=R(),f=R(),v=R(),g=R();let _=be(r,"id",8),h=be(r,"x",8),S=be(r,"y",8),E=be(r,"shape",8),w=be(r,"rotation",8,0),L=be(r,"selected",8,!1),O=be(r,"screenToSvg",8),F=be(r,"onSelect",8,()=>{}),G=be(r,"onDrag",8,()=>{}),K=be(r,"onRotate",8,()=>{});function ue(ae){const Z=ae.map(De=>De.x),we=ae.map(De=>De.y);return{minX:Math.min(...Z),maxX:Math.max(...Z),minY:Math.min(...we),maxY:Math.max(...we)}}let fe=R(!1),j=!1,se={x:0,y:0};function ee(ae){ae.stopPropagation(),F()(_())}function Te(ae){if(ae.button!==0)return;ae.preventDefault(),ae.stopPropagation(),F()(_()),m(fe,!0);const Z=O()(ae.clientX,ae.clientY);se={x:Z.x-h(),y:Z.y-S()},window.addEventListener("mousemove",Pe),window.addEventListener("mouseup",Ue)}function Pe(ae){if(!t(fe))return;const Z=O()(ae.clientX,ae.clientY);let we=Z.x-se.x,De=Z.y-se.y;ae.shiftKey||(we=Math.round(we),De=Math.round(De));const rt=Math.max(t(i),t(s));we=Math.max(-rt,Math.min(ye.width+rt-t(i),we)),De=Math.max(-rt,Math.min(ye.height+rt-t(s),De)),G()(_(),we,De)}function Ue(){m(fe,!1),window.removeEventListener("mousemove",Pe),window.removeEventListener("mouseup",Ue)}function J(ae){ae.preventDefault(),ae.stopPropagation(),j=!0,window.addEventListener("mousemove",de),window.addEventListener("mouseup",ve)}function de(ae){if(!j)return;const Z=O()(ae.clientX,ae.clientY),we=Z.x-t(o),De=Z.y-t(c);let rt=Math.atan2(De,we)*180/Math.PI+45;ae.shiftKey||(rt=Math.round(rt/15)*15),K()(_(),rt)}function ve(){j=!1,window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",ve)}q(()=>W(E()),()=>{m(n,Vr(E()))}),q(()=>t(n),()=>{m(a,ue(t(n)))}),q(()=>t(a),()=>{m(i,t(a).maxX-t(a).minX)}),q(()=>t(a),()=>{m(s,t(a).maxY-t(a).minY)}),q(()=>(W(h()),t(a),t(i)),()=>{m(o,h()+t(a).minX+t(i)/2)}),q(()=>(W(S()),t(a),t(s)),()=>{m(c,S()+t(a).minY+t(s)/2)}),q(()=>(t(n),W(h()),W(S())),()=>{m(l,t(n).length>0?`M ${t(n).map(ae=>`${h()+ae.x},${S()+ae.y}`).join(" L ")} Z`:"")}),q(()=>(t(i),t(s)),()=>{m(f,Math.max(t(i),t(s))/2+1.5)}),q(()=>(t(o),t(f),W(w())),()=>{m(v,t(o)+t(f)*Math.cos((w()-45)*Math.PI/180))}),q(()=>(t(c),t(f),W(w())),()=>{m(g,t(c)+t(f)*Math.sin((w()-45)*Math.PI/180))}),wr(),Gt();var Me=Qo();let te;var _e=x(Me),V=x(_e),Q=p(_e);{var ge=ae=>{var Z=Jo(),we=xe(Z),De=p(we);Y(()=>{d(we,"x1",t(o)),d(we,"y1",t(c)),d(we,"x2",t(v)),d(we,"y2",t(g)),d(De,"cx",t(v)),d(De,"cy",t(g))}),U("mousedown",De,J),b(ae,Z)};oe(Q,ae=>{L()&&ae(ge)})}Y(()=>{te=Zt(Me,0,"wall-piece svelte-1tez9jd",null,te,{selected:L(),dragging:t(fe)}),d(_e,"transform",`rotate(${w()??""}, ${t(o)??""}, ${t(c)??""})`),d(V,"d",t(l)),d(V,"fill",L()?"rgba(139, 69, 19, 0.6)":"rgba(139, 69, 19, 0.8)"),d(V,"stroke",L()?"#3b82f6":"#5c3317"),d(V,"stroke-width",L()?.15:.1)}),U("click",V,ee),U("mousedown",V,Te),b(e,Me),Yt()}var el=le('<div class="section-content svelte-7o4pd4"><!></div>'),tl=le('<section><div class="section-header svelte-7o4pd4" role="button" tabindex="0"><h3 class="svelte-7o4pd4"> </h3> <span class="toggle-icon svelte-7o4pd4"> </span></div> <!></section>');function gt(e,r){let n=be(r,"title",8),a=be(r,"defaultOpen",8,!0),i=R(a());function s(){m(i,!t(i))}var o=tl();let c;var l=x(o),f=x(l),v=x(f),g=p(f,2),_=x(g),h=p(l,2);{var S=E=>{var w=el(),L=x(w);Pi(L,r,"default",{}),b(E,w)};oe(h,E=>{t(i)&&E(S)})}Y(()=>{c=Zt(o,1,"collapsible-section svelte-7o4pd4",null,c,{collapsed:!t(i)}),ke(v,n()),ke(_,t(i)?"â¼":"â¶")}),U("click",l,s),b(e,o)}var rl=le('<button class="svelte-10mgcx0"> </button>'),nl=le('<div class="button-group svelte-10mgcx0"></div>'),al=le('<button class="svelte-10mgcx0"> </button>'),il=le('<div class="button-group svelte-10mgcx0"></div>'),sl=le('<div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Size</span> <span class="value svelte-10mgcx0"> </span></div> <div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Rotation</span> <span class="value svelte-10mgcx0"> </span></div>',1),ol=le('<div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Shape</span> <span class="value svelte-10mgcx0"> </span></div> <div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Rotation</span> <span class="value svelte-10mgcx0"> </span></div>',1),ll=le('<div class="edit-form svelte-10mgcx0"><div class="field svelte-10mgcx0"><label for="edit-x" class="svelte-10mgcx0">X (inches)</label> <input id="edit-x" type="number" step="0.1" class="svelte-10mgcx0"/></div> <div class="field svelte-10mgcx0"><label for="edit-y" class="svelte-10mgcx0">Y (inches)</label> <input id="edit-y" type="number" step="0.1" class="svelte-10mgcx0"/></div> <!> <button class="danger svelte-10mgcx0">Remove</button></div>'),cl=le('<p class="hint svelte-10mgcx0">Click a piece to select it</p>'),ul=le('<div class="button-group vertical svelte-10mgcx0"><button class="svelte-10mgcx0">Save Layout</button> <button class="svelte-10mgcx0">Load Layout</button> <div class="button-row svelte-10mgcx0"><button class="secondary small svelte-10mgcx0">Export</button> <button class="secondary small svelte-10mgcx0">Import</button></div> <button class="secondary svelte-10mgcx0">Clear All</button></div>'),dl=le("<!> <!>",1),fl=le('<div class="modal-overlay svelte-10mgcx0" role="presentation"><div class="modal svelte-10mgcx0" role="dialog"><h2 class="svelte-10mgcx0">Save Layout</h2> <div class="modal-field svelte-10mgcx0"><label for="layout-name" class="svelte-10mgcx0">Layout Name</label> <input id="layout-name" type="text" placeholder="Enter a name..." class="svelte-10mgcx0"/></div> <div class="modal-actions svelte-10mgcx0"><button class="secondary svelte-10mgcx0">Cancel</button> <button class="svelte-10mgcx0">Save</button></div></div></div>'),vl=le('<p class="hint svelte-10mgcx0">No saved layouts yet</p>'),hl=le('<div class="layout-item svelte-10mgcx0" role="button" tabindex="0"><div class="layout-info svelte-10mgcx0"><span class="layout-name svelte-10mgcx0"> </span> <span class="layout-meta svelte-10mgcx0"> </span></div> <button class="delete-btn svelte-10mgcx0" title="Delete">Ã</button></div>'),yl=le('<div class="layout-list svelte-10mgcx0"></div>'),gl=le('<div class="modal-overlay svelte-10mgcx0" role="presentation"><div class="modal svelte-10mgcx0" role="dialog"><h2 class="svelte-10mgcx0">Load Layout</h2> <!> <div class="modal-actions svelte-10mgcx0"><button class="secondary svelte-10mgcx0">Cancel</button></div></div></div>'),pl=le('<main class="svelte-10mgcx0"><div class="header svelte-10mgcx0"><h1 class="svelte-10mgcx0">Layout Builder</h1> <nav class="nav-links svelte-10mgcx0"><a href="#/setup" class="svelte-10mgcx0">Battlefield Setup</a> <a href="#/deployment" class="svelte-10mgcx0">Deployment</a> <a href="#/" class="active svelte-10mgcx0">Layout Builder</a> <a href="#/debug" class="svelte-10mgcx0">Debug Mode</a></nav></div> <div class="layout svelte-10mgcx0"><div class="sidebar svelte-10mgcx0"><!> <!> <!> <!> <input type="file" accept=".json" style="display: none;"/></div> <div class="battlefield-area svelte-10mgcx0"><div class="battlefield-container svelte-10mgcx0" role="presentation"><!></div> <div class="info svelte-10mgcx0"><p class="svelte-10mgcx0"> </p> <p class="hint svelte-10mgcx0">Scroll to zoom | Space+drag or middle-click to pan | Double-click to reset view</p></div></div></div></main> <!> <!>',1);function xl(e,r){jt(r,!1);const n=()=>Je(Xt,"$selectedTerrainId",c),a=()=>Je(Ut,"$selectedWallId",c),i=()=>Je(Dt,"$layoutTerrains",c),s=()=>Je(Tt,"$layoutWalls",c),o=()=>Je(pa,"$savedLayoutsList",c),[c,l]=jn(),f=R(),v=R();let g=R(!1),_=R(!1),h=R(""),S=null;tn(()=>{sn(),window.addEventListener("keydown",E)}),Ri(()=>{window.removeEventListener("keydown",E)});function E(M){if(M.target.tagName==="INPUT"||t(g)||t(_))return;const T=n()||a();if((M.key==="Delete"||M.key==="Backspace")&&T){M.preventDefault(),Te();return}if(T&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(M.key)){M.preventDefault();const I=M.shiftKey?.1:1;let N=0,y=0;switch(M.key){case"ArrowUp":y=-I;break;case"ArrowDown":y=I;break;case"ArrowLeft":N=-I;break;case"ArrowRight":N=I;break}if(n()){const $=i().find(A=>A.id===n());$&&Dt.updateTerrain(n(),{x:$.x+N,y:$.y+y})}else if(a()){const $=s().find(A=>A.id===a());$&&Tt.updateWall(a(),{x:$.x+N,y:$.y+y})}return}if(M.key==="c"&&(M.ctrlKey||M.metaKey)&&T){if(M.preventDefault(),n()){const I=i().find(N=>N.id===n());I&&(S={type:"terrain",data:{...I}})}else if(a()){const I=s().find(N=>N.id===a());I&&(S={type:"wall",data:{...I}})}return}if(M.key==="v"&&(M.ctrlKey||M.metaKey)&&S){if(M.preventDefault(),S.type==="terrain"){const I="terrain-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),N={...S.data,id:I,x:S.data.x+2,y:S.data.y+2};Dt.update(y=>[...y,N]),Xt.set(I),Ut.set(null),S.data.x+=2,S.data.y+=2}else if(S.type==="wall"){const I="wall-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),N={...S.data,id:I,x:S.data.x+2,y:S.data.y+2};Tt.update(y=>[...y,N]),Ut.set(I),Xt.set(null),S.data.x+=2,S.data.y+=2}return}if(M.key==="Escape"){ue();return}}let w=R(""),L=R("");function O(M,T){Dt.add(M,T)}function F(M){Tt.add(M)}function G(M){Xt.set(M),Ut.set(null)}function K(M){Ut.set(M),Xt.set(null)}function ue(){Xt.set(null),Ut.set(null)}function fe(M,T,I){Dt.updateTerrain(M,{x:T,y:I})}function j(M,T,I){Tt.updateWall(M,{x:T,y:I})}function se(M,T){Dt.updateTerrain(M,{rotation:T})}function ee(M,T){Tt.updateWall(M,{rotation:T})}function Te(){n()?(Dt.remove(n()),Xt.set(null)):a()&&(Tt.remove(a()),Ut.set(null))}function Pe(){const M=parseFloat(t(w)),T=parseFloat(t(L));!isNaN(M)&&!isNaN(T)&&(n()?Dt.updateTerrain(n(),{x:M,y:T}):a()&&Tt.updateWall(a(),{x:M,y:T}))}function Ue(){m(h,""),m(g,!0)}function J(){t(h).trim()&&(zo(t(h).trim()),sn(),m(g,!1),m(h,""))}function de(){sn(),m(_,!0)}function ve(M){Vo(M),Xt.set(null),Ut.set(null),m(_,!1)}function Me(M,T){T.stopPropagation(),confirm(`Delete layout "${M}"?`)&&(qo(M),sn())}function te(){confirm("Clear all terrain and walls?")&&(Dt.clear(),Tt.clear(),Xt.set(null),Ut.set(null))}function _e(M){return new Date(M).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function V(M){const T=ea.find(I=>I.shape===M);return T?T.label:M}function Q(){const M=i(),T=s(),I={version:1,exportedAt:Date.now(),terrains:M,walls:T},N=JSON.stringify(I,null,2),y=new Blob([N],{type:"application/json"}),$=URL.createObjectURL(y),A=document.createElement("a");A.href=$,A.download=`layout-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL($)}let ge=R();function ae(){t(ge).click()}function Z(M){const T=M.target.files[0];if(!T)return;const I=new FileReader;I.onload=N=>{try{const y=JSON.parse(N.target.result);y.terrains&&Array.isArray(y.terrains)&&Dt.set(y.terrains),y.walls&&Array.isArray(y.walls)&&Tt.set(y.walls),Xt.set(null),Ut.set(null)}catch(y){alert("Failed to import layout: Invalid file format"),console.error("Import error:",y)}},I.readAsText(T),M.target.value=""}q(()=>(i(),n()),()=>{m(f,i().find(M=>M.id===n()))}),q(()=>(s(),a()),()=>{m(v,s().find(M=>M.id===a()))}),q(()=>(t(f),t(v)),()=>{t(f)?(m(w,t(f).x.toFixed(1)),m(L,t(f).y.toFixed(1))):t(v)&&(m(w,t(v).x.toFixed(1)),m(L,t(v).y.toFixed(1)))}),wr(),Gt();var we=pl(),De=xe(we),rt=p(x(De),2),re=x(rt),z=x(re);gt(z,{title:"Add Terrain",children:(M,T)=>{var I=nl();Se(I,5,()=>ji,Ie,(N,y)=>{var $=rl(),A=x($);Y(()=>ke(A,(t(y),u(()=>t(y).label)))),U("click",$,()=>O(t(y).width,t(y).height)),b(N,$)}),b(M,I)},$$slots:{default:!0}});var me=p(z,2);gt(me,{title:"Add Wall",children:(M,T)=>{var I=il();Se(I,5,()=>ea,Ie,(N,y)=>{var $=al(),A=x($);Y(()=>ke(A,(t(y),u(()=>t(y).label)))),U("click",$,()=>F(t(y).shape)),b(N,$)}),b(M,I)},$$slots:{default:!0}});var X=p(me,2);{let M=Xe(()=>t(f)?"Terrain":t(v)?"Wall":"Item");gt(X,{get title(){return`Selected ${t(M)??""}`},children:(T,I)=>{var N=tt(),y=xe(N);{var $=P=>{var H=ll(),$e=x(H),ne=p(x($e),2),D=p($e,2),je=p(x(D),2),qe=p(D,2);{var Ne=Ve=>{var Ye=sl(),Ke=xe(Ye),st=p(x(Ke),2),Ft=x(st),vr=p(Ke,2),Jt=p(x(vr),2),Sr=x(Jt);Y(Le=>{ke(Ft,`${t(f),u(()=>t(f).width)??""}" x ${t(f),u(()=>t(f).height)??""}"`),ke(Sr,`${Le??""}Â°`)},[()=>(t(f),u(()=>Math.round(t(f).rotation)))]),b(Ve,Ye)},pt=Ve=>{var Ye=tt(),Ke=xe(Ye);{var st=Ft=>{var vr=ol(),Jt=xe(vr),Sr=p(x(Jt),2),Le=x(Sr),B=p(Jt,2),et=p(x(B),2),Ze=x(et);Y((k,he)=>{ke(Le,k),ke(Ze,`${he??""}Â°`)},[()=>(t(v),u(()=>V(t(v).shape))),()=>(t(v),u(()=>Math.round(t(v).rotation)))]),b(Ft,vr)};oe(Ke,Ft=>{t(v)&&Ft(st)},!0)}b(Ve,Ye)};oe(qe,Ve=>{t(f)?Ve(Ne):Ve(pt,!1)})}var mt=p(qe,2);un(ne,()=>t(w),Ve=>m(w,Ve)),U("change",ne,Pe),un(je,()=>t(L),Ve=>m(L,Ve)),U("change",je,Pe),U("click",mt,Te),b(P,H)},A=P=>{var H=cl();b(P,H)};oe(y,P=>{t(f)||t(v)?P($):P(A,!1)})}b(T,N)},$$slots:{default:!0}})}var at=p(X,2);gt(at,{title:"Layout",children:(M,T)=>{var I=ul(),N=x(I),y=p(N,2),$=p(y,2),A=x($),P=p(A,2),H=p($,2);Y(()=>y.disabled=(o(),u(()=>o().length===0))),U("click",N,Ue),U("click",y,de),U("click",A,Q),U("click",P,ae),U("click",H,te),b(M,I)},$$slots:{default:!0}});var it=p(at,2);Di(it,M=>m(ge,M),()=>t(ge));var Be=p(re,2),Re=x(Be),ot=x(Re);Yn(ot,{children:la,$$slots:{default:(M,T)=>{const I=Xe(()=>T.screenToSvg);var N=dl(),y=xe(N);Se(y,1,i,A=>A.id,(A,P)=>{{let H=Xe(()=>(t(P),n(),u(()=>t(P).id===n())));Ni(A,{get id(){return t(P),u(()=>t(P).id)},get x(){return t(P),u(()=>t(P).x)},get y(){return t(P),u(()=>t(P).y)},get width(){return t(P),u(()=>t(P).width)},get height(){return t(P),u(()=>t(P).height)},get rotation(){return t(P),u(()=>t(P).rotation)},get selected(){return t(H)},get screenToSvg(){return t(I)},onSelect:G,onDrag:fe,onRotate:se})}});var $=p(y,2);Se($,1,s,A=>A.id,(A,P)=>{{let H=Xe(()=>(t(P),a(),u(()=>t(P).id===a())));xa(A,{get id(){return t(P),u(()=>t(P).id)},get x(){return t(P),u(()=>t(P).x)},get y(){return t(P),u(()=>t(P).y)},get shape(){return t(P),u(()=>t(P).shape)},get rotation(){return t(P),u(()=>t(P).rotation)},get selected(){return t(H)},get screenToSvg(){return t(I)},onSelect:K,onDrag:j,onRotate:ee})}}),b(M,N)}}});var Ht=p(Re,2),Bt=x(Ht),C=x(Bt),ie=p(De,2);{var pe=M=>{var T=fl(),I=x(T),N=p(x(I),2),y=p(x(N),2),$=p(N,2),A=x($),P=p(A,2);Y(H=>P.disabled=H,[()=>(t(h),u(()=>!t(h).trim()))]),un(y,()=>t(h),H=>m(h,H)),U("keydown",y,H=>H.key==="Enter"&&J()),U("click",A,()=>m(g,!1)),U("click",P,J),U("click",I,Da(function(H){Aa.call(this,r,H)})),U("click",T,()=>m(g,!1)),b(M,T)};oe(ie,M=>{t(g)&&M(pe)})}var ze=p(ie,2);{var Oe=M=>{var T=gl(),I=x(T),N=p(x(I),2);{var y=H=>{var $e=vl();b(H,$e)},$=H=>{var $e=yl();Se($e,5,o,Ie,(ne,D)=>{var je=hl(),qe=x(je),Ne=x(qe),pt=x(Ne),mt=p(Ne,2),Ve=x(mt),Ye=p(qe,2);Y(Ke=>{ke(pt,(t(D),u(()=>t(D).name))),ke(Ve,`${t(D),u(()=>t(D).terrainCount)??""} terrain${t(D),u(()=>t(D).terrainCount!==1?"s":"")??""}, ${t(D),u(()=>t(D).wallCount||0)??""} wall${t(D),u(()=>(t(D).wallCount||0)!==1?"s":"")??""} Â· ${Ke??""}`)},[()=>(t(D),u(()=>_e(t(D).savedAt)))]),U("click",Ye,Ke=>Me(t(D).name,Ke)),U("click",je,()=>ve(t(D).name)),b(ne,je)}),b(H,$e)};oe(N,H=>{o(),u(()=>o().length===0)?H(y):H($,!1)})}var A=p(N,2),P=x(A);U("click",P,()=>m(_,!1)),U("click",I,Da(function(H){Aa.call(this,r,H)})),U("click",T,()=>m(_,!1)),b(M,T)};oe(ze,M=>{t(_)&&M(Oe)})}Y(()=>ke(C,`Battlefield: 60" x 44" | ${i(),u(()=>i().length)??""} terrain${i(),u(()=>i().length!==1?"s":"")??""} | ${s(),u(()=>s().length)??""} wall${s(),u(()=>s().length!==1?"s":"")??""}`)),U("change",it,Z),U("click",Re,ue),b(e,we),Yt(),l()}const Fi=1/25.4,Xi=40*Fi/2,Ui=3+20*Fi;function Ki(e="item"){return e+"-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function _l(){const{subscribe:e,set:r,update:n}=ct([]);return{subscribe:e,set:r,update:n,add(a){const i=Ki("zone");return n(s=>[...s,{id:i,...a}]),i},updateZone(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])}}}function ml(){const{subscribe:e,set:r,update:n}=ct([]);return{subscribe:e,set:r,update:n,add(a,i,s=!1){const o=Ki("obj"),c=Math.round(a),l=Math.round(i);return n(f=>[...f,{id:o,x:c,y:l,isPrimary:s}]),o},updateObjective(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])}}}_l();ml();const bl=[{name:"Dawn of War",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:32},{type:"L",x:60,y:32},{type:"L",x:60,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:0,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:12},{type:"L",x:0,y:12},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:10,y:22,isPrimary:!1},{x:50,y:22,isPrimary:!1},{x:30,y:6,isPrimary:!1},{x:30,y:38,isPrimary:!1}]},{name:"Hammer and Anvil",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:18,y:0},{type:"L",x:18,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:42,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:44},{type:"L",x:42,y:44},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:30,y:6,isPrimary:!1},{x:30,y:38,isPrimary:!1},{x:10,y:22,isPrimary:!1},{x:50,y:22,isPrimary:!1}]},{name:"Tipping Point",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:12,y:0},{type:"L",x:12,y:22},{type:"L",x:20,y:22},{type:"L",x:20,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:40,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:44},{type:"L",x:48,y:44},{type:"L",x:48,y:22},{type:"L",x:40,y:22},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:14,y:34,isPrimary:!1},{x:22,y:8,isPrimary:!1},{x:38,y:36,isPrimary:!1},{x:46,y:10,isPrimary:!1}]},{name:"Search and Destroy",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:22},{type:"L",x:21,y:22},{type:"A",rx:9,ry:9,rotation:0,largeArc:0,sweep:0,x:30,y:31},{type:"L",x:30,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:30,y:0},{type:"L",x:30,y:13},{type:"A",rx:9,ry:9,rotation:0,largeArc:0,sweep:1,x:39,y:22},{type:"L",x:60,y:22},{type:"L",x:60,y:0},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:14,y:10,isPrimary:!1},{x:46,y:34,isPrimary:!1},{x:14,y:34,isPrimary:!1},{x:46,y:10,isPrimary:!1}]},{name:"Sweeping Engagement",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:0,y:8},{type:"L",x:30,y:8},{type:"L",x:30,y:14},{type:"L",x:60,y:14},{type:"L",x:60,y:0},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:0,y:44},{type:"L",x:60,y:44},{type:"L",x:60,y:36},{type:"L",x:30,y:36},{type:"L",x:30,y:30},{type:"L",x:0,y:30},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:10,y:18,isPrimary:!1},{x:50,y:26,isPrimary:!1},{x:18,y:38,isPrimary:!1},{x:42,y:6,isPrimary:!1}]},{name:"Crucible of Battle",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:30,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:60,y:44},{type:"L",x:30,y:0},{type:"L",x:60,y:0},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:20,y:8,isPrimary:!1},{x:40,y:36,isPrimary:!1},{x:14,y:34,isPrimary:!1},{x:46,y:10,isPrimary:!1}]}];function ta(e){return e.map(r=>{switch(r.type){case"M":return`M ${r.x} ${r.y}`;case"L":return`L ${r.x} ${r.y}`;case"A":return`A ${r.rx} ${r.ry} ${r.rotation} ${r.largeArc} ${r.sweep} ${r.x} ${r.y}`;case"Z":return"Z";default:return""}}).join(" ")}const Mn=ct(null),Br=ct(null),dn=ct(null),Zi=Lr([Br,dn],([e,r])=>{if(!e)return{terrains:[],walls:[]};if(r==="preset"){const n=Yi.find(a=>a.name===e);return n?{terrains:n.terrains||[],walls:n.walls||[]}:{terrains:[],walls:[]}}else if(r==="saved"){const n=localStorage.getItem("warhammer-deployment-layouts");if(n)try{const a=JSON.parse(n);if(a[e])return{terrains:a[e].terrains||[],walls:a[e].walls||[]}}catch(a){console.error("Failed to load layout:",a)}}return{terrains:[],walls:[]}});var wl=le('<div class="selected-item svelte-1jotvmi"><span class="selected-name svelte-1jotvmi"> </span> <button class="small secondary svelte-1jotvmi">Change</button></div>'),Ll=le('<button class="svelte-1jotvmi"> </button>'),Sl=le('<div class="button-group svelte-1jotvmi"></div>'),kl=le('<div class="selected-item svelte-1jotvmi"><span class="selected-name svelte-1jotvmi"> </span> <button class="small secondary svelte-1jotvmi">Change</button></div>'),Ml=le('<button class="svelte-1jotvmi"> </button>'),El=le('<button class="svelte-1jotvmi"> </button>'),Tl=le('<div class="layout-group svelte-1jotvmi"><h4 class="svelte-1jotvmi">Saved</h4> <div class="button-group svelte-1jotvmi"></div></div>'),Pl=le('<div class="layout-sections svelte-1jotvmi"><div class="layout-group svelte-1jotvmi"><h4 class="svelte-1jotvmi">Presets</h4> <div class="button-group svelte-1jotvmi"></div></div> <!></div>'),$l=le('<div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Objectives:</span> <span class="value svelte-1jotvmi"> </span></div>'),Dl=le('<div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Pieces:</span> <span class="value svelte-1jotvmi"> </span></div>'),Rl=le('<div class="summary svelte-1jotvmi"><div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Deployment:</span> <span class="value svelte-1jotvmi"> </span></div> <div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Terrain:</span> <span class="value svelte-1jotvmi"> </span></div> <!> <!></div>'),Al=ce('<path stroke-width="0.10" stroke-dasharray="0.5,0.25"></path>'),Cl=ce('<circle stroke-width="0.05" stroke-dasharray="0.3,0.15"></circle><circle stroke="#000" stroke-width="0.06"></circle><circle r="0.15" fill="#000"></circle>',1),Il=ce("<!><!>",1),Ol=ce('<g><rect fill="rgba(139, 90, 43, 0.6)" stroke="#8b5a2b" stroke-width="0.1"></rect></g>'),Nl=ce('<g><path fill="rgba(139, 69, 19, 0.8)" stroke="#5c3317" stroke-width="0.1"></path></g>'),Wl=ce("<!><!><!>",1),jl=le('<main class="svelte-1jotvmi"><div class="header svelte-1jotvmi"><h1 class="svelte-1jotvmi">Battlefield Setup</h1> <nav class="nav-links svelte-1jotvmi"><a href="#/setup" class="active svelte-1jotvmi">Battlefield Setup</a> <a href="#/deployment" class="svelte-1jotvmi">Deployment</a> <a href="#/" class="svelte-1jotvmi">Layout Builder</a> <a href="#/debug" class="svelte-1jotvmi">Debug Mode</a></nav></div> <div class="layout svelte-1jotvmi"><div class="sidebar svelte-1jotvmi"><!> <!> <!></div> <div class="battlefield-area svelte-1jotvmi"><div class="battlefield-container svelte-1jotvmi"><!></div> <div class="info svelte-1jotvmi"><p class="svelte-1jotvmi">Battlefield: 60" x 44"</p> <p class="hint svelte-1jotvmi">Scroll to zoom | Space+drag to pan | Double-click to reset view</p></div></div></div></main>');function Yl(e,r){jt(r,!1);const n=()=>Je(Mn,"$selectedDeployment",o),a=()=>Je(Br,"$selectedLayoutName",o),i=()=>Je(pa,"$savedLayoutsList",o),s=()=>Je(Zi,"$loadedTerrain",o),[o,c]=jn();tn(()=>{sn()});function l(j){Mn.set(j)}function f(j){Br.set(j.name),dn.set("preset")}function v(j){Br.set(j),dn.set("saved")}function g(){Br.set(null),dn.set(null)}function _(){Mn.set(null)}function h(j){let ee=[];switch(j.shape){case"L-4x8":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];break;case"L-4x8-mirror":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:8},{x:-4+.5,y:8},{x:-4+.5,y:8-.5},{x:0,y:8-.5}];break;case"C-4-8-4":ee=[{x:0,y:0},{x:4,y:0},{x:4,y:.5},{x:.5,y:.5},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];break;case"L-5x6":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:5,y:6-.5},{x:5,y:6},{x:0,y:6}];break;case"L-5x6-mirror":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-5+.5,y:6},{x:-5+.5,y:6-.5},{x:0,y:6-.5}];break;case"L-4x6":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:4,y:6-.5},{x:4,y:6},{x:0,y:6}];break;case"L-4x6-mirror":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-4+.5,y:6},{x:-4+.5,y:6-.5},{x:0,y:6-.5}];break;default:return""}return`M ${ee.map(Te=>`${j.x+Te.x},${j.y+Te.y}`).join(" L ")} Z`}function S(j){switch(j.shape){case"L-4x8":return{x:j.x+2,y:j.y+4};case"L-4x8-mirror":return{x:j.x-2+.5,y:j.y+4};case"C-4-8-4":return{x:j.x+2,y:j.y+4};case"L-5x6":return{x:j.x+2.5,y:j.y+3};case"L-5x6-mirror":return{x:j.x-2.5+.5,y:j.y+3};case"L-4x6":return{x:j.x+2,y:j.y+3};case"L-4x6-mirror":return{x:j.x-2+.5,y:j.y+3};default:return{x:j.x,y:j.y}}}Gt();var E=jl(),w=p(x(E),2),L=x(w),O=x(L);gt(O,{title:"Deployment",children:(j,se)=>{var ee=tt(),Te=xe(ee);{var Pe=J=>{var de=wl(),ve=x(de),Me=x(ve),te=p(ve,2);Y(()=>ke(Me,n().name)),U("click",te,_),b(J,de)},Ue=J=>{var de=Sl();Se(de,5,()=>bl,Ie,(ve,Me)=>{var te=Ll(),_e=x(te);Y(()=>ke(_e,t(Me).name)),U("click",te,()=>l(t(Me))),b(ve,te)}),b(J,de)};oe(Te,J=>{n()?J(Pe):J(Ue,!1)})}b(j,ee)},$$slots:{default:!0}});var F=p(O,2);gt(F,{title:"Terrain Layout",children:(j,se)=>{var ee=tt(),Te=xe(ee);{var Pe=J=>{var de=kl(),ve=x(de),Me=x(ve),te=p(ve,2);Y(()=>ke(Me,a())),U("click",te,g),b(J,de)},Ue=J=>{var de=Pl(),ve=x(de),Me=p(x(ve),2);Se(Me,5,()=>Yi,Ie,(V,Q)=>{var ge=Ml(),ae=x(ge);Y(()=>ke(ae,t(Q).name)),U("click",ge,()=>f(t(Q))),b(V,ge)});var te=p(ve,2);{var _e=V=>{var Q=Tl(),ge=p(x(Q),2);Se(ge,5,i,Ie,(ae,Z)=>{var we=El(),De=x(we);Y(()=>ke(De,t(Z).name)),U("click",we,()=>v(t(Z).name)),b(ae,we)}),b(V,Q)};oe(te,V=>{i().length>0&&V(_e)})}b(J,de)};oe(Te,J=>{a()?J(Pe):J(Ue,!1)})}b(j,ee)},$$slots:{default:!0}});var G=p(F,2);gt(G,{title:"Summary",children:(j,se)=>{var ee=Rl(),Te=x(ee),Pe=p(x(Te),2),Ue=x(Pe),J=p(Te,2),de=p(x(J),2),ve=x(de),Me=p(J,2);{var te=Q=>{var ge=$l(),ae=p(x(ge),2),Z=x(ae);Y(()=>ke(Z,n().objectives.length)),b(Q,ge)};oe(Me,Q=>{n()&&Q(te)})}var _e=p(Me,2);{var V=Q=>{var ge=Dl(),ae=p(x(ge),2),Z=x(ae);Y(()=>ke(Z,`${s().terrains.length??""} terrain, ${s().walls.length??""} walls`)),b(Q,ge)};oe(_e,Q=>{(s().terrains.length>0||s().walls.length>0)&&Q(V)})}Y(()=>{ke(Ue,n()?.name||"None"),ke(ve,a()||"None")}),b(j,ee)},$$slots:{default:!0}});var K=p(L,2),ue=x(K),fe=x(ue);Yn(fe,{children:(j,se)=>{var ee=Wl(),Te=xe(ee);{var Pe=de=>{var ve=Il(),Me=xe(ve);Se(Me,1,()=>n().zones,Ie,(_e,V)=>{var Q=Al();Y(ge=>{d(Q,"d",ge),d(Q,"fill",t(V).color),d(Q,"stroke",t(V).borderColor)},[()=>ta(t(V).path)]),b(_e,Q)});var te=p(Me);Se(te,1,()=>n().objectives,Ie,(_e,V)=>{const Q=Xe(()=>t(V).isPrimary?"#fbbf24":"#9ca3af"),ge=Xe(()=>t(V).isPrimary?"rgba(251, 191, 36, 0.15)":"rgba(156, 163, 175, 0.15)");var ae=Cl(),Z=xe(ae),we=p(Z),De=p(we);Y(()=>{d(Z,"cx",t(V).x),d(Z,"cy",t(V).y),d(Z,"r",Ui),d(Z,"fill",t(ge)),d(Z,"stroke",t(Q)),d(we,"cx",t(V).x),d(we,"cy",t(V).y),d(we,"r",Xi),d(we,"fill",t(Q)),d(De,"cx",t(V).x),d(De,"cy",t(V).y)}),b(_e,ae)}),b(de,ve)};oe(Te,de=>{n()&&de(Pe)})}var Ue=p(Te);Se(Ue,1,()=>s().terrains,Ie,(de,ve)=>{const Me=Xe(()=>t(ve).x+t(ve).width/2),te=Xe(()=>t(ve).y+t(ve).height/2);var _e=Ol(),V=x(_e);Y(()=>{d(_e,"transform",`rotate(${t(ve).rotation??""}, ${t(Me)??""}, ${t(te)??""})`),d(V,"x",t(ve).x),d(V,"y",t(ve).y),d(V,"width",t(ve).width),d(V,"height",t(ve).height)}),b(de,_e)});var J=p(Ue);Se(J,1,()=>s().walls,Ie,(de,ve)=>{const Me=Xe(()=>S(t(ve)));var te=Nl(),_e=x(te);Y(V=>{d(te,"transform",`rotate(${t(ve).rotation??""}, ${t(Me).x??""}, ${t(Me).y??""})`),d(_e,"d",V)},[()=>h(t(ve))]),b(de,te)}),b(j,ee)},$$slots:{default:!0}}),b(e,E),Yt(),c()}function zi(){const{subscribe:e,set:r,update:n}=ct({past:[],future:[]});return{subscribe:e,push(a){n(i=>({past:[...i.past,a],future:[]}))},undo(){let a=null;return n(i=>{if(i.past.length===0)return i;const s=[...i.past];return a=s.pop(),{past:s,future:[a,...i.future]}}),a},redo(){let a=null;return n(i=>{if(i.future.length===0)return i;const s=[...i.future];return a=s.shift(),{past:[...i.past,a],future:s}}),a},canUndo(){return cr({subscribe:e}).past.length>0},canRedo(){return cr({subscribe:e}).future.length>0},clear(){r({past:[],future:[]})}}}const on=zi(),ra=zi(),Ge=1/25.4,Wt={circles:[{type:"25mm",radius:25*Ge/2,label:"25mm"},{type:"28.5mm",radius:28.5*Ge/2,label:"28mm.5"},{type:"32mm",radius:32*Ge/2,label:"32mm"},{type:"40mm",radius:40*Ge/2,label:"40mm"},{type:"50mm",radius:50*Ge/2,label:"50mm"},{type:"60mm",radius:60*Ge/2,label:"60mm"},{type:"80mm",radius:80*Ge/2,label:"80mm"},{type:"90mm",radius:90*Ge/2,label:"90mm"},{type:"100mm",radius:100*Ge/2,label:"100mm"},{type:"130mm",radius:130*Ge/2,label:"130mm"},{type:"160mm",radius:160*Ge/2,label:"160mm"}],ovals:[{type:"60x35.5mm",width:60*Ge,height:35.5*Ge,label:"60Ã35.5mm"},{type:"75x42mm",width:75*Ge,height:42*Ge,label:"75Ã42mm"},{type:"90x52.5mm",width:90*Ge,height:52.5*Ge,label:"90Ã52.5mm"},{type:"105x70mm",width:105*Ge,height:70*Ge,label:"105Ã70mm"},{type:"120x90mm",width:120*Ge,height:90*Ge,label:"120Ã90mm"},{type:"150x95mm",width:150*Ge,height:95*Ge,label:"150Ã95mm"},{type:"170x109mm",width:170*Ge,height:109*Ge,label:"170Ã109mm"}]};function tr(e,r=null){const n=Wt.circles.find(i=>i.type===e);if(n)return n;const a=Wt.ovals.find(i=>i.type===e);return a||(Mr(e)&&r?{type:e,width:r.customWidth,height:r.customHeight,label:`${r.customWidth.toFixed(1)}"Ã${r.customHeight.toFixed(1)}"`}:null)}function rr(e){return Wt.ovals.some(r=>r.type===e)}function Mr(e){return e&&e.startsWith("rect-")}function Hl(){return"model-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function Vi(e){const{subscribe:r,set:n,update:a}=ct([]);return{subscribe:r,set:n,update:a,add(i,s,o,c,l=null,f=!1){const v=Hl(),g={id:v,baseType:i,playerId:s,x:o,y:c,rotation:0};return l&&l.width&&l.height&&(g.customWidth=l.width,g.customHeight=l.height),a(_=>[..._,g]),!f&&e&&e.push({type:"add",modelId:v,model:{...g}}),v},updateModel(i,s,o=!1){let c=null,l=null;if(!o&&e){const v=cr({subscribe:r}).find(g=>g.id===i);v&&(c={...v},"x"in s||"y"in s?l="move":"rotation"in s&&(l="rotate"))}if(a(f=>f.map(v=>v.id===i?{...v,...s}:v)),!o&&e&&l&&c){const v=cr({subscribe:r}).find(g=>g.id===i);e.push({type:l,modelId:i,before:l==="move"?{x:c.x,y:c.y}:{rotation:c.rotation},after:l==="move"?{x:v.x,y:v.y}:{rotation:v.rotation}})}},remove(i,s=!1){let o=null;!s&&e&&(o=cr({subscribe:r}).find(l=>l.id===i)),a(c=>c.filter(l=>l.id!==i)),!s&&e&&o&&e.push({type:"remove",modelId:i,model:{...o}})},removeByPlayer(i){a(s=>s.filter(o=>o.playerId!==i))},clear(){n([]),e&&e.clear()},undo(){if(!e)return;const i=e.undo();if(i)switch(i.type){case"add":this.remove(i.modelId,!0);break;case"remove":a(s=>[...s,i.model]);break;case"move":this.updateModel(i.modelId,i.before,!0);break;case"rotate":this.updateModel(i.modelId,i.before,!0);break}},redo(){if(!e)return;const i=e.redo();if(i)switch(i.type){case"add":a(s=>[...s,i.model]);break;case"remove":this.remove(i.modelId,!0);break;case"move":this.updateModel(i.modelId,i.after,!0);break;case"rotate":this.updateModel(i.modelId,i.after,!0);break}}}}const ut=Vi(on),Bl=Lr(ut,e=>e.filter(r=>r.playerId===1)),Fl=Lr(ut,e=>e.filter(r=>r.playerId===2)),gr=ct(null);Lr([ut,gr],([e,r])=>r?e.find(n=>n.id===r):null);const pr=Vi(ra),kr=ct(null);Lr([pr,kr],([e,r])=>r?e.find(n=>n.id===r):null);var Xl=ce('<g><rect role="button" tabindex="0" class="svelte-hycs6b"></rect></g>'),Ul=ce('<g><ellipse role="button" tabindex="0" class="svelte-hycs6b"></ellipse></g>'),Kl=ce('<circle role="button" tabindex="0" class="svelte-hycs6b"></circle>'),Zl=ce('<text text-anchor="middle" dominant-baseline="middle" font-size="0.4" font-weight="bold" fill="white" pointer-events="none" class="model-name"> </text>'),zl=ce('<line stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-hycs6b"></circle>',1),Vl=ce('<line stroke="#fbbf24" stroke-width="0.12" stroke-dasharray="0.3,0.15" pointer-events="none"></line><circle r="0.25" fill="#fbbf24" pointer-events="none" class="svelte-hycs6b"></circle><text text-anchor="middle" dominant-baseline="middle" font-size="0.5" font-weight="bold" fill="#fbbf24" stroke="#000" stroke-width="0.05" paint-order="stroke" pointer-events="none" class="drag-ruler-label svelte-hycs6b"> </text>',1),ql=ce("<g><!><!><!><!></g>");function An(e,r){jt(r,!1);const n=R(),a=R(),i=R(),s=R(),o=R(),c=R(),l=R(),f=R(),v=R(),g=R(),_=R(),h=R(),S=R(),E=R(),w=R(),L=R(),O=R(),F=R();let G=be(r,"id",8),K=be(r,"x",8),ue=be(r,"y",8),fe=be(r,"baseType",8),j=be(r,"playerId",8),se=be(r,"rotation",8,0),ee=be(r,"selected",8,!1),Te=be(r,"name",8,""),Pe=be(r,"customWidth",8,null),Ue=be(r,"customHeight",8,null),J=be(r,"screenToSvg",8),de=be(r,"onSelect",8,()=>{}),ve=be(r,"onDrag",8,()=>{}),Me=be(r,"onDragEnd",8,()=>{}),te=be(r,"onRotate",8,()=>{}),_e=be(r,"onRotateEnd",8,()=>{}),V=be(r,"onRename",8,()=>{}),Q=R(!1),ge=!1,ae={x:0,y:0},Z=R(null),we=null;function De(T){T.stopPropagation(),de()(G())}function rt(T){T.stopPropagation();const I=prompt("Model name:",Te());I!==null&&V()(G(),I)}function re(T){if(T.button!==0)return;T.preventDefault(),T.stopPropagation(),de()(G()),m(Q,!0),m(Z,{x:K(),y:ue()});const I=J()(T.clientX,T.clientY);ae={x:I.x-K(),y:I.y-ue()},window.addEventListener("mousemove",z),window.addEventListener("mouseup",me)}function z(T){if(!t(Q))return;const I=J()(T.clientX,T.clientY);let N=I.x-ae.x,y=I.y-ae.y;ve()(G(),N,y)}function me(){t(Q)&&t(Z)&&((t(Z).x!==K()||t(Z).y!==ue())&&Me()(G(),t(Z).x,t(Z).y,K(),ue()),m(Z,null)),m(Q,!1),window.removeEventListener("mousemove",z),window.removeEventListener("mouseup",me)}function X(T){T.preventDefault(),T.stopPropagation(),ge=!0,we=se(),window.addEventListener("mousemove",at),window.addEventListener("mouseup",it)}function at(T){if(!ge)return;const I=J()(T.clientX,T.clientY),N=I.x-K(),y=I.y-ue();let $=Math.atan2(y,N)*180/Math.PI+45;T.shiftKey||($=Math.round($/15)*15),te()(G(),$)}function it(){ge&&we!==null&&(we!==se()&&_e()(G(),we,se()),we=null),ge=!1,window.removeEventListener("mousemove",at),window.removeEventListener("mouseup",it)}q(()=>(W(Pe()),W(Ue())),()=>{m(n,{customWidth:Pe(),customHeight:Ue()})}),q(()=>(W(fe()),t(n)),()=>{m(a,tr(fe(),t(n)))}),q(()=>W(fe()),()=>{m(i,rr(fe()))}),q(()=>W(fe()),()=>{m(s,Mr(fe()))}),q(()=>W(j()),()=>{m(o,j()===1?"#3b82f6":"#ef4444")}),q(()=>W(j()),()=>{m(c,j()===1?"rgba(59, 130, 246, 0.5)":"rgba(239, 68, 68, 0.5)")}),q(()=>W(ee()),()=>{m(l,ee()?.15:.1)}),q(()=>t(a),()=>{m(f,t(a)?.radius||.5)}),q(()=>t(a),()=>{m(v,t(a)?.width?t(a).width/2:0)}),q(()=>t(a),()=>{m(g,t(a)?.height?t(a).height/2:0)}),q(()=>(t(s),W(Pe())),()=>{m(_,t(s)&&Pe()||0)}),q(()=>(t(s),W(Ue())),()=>{m(h,t(s)&&Ue()||0)}),q(()=>(t(i),t(v),t(g),t(s),t(_),t(h)),()=>{m(S,t(i)?Math.max(t(v),t(g))+1:t(s)?Math.max(t(_),t(h))/2+1:0)}),q(()=>(W(K()),t(S),W(se())),()=>{m(E,K()+t(S)*Math.cos((se()-45)*Math.PI/180))}),q(()=>(W(ue()),t(S),W(se())),()=>{m(w,ue()+t(S)*Math.sin((se()-45)*Math.PI/180))}),q(()=>(t(Q),t(Z),W(K()),W(ue())),()=>{m(L,t(Q)&&t(Z)?Math.sqrt(Math.pow(K()-t(Z).x,2)+Math.pow(ue()-t(Z).y,2)):0)}),q(()=>(t(Q),t(Z),W(K())),()=>{m(O,t(Q)&&t(Z)?(t(Z).x+K())/2:0)}),q(()=>(t(Q),t(Z),W(ue())),()=>{m(F,t(Q)&&t(Z)?(t(Z).y+ue())/2:0)}),wr(),Gt();var Be=ql();let Re;var ot=x(Be);{var Ht=T=>{var I=Xl(),N=x(I);Y(()=>{d(I,"transform",`rotate(${se()??""}, ${K()??""}, ${ue()??""})`),d(N,"x",K()-t(_)/2),d(N,"y",ue()-t(h)/2),d(N,"width",t(_)),d(N,"height",t(h)),d(N,"fill",ee()?t(o):t(c)),d(N,"stroke",t(o)),d(N,"stroke-width",t(l))}),U("click",N,De),U("dblclick",N,rt),U("mousedown",N,re),b(T,I)},Bt=T=>{var I=tt(),N=xe(I);{var y=A=>{var P=Ul(),H=x(P);Y(()=>{d(P,"transform",`rotate(${se()??""}, ${K()??""}, ${ue()??""})`),d(H,"cx",K()),d(H,"cy",ue()),d(H,"rx",t(v)),d(H,"ry",t(g)),d(H,"fill",ee()?t(o):t(c)),d(H,"stroke",t(o)),d(H,"stroke-width",t(l))}),U("click",H,De),U("dblclick",H,rt),U("mousedown",H,re),b(A,P)},$=A=>{var P=Kl();Y(()=>{d(P,"cx",K()),d(P,"cy",ue()),d(P,"r",t(f)),d(P,"fill",ee()?t(o):t(c)),d(P,"stroke",t(o)),d(P,"stroke-width",t(l))}),U("click",P,De),U("dblclick",P,rt),U("mousedown",P,re),b(A,P)};oe(N,A=>{t(i)?A(y):A($,!1)},!0)}b(T,I)};oe(ot,T=>{t(s)?T(Ht):T(Bt,!1)})}var C=p(ot);{var ie=T=>{var I=Zl(),N=x(I);Y(()=>{d(I,"x",K()),d(I,"y",ue()),ke(N,Te())}),b(T,I)};oe(C,T=>{Te()&&T(ie)})}var pe=p(C);{var ze=T=>{var I=zl(),N=xe(I),y=p(N);Y(()=>{d(N,"x1",K()),d(N,"y1",ue()),d(N,"x2",t(E)),d(N,"y2",t(w)),d(N,"stroke",t(o)),d(y,"cx",t(E)),d(y,"cy",t(w)),d(y,"fill",t(o)),d(y,"stroke",j()===1?"#1d4ed8":"#b91c1c")}),U("mousedown",y,X),b(T,I)};oe(pe,T=>{ee()&&(t(i)||t(s))&&T(ze)})}var Oe=p(pe);{var M=T=>{var I=Vl(),N=xe(I),y=p(N),$=p(y),A=x($);Y(P=>{d(N,"x1",(t(Z),u(()=>t(Z).x))),d(N,"y1",(t(Z),u(()=>t(Z).y))),d(N,"x2",K()),d(N,"y2",ue()),d(y,"cx",(t(Z),u(()=>t(Z).x))),d(y,"cy",(t(Z),u(()=>t(Z).y))),d($,"x",t(O)),d($,"y",t(F)-.5),ke(A,`${P??""}"`)},[()=>(t(L),u(()=>t(L).toFixed(2)))]),b(T,I)};oe(Oe,T=>{t(Q)&&t(Z)&&t(L)>.1&&T(M)})}Y(()=>Re=Zt(Be,0,"model-base svelte-hycs6b",null,Re,{selected:ee(),dragging:t(Q)})),b(e,Be),Yt()}var Gl=ce('<ellipse fill="none" stroke-width="2"></ellipse>'),Jl=ce('<circle fill="none" stroke-width="2"></circle>'),Ql=le('<button class="palette-item svelte-1urec28"><svg class="svelte-1urec28"><!></svg> <span class="label svelte-1urec28"> </span></button>');function Cn(e,r){jt(r,!1);const n=R(),a=R(),i=R(),s=R(),o=R(),c=R();let l=be(r,"baseSize",8),f=be(r,"playerId",8),v=be(r,"onDragStart",8,()=>{});const g=3;function _(G){G.button===0&&(G.preventDefault(),v()(l(),G))}q(()=>W(f()),()=>{m(n,f()===1?"#3b82f6":"#ef4444")}),q(()=>W(l()),()=>{m(a,l().width!==void 0)}),q(()=>(t(a),W(l())),()=>{m(i,t(a)?null:l().radius*g)}),q(()=>(t(a),W(l())),()=>{m(s,t(a)?l().width/2*g:null)}),q(()=>(t(a),W(l())),()=>{m(o,t(a)?l().height/2*g:null)}),q(()=>(t(a),W(l())),()=>{m(c,t(a)?Math.max(l().width,l().height)*g:l().radius*2*g)}),wr(),Gt();var h=Ql(),S=x(h),E=x(S);{var w=G=>{var K=Gl();Y(()=>{d(K,"cx",(t(c)+8)/2),d(K,"cy",(t(c)+8)/2),d(K,"rx",t(s)),d(K,"ry",t(o)),d(K,"stroke",t(n))}),b(G,K)},L=G=>{var K=Jl();Y(()=>{d(K,"cx",(t(c)+8)/2),d(K,"cy",(t(c)+8)/2),d(K,"r",t(i)),d(K,"stroke",t(n))}),b(G,K)};oe(E,G=>{t(a)?G(w):G(L,!1)})}var O=p(S,2),F=x(O);Y(()=>{fo(h,`border-color: ${t(n)??""}`),d(h,"title",(W(l()),u(()=>l().label))),d(S,"width",t(c)+8),d(S,"height",t(c)+8),d(S,"viewBox",`0 0 ${t(c)+8} ${t(c)+8}`),ke(F,(W(l()),u(()=>l().label)))}),U("mousedown",h,_),b(e,h),Yt()}var ec=le('<div class="player-toggle svelte-1g40uyy"><button>Player 1</button> <button>Player 2</button></div> <div class="base-palette svelte-1g40uyy"><div class="palette-section svelte-1g40uyy"><h4 class="svelte-1g40uyy">Circles</h4> <div class="palette-grid svelte-1g40uyy"></div></div> <div class="palette-section svelte-1g40uyy"><h4 class="svelte-1g40uyy">Ovals</h4> <div class="palette-grid svelte-1g40uyy"></div></div></div>',1),tc=le('<div class="rect-hull-form svelte-1g40uyy"><div class="field svelte-1g40uyy"><label for="rect-width" class="svelte-1g40uyy">Width (inches)</label> <input id="rect-width" type="number" min="1" max="20" step="0.5" class="svelte-1g40uyy"/></div> <div class="field svelte-1g40uyy"><label for="rect-height" class="svelte-1g40uyy">Height (inches)</label> <input id="rect-height" type="number" min="1" max="20" step="0.5" class="svelte-1g40uyy"/></div> <button class="svelte-1g40uyy"> </button></div>'),rc=le('<div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Rotation</span> <span class="value svelte-1g40uyy"> </span></div>'),nc=le('<div class="field svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> Show Debug Rays</label></div>'),ac=le('<div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">LoS Status</span> <span class="value svelte-1g40uyy"> </span></div>'),ic=le('<div class="edit-form svelte-1g40uyy"><div class="field svelte-1g40uyy"><label for="model-name">Name</label> <input id="model-name" type="text"/></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Base Type</span> <span class="value svelte-1g40uyy"> </span></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Player</span> <span class="value svelte-1g40uyy"> </span></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Position</span> <span class="value svelte-1g40uyy"> </span></div> <!> <div class="field svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> Show Line of Sight</label></div> <!> <!> <button class="danger svelte-1g40uyy">Remove</button></div>'),sc=le('<p class="hint svelte-1g40uyy">Click a model to select it</p>'),oc=le('<div class="visualization-options svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> P1 Denial Zones (9")</label> <label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> P2 Denial Zones (9")</label></div>'),lc=le('<div class="button-group vertical svelte-1g40uyy"><div class="button-row svelte-1g40uyy"><button title="Undo (Ctrl+Z)" class="svelte-1g40uyy">Undo</button> <button title="Redo (Ctrl+Y)" class="svelte-1g40uyy">Redo</button></div> <button class="svelte-1g40uyy">Save State</button> <button class="svelte-1g40uyy">Restore State</button> <button class="secondary svelte-1g40uyy">Clear All Models</button> <button class="secondary svelte-1g40uyy">Clear Saved State</button></div>'),cc=ce('<path stroke-width="0.10" stroke-dasharray="0.5,0.25" pointer-events="none"></path>'),uc=ce('<circle stroke-width="0.05" stroke-dasharray="0.3,0.15" pointer-events="none"></circle><circle stroke="#000" stroke-width="0.06" pointer-events="none"></circle><circle r="0.15" fill="#000" pointer-events="none"></circle>',1),dc=ce("<!><!>",1),fc=ce('<g><rect fill="rgba(59, 130, 246, 0.1)" stroke="rgba(59, 130, 246, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></rect></g>'),vc=ce('<g><ellipse fill="rgba(59, 130, 246, 0.1)" stroke="rgba(59, 130, 246, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></ellipse></g>'),hc=ce('<circle fill="rgba(59, 130, 246, 0.1)" stroke="rgba(59, 130, 246, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></circle>'),yc=ce('<g><rect fill="rgba(239, 68, 68, 0.1)" stroke="rgba(239, 68, 68, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></rect></g>'),gc=ce('<g><ellipse fill="rgba(239, 68, 68, 0.1)" stroke="rgba(239, 68, 68, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></ellipse></g>'),pc=ce('<circle fill="rgba(239, 68, 68, 0.1)" stroke="rgba(239, 68, 68, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></circle>'),xc=ce('<g><rect fill="rgba(139, 90, 43, 0.2)" stroke="#8b5a2b" stroke-width="0.1" pointer-events="none"></rect></g>'),_c=ce('<g opacity="0.5" pointer-events="none"><!></g>'),mc=ce('<line stroke-width="0.05" pointer-events="none"></line>'),bc=ce('<line stroke="#22c55e" stroke-width="0.15" opacity="0.7" pointer-events="none"></line>'),wc=ce('<line stroke="#ef4444" stroke-width="0.1" stroke-dasharray="0.5 0.25" opacity="0.7" pointer-events="none"></line>'),Lc=ce("<!><!><!><!><!><!><!><!><!><!>",1),Sc=le('<main class="svelte-1g40uyy"><div class="header svelte-1g40uyy"><h1 class="svelte-1g40uyy">Deployment Practice</h1> <nav class="nav-links svelte-1g40uyy"><a href="#/setup" class="svelte-1g40uyy">Battlefield Setup</a> <a href="#/deployment" class="active svelte-1g40uyy">Deployment</a> <a href="#/" class="svelte-1g40uyy">Layout Builder</a> <a href="#/debug" class="svelte-1g40uyy">Debug Mode</a></nav></div> <div class="layout svelte-1g40uyy"><div class="sidebar svelte-1g40uyy"><!> <!> <!> <!> <!></div> <div class="battlefield-area svelte-1g40uyy"><div class="battlefield-container svelte-1g40uyy" role="presentation"><!></div> <div class="info svelte-1g40uyy"><p class="svelte-1g40uyy"> </p> <p class="hint svelte-1g40uyy">Press 1/2 to switch player | Press L to toggle LoS | Ctrl+Z to undo | Ctrl+Y to redo</p></div></div></div></main>');function kc(e,r){jt(r,!1);const n=()=>Je(Mn,"$selectedDeployment",g),a=()=>Je(Br,"$selectedLayoutName",g),i=()=>Je(dn,"$selectedLayoutType",g),s=()=>Je(ut,"$models",g),o=()=>Je(gr,"$selectedModelId",g),c=()=>Je(Zi,"$loadedTerrain",g),l=()=>Je(on,"$history",g),f=()=>Je(Bl,"$player1Models",g),v=()=>Je(Fl,"$player2Models",g),[g,_]=jn(),h=R(),S=R(),E=R(),w=R(),L=R();let O=R(1),F=R(null),G=!1,K=null,ue=R(null),fe=R(!1),j=R(!1),se=R(!1),ee=R(!1),Te=R(5.5),Pe=R(3);const Ue=5,J=9,de="warhammer-deployment-state";function ve(){const y={deployment:n()?.name||null,layout:a()||null,layoutType:i()||null,models:s()};localStorage.setItem(de,JSON.stringify(y))}function Me(){const y=localStorage.getItem(de);if(y)try{const $=JSON.parse(y);$.models&&Array.isArray($.models)&&(ut.set($.models),on.clear())}catch($){console.error("Failed to restore deployment state:",$)}}function te(){localStorage.removeItem(de),ut.clear()}tn(()=>{window.addEventListener("keydown",_e)}),Ri(()=>{window.removeEventListener("keydown",_e)});function _e(y){if(y.target.tagName==="INPUT")return;const $=o();if((y.ctrlKey||y.metaKey)&&y.key==="z"&&!y.shiftKey){y.preventDefault(),ut.undo();return}if((y.ctrlKey||y.metaKey)&&(y.key==="y"||y.shiftKey&&y.key==="z")){y.preventDefault(),ut.redo();return}if(y.key==="1"){y.preventDefault(),m(O,1);return}if(y.key==="2"){y.preventDefault(),m(O,2);return}if(y.key==="l"||y.key==="L"){y.preventDefault(),m(fe,!t(fe));return}if((y.key==="Delete"||y.key==="Backspace")&&$){y.preventDefault(),X();return}if($&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(y.key)){y.preventDefault();const A=y.shiftKey?.1:1;let P=0,H=0;switch(y.key){case"ArrowUp":H=-A;break;case"ArrowDown":H=A;break;case"ArrowLeft":P=-A;break;case"ArrowRight":P=A;break}if(o()){const $e=s().find(ne=>ne.id===o());$e&&ut.updateModel(o(),{x:$e.x+P,y:$e.y+H},!1)}return}if(y.key==="Escape"){V();return}}function V(){gr.set(null)}function Q(y,$){if(!t(ue))return;G=!0,K={x:$.clientX,y:$.clientY};const A=t(ue)($.clientX,$.clientY);m(F,{baseType:y.type,x:A.x,y:A.y}),window.addEventListener("mousemove",ge),window.addEventListener("mouseup",ae)}function ge(y){if(!G||!t(F)||!t(ue))return;const $=t(ue)(y.clientX,y.clientY);m(F,{...t(F),x:$.x,y:$.y})}function ae(y){if(!G||!t(F)){G=!1,m(F,null),K=null,window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",ae);return}const $=y.clientX-K.x,A=y.clientY-K.y,P=Math.sqrt($*$+A*A);let H,$e;P<Ue?(H=30,$e=22):(H=t(F).x,$e=t(F).y);const ne=t(F).customWidth&&t(F).customHeight?{width:t(F).customWidth,height:t(F).customHeight}:null,D=ut.add(t(F).baseType,t(O),H,$e,ne);gr.set(D),m(F,null),G=!1,K=null,window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",ae)}function Z(){const A={width:t(Te),height:t(Pe)},P=ut.add("rect-custom",t(O),30,22,A);gr.set(P)}function we(y){gr.set(y)}function De(y,$,A){ut.updateModel(y,{x:$,y:A},!0)}function rt(y,$,A,P,H){on.push({type:"move",modelId:y,before:{x:$,y:A},after:{x:P,y:H}})}function re(y,$){ut.updateModel(y,{rotation:$},!0)}function z(y,$,A){on.push({type:"rotate",modelId:y,before:{rotation:$},after:{rotation:A}})}function me(y,$){ut.updateModel(y,{name:$})}function X(){o()&&(ut.remove(o()),gr.set(null))}function at(){confirm("Clear all models?")&&(ut.clear(),gr.set(null))}function it(y){if(Mr(y.baseType))return{x:y.x,y:y.y,width:y.customWidth,height:y.customHeight,rotation:y.rotation||0,isRectangle:!0};const $=tr(y.baseType,y);return rr(y.baseType)?{x:y.x,y:y.y,rx:$.width/2,ry:$.height/2,rotation:y.rotation||0}:{x:y.x,y:y.y,radius:$.radius}}q(()=>(s(),o()),()=>{m(h,s().find(y=>y.id===o()))}),q(()=>(t(h),s()),()=>{m(S,t(h)?s().filter(y=>y.playerId!==t(h).playerId):[])}),q(()=>(c(),vn),()=>{m(E,c().terrains.map(y=>({id:y.id,vertices:vn(y)})))}),q(()=>(c(),Vr),()=>{m(w,c().walls.map(y=>ga(Vr(y.shape),y.x,y.y,y.rotation)))}),q(()=>(t(h),t(fe),t(S),t(E),t(w)),()=>{m(L,t(h)&&t(fe)&&t(S).length>0?t(S).map(y=>{const $=Ii(it(t(h)),it(y),t(E),t(w));return{targetId:y.id,target:y,canSee:$.canSee,firstClearRay:$.firstClearRay,rays:$.rays}}):[])}),wr(),Gt();var Be=Sc(),Re=p(x(Be),2),ot=x(Re),Ht=x(ot);gt(Ht,{title:"Add Models",children:(y,$)=>{var A=ec(),P=xe(A),H=x(P);let $e;var ne=p(H,2);let D;var je=p(P,2),qe=x(je),Ne=p(x(qe),2);Se(Ne,5,()=>(W(Wt),u(()=>Wt.circles)),Ie,(Ve,Ye)=>{Cn(Ve,{get baseSize(){return t(Ye)},get playerId(){return t(O)},onDragStart:Q})});var pt=p(qe,2),mt=p(x(pt),2);Se(mt,5,()=>(W(Wt),u(()=>Wt.ovals)),Ie,(Ve,Ye)=>{Cn(Ve,{get baseSize(){return t(Ye)},get playerId(){return t(O)},onDragStart:Q})}),Y(()=>{$e=Zt(H,1,"toggle-btn svelte-1g40uyy",null,$e,{active:t(O)===1}),D=Zt(ne,1,"toggle-btn svelte-1g40uyy",null,D,{active:t(O)===2})}),U("click",H,()=>m(O,1)),U("click",ne,()=>m(O,2)),b(y,A)},$$slots:{default:!0}});var Bt=p(Ht,2);gt(Bt,{title:"Add Hull (Vehicle)",children:(y,$)=>{var A=tc(),P=x(A),H=p(x(P),2),$e=p(P,2),ne=p(x($e),2),D=p($e,2),je=x(D);Y(()=>ke(je,`Add ${t(Te)??""}" Ã ${t(Pe)??""}" Hull`)),un(H,()=>t(Te),qe=>m(Te,qe)),un(ne,()=>t(Pe),qe=>m(Pe,qe)),U("click",D,Z),b(y,A)},$$slots:{default:!0}});var C=p(Bt,2);gt(C,{title:"Selected Model",children:(y,$)=>{var A=tt(),P=xe(A);{var H=ne=>{var D=ic(),je=x(D),qe=p(x(je),2),Ne=p(je,2),pt=p(x(Ne),2),mt=x(pt),Ve=p(Ne,2),Ye=p(x(Ve),2),Ke=x(Ye),st=p(Ve,2),Ft=p(x(st),2),vr=x(Ft),Jt=p(st,2);{var Sr=Ee=>{var Ae=rc(),He=p(x(Ae),2),$t=x(He);Y(nt=>ke($t,`${nt??""}Â°`),[()=>(t(h),u(()=>Math.round(t(h).rotation||0)))]),b(Ee,Ae)};oe(Jt,Ee=>{W(rr),t(h),u(()=>rr(t(h).baseType))&&Ee(Sr)})}var Le=p(Jt,2),B=x(Le),et=x(B),Ze=p(Le,2);{var k=Ee=>{var Ae=nc(),He=x(Ae),$t=x(He);an($t,()=>t(j),nt=>m(j,nt)),b(Ee,Ae)};oe(Ze,Ee=>{t(fe)&&Ee(k)})}var he=p(Ze,2);{var dt=Ee=>{var Ae=ac(),He=p(x(Ae),2),$t=x(He);Y(nt=>ke($t,`${nt??""}/${t(L),u(()=>t(L).length)??""} visible`),[()=>(t(L),u(()=>t(L).filter(nt=>nt.canSee).length))]),b(Ee,Ae)};oe(he,Ee=>{t(fe),t(L),u(()=>t(fe)&&t(L).length>0)&&Ee(dt)})}var Lt=p(he,2);Y((Ee,Ae,He)=>{yo(qe,(t(h),u(()=>t(h).name||""))),ke(mt,Ee),ke(Ke,`Player ${t(h),u(()=>t(h).playerId)??""}`),ke(vr,`${Ae??""}", ${He??""}"`)},[()=>(W(tr),t(h),u(()=>tr(t(h).baseType,t(h))?.label||"Unknown")),()=>(t(h),u(()=>t(h).x.toFixed(1))),()=>(t(h),u(()=>t(h).y.toFixed(1)))]),U("change",qe,Ee=>me(t(h).id,Ee.target.value)),an(et,()=>t(fe),Ee=>m(fe,Ee)),U("click",Lt,X),b(ne,D)},$e=ne=>{var D=sc();b(ne,D)};oe(P,ne=>{t(h)?ne(H):ne($e,!1)})}b(y,A)},$$slots:{default:!0}});var ie=p(C,2);gt(ie,{title:"Visualization",children:(y,$)=>{var A=oc(),P=x(A),H=x(P),$e=p(P,2),ne=x($e);an(H,()=>t(se),D=>m(se,D)),an(ne,()=>t(ee),D=>m(ee,D)),b(y,A)},$$slots:{default:!0}});var pe=p(ie,2);gt(pe,{title:"Actions",children:(y,$)=>{var A=lc(),P=x(A),H=x(P),$e=p(H,2),ne=p(P,2),D=p(ne,2),je=p(D,2),qe=p(je,2);Y(()=>{H.disabled=(l(),u(()=>!l().past.length)),$e.disabled=(l(),u(()=>!l().future.length))}),U("click",H,()=>ut.undo()),U("click",$e,()=>ut.redo()),U("click",ne,ve),U("click",D,Me),U("click",je,at),U("click",qe,te),b(y,A)},$$slots:{default:!0}});var ze=p(ot,2),Oe=x(ze),M=x(Oe);Yn(M,{children:la,$$slots:{default:(y,$)=>{const A=Xe(()=>$.screenToSvg);var P=Lc(),H=xe(P);{var $e=Le=>{var B=Ti();Y(()=>ke(B,(t(ue),W(t(A)),u(()=>(m(ue,t(A)),""))))),b(Le,B)};oe(H,Le=>{t(A)&&!t(ue)&&Le($e)})}var ne=p(H);{var D=Le=>{var B=dc(),et=xe(B);Se(et,1,()=>(n(),u(()=>n().zones)),Ie,(k,he)=>{var dt=cc();Y(Lt=>{d(dt,"d",Lt),d(dt,"fill",(t(he),u(()=>t(he).color))),d(dt,"stroke",(t(he),u(()=>t(he).borderColor)))},[()=>(W(ta),t(he),u(()=>ta(t(he).path)))]),b(k,dt)});var Ze=p(et);Se(Ze,1,()=>(n(),u(()=>n().objectives)),Ie,(k,he)=>{const dt=Xe(()=>(t(he),u(()=>t(he).isPrimary?"#fbbf24":"#9ca3af"))),Lt=Xe(()=>(t(he),u(()=>t(he).isPrimary?"rgba(251, 191, 36, 0.15)":"rgba(156, 163, 175, 0.15)")));var Ee=uc(),Ae=xe(Ee),He=p(Ae),$t=p(He);Y(()=>{d(Ae,"cx",(t(he),u(()=>t(he).x))),d(Ae,"cy",(t(he),u(()=>t(he).y))),d(Ae,"r",Ui),d(Ae,"fill",t(Lt)),d(Ae,"stroke",t(dt)),d(He,"cx",(t(he),u(()=>t(he).x))),d(He,"cy",(t(he),u(()=>t(he).y))),d(He,"r",Xi),d(He,"fill",t(dt)),d($t,"cx",(t(he),u(()=>t(he).x))),d($t,"cy",(t(he),u(()=>t(he).y)))}),b(k,Ee)}),b(Le,B)};oe(ne,Le=>{n()&&Le(D)})}var je=p(ne);{var qe=Le=>{var B=tt(),et=xe(B);Se(et,1,f,Ze=>Ze.id,(Ze,k)=>{const he=Xe(()=>(W(tr),t(k),u(()=>tr(t(k).baseType,t(k))))),dt=Xe(()=>(W(rr),t(k),u(()=>rr(t(k).baseType)))),Lt=Xe(()=>(W(Mr),t(k),u(()=>Mr(t(k).baseType))));var Ee=tt(),Ae=xe(Ee);{var He=nt=>{var St=fc(),kt=x(St);Y(()=>{d(St,"transform",`rotate(${t(k),u(()=>t(k).rotation||0)??""}, ${t(k),u(()=>t(k).x)??""}, ${t(k),u(()=>t(k).y)??""})`),d(kt,"x",(t(k),u(()=>t(k).x-(t(k).customWidth/2+J)))),d(kt,"y",(t(k),u(()=>t(k).y-(t(k).customHeight/2+J)))),d(kt,"width",(t(k),u(()=>t(k).customWidth+2*J))),d(kt,"height",(t(k),u(()=>t(k).customHeight+2*J)))}),b(nt,St)},$t=nt=>{var St=tt(),kt=xe(St);{var Hn=Mt=>{var ft=vc(),Qt=x(ft);Y(()=>{d(ft,"transform",`rotate(${t(k),u(()=>t(k).rotation||0)??""}, ${t(k),u(()=>t(k).x)??""}, ${t(k),u(()=>t(k).y)??""})`),d(Qt,"cx",(t(k),u(()=>t(k).x))),d(Qt,"cy",(t(k),u(()=>t(k).y))),d(Qt,"rx",(W(t(he)),u(()=>t(he).width/2+J))),d(Qt,"ry",(W(t(he)),u(()=>t(he).height/2+J)))}),b(Mt,ft)},Bn=Mt=>{var ft=hc();Y(()=>{d(ft,"cx",(t(k),u(()=>t(k).x))),d(ft,"cy",(t(k),u(()=>t(k).y))),d(ft,"r",(W(t(he)),u(()=>t(he).radius+J)))}),b(Mt,ft)};oe(kt,Mt=>{t(dt)?Mt(Hn):Mt(Bn,!1)},!0)}b(nt,St)};oe(Ae,nt=>{t(Lt)?nt(He):nt($t,!1)})}b(Ze,Ee)}),b(Le,B)};oe(je,Le=>{t(se)&&Le(qe)})}var Ne=p(je);{var pt=Le=>{var B=tt(),et=xe(B);Se(et,1,v,Ze=>Ze.id,(Ze,k)=>{const he=Xe(()=>(W(tr),t(k),u(()=>tr(t(k).baseType,t(k))))),dt=Xe(()=>(W(rr),t(k),u(()=>rr(t(k).baseType)))),Lt=Xe(()=>(W(Mr),t(k),u(()=>Mr(t(k).baseType))));var Ee=tt(),Ae=xe(Ee);{var He=nt=>{var St=yc(),kt=x(St);Y(()=>{d(St,"transform",`rotate(${t(k),u(()=>t(k).rotation||0)??""}, ${t(k),u(()=>t(k).x)??""}, ${t(k),u(()=>t(k).y)??""})`),d(kt,"x",(t(k),u(()=>t(k).x-(t(k).customWidth/2+J)))),d(kt,"y",(t(k),u(()=>t(k).y-(t(k).customHeight/2+J)))),d(kt,"width",(t(k),u(()=>t(k).customWidth+2*J))),d(kt,"height",(t(k),u(()=>t(k).customHeight+2*J)))}),b(nt,St)},$t=nt=>{var St=tt(),kt=xe(St);{var Hn=Mt=>{var ft=gc(),Qt=x(ft);Y(()=>{d(ft,"transform",`rotate(${t(k),u(()=>t(k).rotation||0)??""}, ${t(k),u(()=>t(k).x)??""}, ${t(k),u(()=>t(k).y)??""})`),d(Qt,"cx",(t(k),u(()=>t(k).x))),d(Qt,"cy",(t(k),u(()=>t(k).y))),d(Qt,"rx",(W(t(he)),u(()=>t(he).width/2+J))),d(Qt,"ry",(W(t(he)),u(()=>t(he).height/2+J)))}),b(Mt,ft)},Bn=Mt=>{var ft=pc();Y(()=>{d(ft,"cx",(t(k),u(()=>t(k).x))),d(ft,"cy",(t(k),u(()=>t(k).y))),d(ft,"r",(W(t(he)),u(()=>t(he).radius+J)))}),b(Mt,ft)};oe(kt,Mt=>{t(dt)?Mt(Hn):Mt(Bn,!1)},!0)}b(nt,St)};oe(Ae,nt=>{t(Lt)?nt(He):nt($t,!1)})}b(Ze,Ee)}),b(Le,B)};oe(Ne,Le=>{t(ee)&&Le(pt)})}var mt=p(Ne);Se(mt,1,()=>(c(),u(()=>c().terrains)),Ie,(Le,B)=>{var et=xc(),Ze=x(et);Y(()=>{d(et,"transform",`rotate(${t(B),u(()=>t(B).rotation)??""}, ${t(B),u(()=>t(B).x+t(B).width/2)??""}, ${t(B),u(()=>t(B).y+t(B).height/2)??""})`),d(Ze,"x",(t(B),u(()=>t(B).x))),d(Ze,"y",(t(B),u(()=>t(B).y))),d(Ze,"width",(t(B),u(()=>t(B).width))),d(Ze,"height",(t(B),u(()=>t(B).height)))}),b(Le,et)});var Ve=p(mt);Se(Ve,1,()=>(c(),u(()=>c().walls)),Ie,(Le,B)=>{var et=_c(),Ze=x(et);xa(Ze,{get id(){return t(B),u(()=>t(B).id)},get x(){return t(B),u(()=>t(B).x)},get y(){return t(B),u(()=>t(B).y)},get shape(){return t(B),u(()=>t(B).shape)},get rotation(){return t(B),u(()=>t(B).rotation)},selected:!1,get screenToSvg(){return t(A)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}}),b(Le,et)});var Ye=p(Ve);Se(Ye,1,s,Le=>Le.id,(Le,B)=>{{let et=Xe(()=>(t(B),u(()=>t(B).name||""))),Ze=Xe(()=>(t(B),o(),u(()=>t(B).id===o())));An(Le,{get id(){return t(B),u(()=>t(B).id)},get x(){return t(B),u(()=>t(B).x)},get y(){return t(B),u(()=>t(B).y)},get baseType(){return t(B),u(()=>t(B).baseType)},get playerId(){return t(B),u(()=>t(B).playerId)},get rotation(){return t(B),u(()=>t(B).rotation)},get name(){return t(et)},get customWidth(){return t(B),u(()=>t(B).customWidth)},get customHeight(){return t(B),u(()=>t(B).customHeight)},get selected(){return t(Ze)},get screenToSvg(){return t(A)},onSelect:we,onDrag:De,onDragEnd:rt,onRotate:re,onRotateEnd:z,onRename:me})}});var Ke=p(Ye);{var st=Le=>{An(Le,{id:"phantom",get x(){return t(F),u(()=>t(F).x)},get y(){return t(F),u(()=>t(F).y)},get baseType(){return t(F),u(()=>t(F).baseType)},get playerId(){return t(O)},rotation:0,get customWidth(){return t(F),u(()=>t(F).customWidth)},get customHeight(){return t(F),u(()=>t(F).customHeight)},selected:!1,get screenToSvg(){return t(A)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}})};oe(Ke,Le=>{t(F)&&Le(st)})}var Ft=p(Ke);{var vr=Le=>{var B=tt(),et=xe(B);Se(et,1,()=>t(L),Ie,(Ze,k)=>{var he=tt(),dt=xe(he);Se(dt,1,()=>(t(k),u(()=>t(k).rays)),Ie,(Lt,Ee)=>{var Ae=mc();Y(()=>{d(Ae,"x1",(t(Ee),u(()=>t(Ee).from.x))),d(Ae,"y1",(t(Ee),u(()=>t(Ee).from.y))),d(Ae,"x2",(t(Ee),u(()=>t(Ee).to.x))),d(Ae,"y2",(t(Ee),u(()=>t(Ee).to.y))),d(Ae,"stroke",(t(Ee),u(()=>t(Ee).blocked?"#ff000033":"#00ff0033")))}),b(Lt,Ae)}),b(Ze,he)}),b(Le,B)};oe(Ft,Le=>{t(j),t(fe),t(h),t(L),u(()=>t(j)&&t(fe)&&t(h)&&t(L).length>0)&&Le(vr)})}var Jt=p(Ft);{var Sr=Le=>{var B=tt(),et=xe(B);Se(et,1,()=>t(L),Ie,(Ze,k)=>{var he=tt(),dt=xe(he);{var Lt=Ae=>{var He=bc();Y(()=>{d(He,"x1",(t(k),u(()=>t(k).firstClearRay.from.x))),d(He,"y1",(t(k),u(()=>t(k).firstClearRay.from.y))),d(He,"x2",(t(k),u(()=>t(k).firstClearRay.to.x))),d(He,"y2",(t(k),u(()=>t(k).firstClearRay.to.y)))}),b(Ae,He)},Ee=Ae=>{var He=wc();Y(()=>{d(He,"x1",(t(h),u(()=>t(h).x))),d(He,"y1",(t(h),u(()=>t(h).y))),d(He,"x2",(t(k),u(()=>t(k).target.x))),d(He,"y2",(t(k),u(()=>t(k).target.y)))}),b(Ae,He)};oe(dt,Ae=>{t(k),u(()=>t(k).firstClearRay)?Ae(Lt):Ae(Ee,!1)})}b(Ze,he)}),b(Le,B)};oe(Jt,Le=>{t(fe),t(h),t(L),u(()=>t(fe)&&t(h)&&t(L).length>0)&&Le(Sr)})}b(y,P)}}});var T=p(Oe,2),I=x(T),N=x(I);Y(()=>ke(N,`Battlefield: 60" x 44" | ${f(),u(()=>f().length)??""} P1 models | ${v(),u(()=>v().length)??""} P2 models`)),U("click",Oe,V),b(e,Be),Yt(),_()}var Mc=le("<span> </span>"),Ec=le('<span class="los-status svelte-12aohay">No enemies</span>'),Tc=le('<div class="controls svelte-12aohay"><label class="svelte-12aohay"><input type="checkbox" class="svelte-12aohay"/> Show debug rays</label> <!></div>'),Pc=le('<button class="svelte-12aohay"> </button>'),$c=le('<div class="button-group svelte-12aohay"></div>'),Dc=le('<button class="svelte-12aohay"> </button>'),Rc=le('<div class="button-group svelte-12aohay"></div>'),Ac=le('<div class="player-toggle svelte-12aohay"><button>Player 1</button> <button>Player 2</button></div> <div class="base-palette svelte-12aohay"><div class="palette-section svelte-12aohay"><h4 class="svelte-12aohay">Circles</h4> <div class="palette-grid svelte-12aohay"></div></div> <div class="palette-section svelte-12aohay"><h4 class="svelte-12aohay">Ovals</h4> <div class="palette-grid svelte-12aohay"></div></div></div>',1),Cc=ce('<line stroke-width="0.05"></line>'),Ic=ce('<line stroke="#22c55e" stroke-width="0.15" opacity="0.7" pointer-events="none"></line>'),Oc=ce('<line stroke="#ef4444" stroke-width="0.1" stroke-dasharray="0.5 0.25" opacity="0.7" pointer-events="none"></line>'),Nc=ce("<!><!><!><!><!><!><!>",1),Wc=le('<p class="svelte-12aohay"> </p>'),jc=le('<main class="svelte-12aohay"><div class="header svelte-12aohay"><h1 class="svelte-12aohay">Debug Mode</h1> <nav class="nav-links svelte-12aohay"><a href="#/setup" class="svelte-12aohay">Battlefield Setup</a> <a href="#/deployment" class="svelte-12aohay">Deployment</a> <a href="#/" class="svelte-12aohay">Layout Builder</a> <a href="#/debug" class="active svelte-12aohay">Debug Mode</a></nav></div> <div class="layout svelte-12aohay"><div class="sidebar svelte-12aohay"><!> <!> <!> <!></div> <div class="battlefield-area svelte-12aohay"><div class="battlefield-container svelte-12aohay"><!></div> <div class="info svelte-12aohay"><p class="svelte-12aohay"> </p> <!> <p class="hint svelte-12aohay">Scroll to zoom | Space+drag to pan | Double-click to reset view</p></div></div></div></main>');function Yc(e,r){jt(r,!1);const n=()=>Je(pr,"$debugModels",f),a=()=>Je(kr,"$debugSelectedModelId",f),i=()=>Je(bn,"$debugTerrains",f),s=()=>Je(wn,"$debugWalls",f),o=()=>Je(Wa,"$debugMode",f),c=()=>Je(Ln,"$debugSelectedTerrainId",f),l=()=>Je(Sn,"$debugSelectedWallId",f),[f,v]=jn(),g=R(),_=R(),h=R(),S=R(),E=R();function w(C,ie){bn.add(C,ie)}function L(C){wn.add(C)}function O(C){Ln.set(C),Sn.set(null),kr.set(null)}function F(C){Sn.set(C),Ln.set(null),kr.set(null)}function G(C,ie,pe){bn.updateTerrain(C,{x:ie,y:pe})}function K(C,ie,pe){wn.updateWall(C,{x:ie,y:pe})}function ue(C,ie){bn.updateTerrain(C,{rotation:ie})}function fe(C,ie){wn.updateWall(C,{rotation:ie})}let j=R(1),se=R(null),ee=!1,Te=null,Pe=R(null);const Ue=5;tn(()=>{if(n().length===0){const C=pr.add("32mm",1,10,22);pr.add("32mm",2,50,22),kr.set(C)}});function J(C,ie){if(!t(Pe))return;ee=!0,Te={x:ie.clientX,y:ie.clientY};const pe=t(Pe)(ie.clientX,ie.clientY);m(se,{baseType:C.type,x:pe.x,y:pe.y}),window.addEventListener("mousemove",de),window.addEventListener("mouseup",ve)}function de(C){if(!ee||!t(se)||!t(Pe))return;const ie=t(Pe)(C.clientX,C.clientY);m(se,{...t(se),x:ie.x,y:ie.y})}function ve(C){if(!ee||!t(se)){ee=!1,m(se,null),Te=null,window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",ve);return}const ie=C.clientX-Te.x,pe=C.clientY-Te.y,ze=Math.sqrt(ie*ie+pe*pe);let Oe,M;ze<Ue?(Oe=30,M=22):(Oe=t(se).x,M=t(se).y);const T=pr.add(t(se).baseType,t(j),Oe,M);kr.set(T),m(se,null),ee=!1,Te=null,window.removeEventListener("mousemove",de),window.removeEventListener("mouseup",ve)}function Me(C){kr.set(C),Ln.set(null),Sn.set(null)}function te(C,ie,pe){pr.updateModel(C,{x:ie,y:pe},!0)}function _e(C,ie,pe,ze,Oe){ra.push({type:"move",modelId:C,before:{x:ie,y:pe},after:{x:ze,y:Oe}})}function V(C,ie){pr.updateModel(C,{rotation:ie},!0)}function Q(C,ie,pe){ra.push({type:"rotate",modelId:C,before:{rotation:ie},after:{rotation:pe}})}function ge(C,ie){pr.updateModel(C,{name:ie})}function ae(C){const ie=tr(C.baseType);return rr(C.baseType)?{x:C.x,y:C.y,rx:ie.width/2,ry:ie.height/2,rotation:C.rotation||0}:{x:C.x,y:C.y,radius:ie.radius}}q(()=>(n(),a()),()=>{m(g,n().find(C=>C.id===a()))}),q(()=>(t(g),n()),()=>{m(_,t(g)?n().filter(C=>C.playerId!==t(g).playerId):[])}),q(()=>(i(),vn),()=>{m(h,i().map(C=>({id:C.id,vertices:vn(C)})))}),q(()=>(s(),Vr),()=>{m(S,s().map(C=>ga(Vr(C.shape),C.x,C.y,C.rotation)))}),q(()=>(t(g),t(_),t(h),t(S)),()=>{m(E,t(g)&&t(_).length>0?t(_).map(C=>{const ie=Ii(ae(t(g)),ae(C),t(h),t(S));return{targetId:C.id,target:C,canSee:ie.canSee,firstClearRay:ie.firstClearRay,rays:ie.rays}}):[])}),wr(),Gt();var Z=jc(),we=p(x(Z),2),De=x(we),rt=x(De);gt(rt,{title:"LOS Debug",children:(C,ie)=>{var pe=Tc(),ze=x(pe),Oe=x(ze),M=p(ze,2);{var T=N=>{var y=Mc();let $;var A=x(y);Y((P,H)=>{$=Zt(y,1,"los-status svelte-12aohay",null,$,P),ke(A,`${H??""}/${t(E),u(()=>t(E).length)??""} visible`)},[()=>({"can-see":t(E).some(P=>P.canSee),blocked:!t(E).some(P=>P.canSee)}),()=>(t(E),u(()=>t(E).filter(P=>P.canSee).length))]),b(N,y)},I=N=>{var y=Ec();b(N,y)};oe(M,N=>{t(g),t(E),u(()=>t(g)&&t(E).length>0)?N(T):N(I,!1)})}an(Oe,o,N=>_o(Wa,N)),b(C,pe)},$$slots:{default:!0}});var re=p(rt,2);gt(re,{title:"Add Terrain",defaultOpen:!1,children:(C,ie)=>{var pe=$c();Se(pe,5,()=>ji,Ie,(ze,Oe)=>{var M=Pc(),T=x(M);Y(()=>ke(T,(t(Oe),u(()=>t(Oe).label)))),U("click",M,()=>w(t(Oe).width,t(Oe).height)),b(ze,M)}),b(C,pe)},$$slots:{default:!0}});var z=p(re,2);gt(z,{title:"Add Wall",defaultOpen:!1,children:(C,ie)=>{var pe=Rc();Se(pe,5,()=>ea,Ie,(ze,Oe)=>{var M=Dc(),T=x(M);Y(()=>ke(T,(t(Oe),u(()=>t(Oe).label)))),U("click",M,()=>L(t(Oe).shape)),b(ze,M)}),b(C,pe)},$$slots:{default:!0}});var me=p(z,2);gt(me,{title:"Add Models",defaultOpen:!1,children:(C,ie)=>{var pe=Ac(),ze=xe(pe),Oe=x(ze);let M;var T=p(Oe,2);let I;var N=p(ze,2),y=x(N),$=p(x(y),2);Se($,5,()=>(W(Wt),u(()=>Wt.circles)),Ie,(H,$e)=>{Cn(H,{get baseSize(){return t($e)},get playerId(){return t(j)},onDragStart:J})});var A=p(y,2),P=p(x(A),2);Se(P,5,()=>(W(Wt),u(()=>Wt.ovals)),Ie,(H,$e)=>{Cn(H,{get baseSize(){return t($e)},get playerId(){return t(j)},onDragStart:J})}),Y(()=>{M=Zt(Oe,1,"toggle-btn svelte-12aohay",null,M,{active:t(j)===1}),I=Zt(T,1,"toggle-btn svelte-12aohay",null,I,{active:t(j)===2})}),U("click",Oe,()=>m(j,1)),U("click",T,()=>m(j,2)),b(C,pe)},$$slots:{default:!0}});var X=p(De,2),at=x(X),it=x(at);Yn(it,{children:la,$$slots:{default:(C,ie)=>{const pe=Xe(()=>ie.screenToSvg);var ze=Nc(),Oe=xe(ze);{var M=ne=>{var D=Ti();Y(()=>ke(D,(t(Pe),W(t(pe)),u(()=>(m(Pe,t(pe)),""))))),b(ne,D)};oe(Oe,ne=>{t(pe)&&!t(Pe)&&ne(M)})}var T=p(Oe);{var I=ne=>{var D=tt(),je=xe(D);Se(je,1,()=>t(E),Ie,(qe,Ne)=>{var pt=tt(),mt=xe(pt);Se(mt,1,()=>(t(Ne),u(()=>t(Ne).rays)),Ie,(Ve,Ye)=>{var Ke=Cc();Y(()=>{d(Ke,"x1",(t(Ye),u(()=>t(Ye).from.x))),d(Ke,"y1",(t(Ye),u(()=>t(Ye).from.y))),d(Ke,"x2",(t(Ye),u(()=>t(Ye).to.x))),d(Ke,"y2",(t(Ye),u(()=>t(Ye).to.y))),d(Ke,"stroke",(t(Ye),u(()=>t(Ye).blocked?"#ff000033":"#00ff0033")))}),b(Ve,Ke)}),b(qe,pt)}),b(ne,D)};oe(T,ne=>{o(),t(g),t(E),u(()=>o()&&t(g)&&t(E).length>0)&&ne(I)})}var N=p(T);Se(N,1,i,ne=>ne.id,(ne,D)=>{{let je=Xe(()=>(t(D),c(),u(()=>t(D).id===c())));Ni(ne,{get id(){return t(D),u(()=>t(D).id)},get x(){return t(D),u(()=>t(D).x)},get y(){return t(D),u(()=>t(D).y)},get width(){return t(D),u(()=>t(D).width)},get height(){return t(D),u(()=>t(D).height)},get rotation(){return t(D),u(()=>t(D).rotation)},get selected(){return t(je)},get screenToSvg(){return t(pe)},onSelect:O,onDrag:G,onRotate:ue})}});var y=p(N);Se(y,1,s,ne=>ne.id,(ne,D)=>{{let je=Xe(()=>(t(D),l(),u(()=>t(D).id===l())));xa(ne,{get id(){return t(D),u(()=>t(D).id)},get x(){return t(D),u(()=>t(D).x)},get y(){return t(D),u(()=>t(D).y)},get shape(){return t(D),u(()=>t(D).shape)},get rotation(){return t(D),u(()=>t(D).rotation)},get selected(){return t(je)},get screenToSvg(){return t(pe)},onSelect:F,onDrag:K,onRotate:fe})}});var $=p(y);Se($,1,n,ne=>ne.id,(ne,D)=>{{let je=Xe(()=>(t(D),u(()=>t(D).name||""))),qe=Xe(()=>(t(D),a(),u(()=>t(D).id===a())));An(ne,{get id(){return t(D),u(()=>t(D).id)},get x(){return t(D),u(()=>t(D).x)},get y(){return t(D),u(()=>t(D).y)},get baseType(){return t(D),u(()=>t(D).baseType)},get playerId(){return t(D),u(()=>t(D).playerId)},get rotation(){return t(D),u(()=>t(D).rotation)},get name(){return t(je)},get selected(){return t(qe)},get screenToSvg(){return t(pe)},onSelect:Me,onDrag:te,onDragEnd:_e,onRotate:V,onRotateEnd:Q,onRename:ge})}});var A=p($);{var P=ne=>{var D=tt(),je=xe(D);Se(je,1,()=>t(E),Ie,(qe,Ne)=>{var pt=tt(),mt=xe(pt);{var Ve=Ke=>{var st=Ic();Y(()=>{d(st,"x1",(t(Ne),u(()=>t(Ne).firstClearRay.from.x))),d(st,"y1",(t(Ne),u(()=>t(Ne).firstClearRay.from.y))),d(st,"x2",(t(Ne),u(()=>t(Ne).firstClearRay.to.x))),d(st,"y2",(t(Ne),u(()=>t(Ne).firstClearRay.to.y)))}),b(Ke,st)},Ye=Ke=>{var st=Oc();Y(()=>{d(st,"x1",(t(g),u(()=>t(g).x))),d(st,"y1",(t(g),u(()=>t(g).y))),d(st,"x2",(t(Ne),u(()=>t(Ne).target.x))),d(st,"y2",(t(Ne),u(()=>t(Ne).target.y)))}),b(Ke,st)};oe(mt,Ke=>{t(Ne),u(()=>t(Ne).firstClearRay)?Ke(Ve):Ke(Ye,!1)})}b(qe,pt)}),b(ne,D)};oe(A,ne=>{o(),t(g),t(E),u(()=>o()&&t(g)&&t(E).length>0)&&ne(P)})}var H=p(A);{var $e=ne=>{An(ne,{id:"phantom",get x(){return t(se),u(()=>t(se).x)},get y(){return t(se),u(()=>t(se).y)},get baseType(){return t(se),u(()=>t(se).baseType)},get playerId(){return t(j)},rotation:0,selected:!1,get screenToSvg(){return t(pe)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}})};oe(H,ne=>{t(se)&&ne($e)})}b(C,ze)}}});var Be=p(at,2),Re=x(Be),ot=x(Re),Ht=p(Re,2);{var Bt=C=>{var ie=Wc(),pe=x(ie);Y(ze=>ke(pe,`Selected model LOS: ${ze??""}/${t(E),u(()=>t(E).length)??""} visible`),[()=>(t(E),u(()=>t(E).filter(ze=>ze.canSee).length))]),b(C,ie)};oe(Ht,C=>{o(),t(g),t(E),u(()=>o()&&t(g)&&t(E).length>0)&&C(Bt)})}Y(()=>ke(ot,`Battlefield: 60" x 44" | ${i(),u(()=>i().length)??""} terrain | ${s(),u(()=>s().length)??""} walls | ${n(),u(()=>n().length)??""} models`)),b(e,Z),Yt(),v()}function Hc(e,r){jt(r,!1);let n=R("main");function a(){const l=window.location.hash;l==="#/debug"?m(n,"debug"):l==="#/setup"?m(n,"setup"):l==="#/deployment"?m(n,"deployment"):m(n,"setup")}tn(()=>(a(),window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a))),Gt();var i=tt(),s=xe(i);{var o=l=>{Yc(l,{})},c=l=>{var f=tt(),v=xe(f);{var g=h=>{Yl(h,{})},_=h=>{var S=tt(),E=xe(S);{var w=O=>{kc(O,{})},L=O=>{xl(O,{})};oe(E,O=>{t(n)==="deployment"?O(w):O(L,!1)},!0)}b(h,S)};oe(v,h=>{t(n)==="setup"?h(g):h(_,!1)},!0)}b(l,f)};oe(s,l=>{t(n)==="debug"?l(o):l(c,!1)})}b(e,i),Yt()}ro(Hc,{target:document.getElementById("app")});
//# sourceMappingURL=index-BQdgHM3H.js.map
