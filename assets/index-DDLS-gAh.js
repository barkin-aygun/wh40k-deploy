(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Sn=!1;var On=Array.isArray,Ci=Array.prototype.indexOf,hn=Array.from,xa=Object.defineProperty,lr=Object.getOwnPropertyDescriptor,_a=Object.getOwnPropertyDescriptors,Ai=Object.prototype,Ri=Array.prototype,Nn=Object.getPrototypeOf,Jn=Object.isExtensible;const Qt=()=>{};function Ii(e){return e()}function an(e){for(var t=0;t<e.length;t++)e[t]()}function ma(){var e,t,n=new Promise((a,i)=>{e=a,t=i});return{promise:n,resolve:e,reject:t}}const it=2,sn=4,Kr=8,ba=1<<24,Zt=16,zt=32,yr=64,jn=128,wt=512,at=1024,dt=2048,It=4096,pt=8192,Ht=16384,Wn=32768,Lr=65536,Qn=1<<17,wa=1<<18,$r=1<<19,La=1<<20,Xt=1<<25,vr=32768,Mn=1<<21,Yn=1<<22,er=1<<23,cr=Symbol("$state"),Oi=Symbol("legacy props"),Ni=Symbol(""),xr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Bn(){throw new Error("https://svelte.dev/e/invalid_default_snippet")}function Sa(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ji(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Wi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Yi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Bi(e){throw new Error("https://svelte.dev/e/effect_orphan")}function Fi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Xi(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Hi(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ui(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ki(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Vi(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Zi=1,zi=2,Ma=4,qi=8,Gi=16,Ji=2,Qi=4,es=8,ka=1,ts=2,nt=Symbol(),rs="http://www.w3.org/1999/xhtml";function ns(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ea(e){return e===this.v}function Ta(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Pa(e){return!Ta(e,this.v)}let Dr=!1,as=!1;function is(){Dr=!0}let ze=null;function Sr(e){ze=e}function Et(e,t=!1,n){ze={p:ze,i:!1,c:null,e:null,s:e,x:null,l:Dr&&!t?{s:null,u:null,$:[]}:null}}function Tt(e){var t=ze,n=t.e;if(n!==null){t.e=null;for(var a of n)Va(a)}return e!==void 0&&(t.x=e),t.i=!0,ze=t.p,e??{}}function Vr(){return!Dr||ze!==null&&ze.l===null}let or=[];function $a(){var e=or;or=[],an(e)}function Cr(e){if(or.length===0&&!Wr){var t=or;queueMicrotask(()=>{t===or&&$a()})}or.push(e)}function ss(){for(;or.length>0;)$a()}function Da(e){var t=Fe;if(t===null)return Ce.f|=er,e;if((t.f&Wn)===0){if((t.f&jn)===0)throw e;t.b.error(e)}else Mr(e,t)}function Mr(e,t){for(;t!==null;){if((t.f&jn)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e}const os=-7169;function tt(e,t){e.f=e.f&os|t}function Fn(e){(e.f&wt)!==0||e.deps===null?tt(e,at):tt(e,It)}function Ca(e){if(e!==null)for(const t of e)(t.f&it)===0||(t.f&vr)===0||(t.f^=vr,Ca(t.deps))}function Aa(e,t,n){(e.f&dt)!==0?t.add(e):(e.f&It)!==0&&n.add(e),Ca(e.deps),tt(e,at)}const zr=new Set;let He=null,rn=null,St=null,mt=[],yn=null,kn=!1,Wr=!1;class Ct{committed=!1;current=new Map;previous=new Map;#t=new Set;#s=new Set;#e=0;#a=0;#i=null;#n=new Set;#r=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#a>0}process(t){mt=[],rn=null,this.apply();var n=[],a=[];for(const i of t)this.#o(i,n,a);this.is_fork||this.#c(),this.is_deferred()?(this.#l(a),this.#l(n)):(rn=this,He=null,ea(a),ea(n),rn=null,this.#i?.resolve()),St=null}#o(t,n,a){t.f^=at;for(var i=t.first,s=null;i!==null;){var o=i.f,c=(o&(zt|yr))!==0,l=c&&(o&at)!==0,d=l||(o&pt)!==0||this.skipped_effects.has(i);if(!d&&i.fn!==null){c?i.f^=at:s!==null&&(o&(sn|Kr|ba))!==0?s.b.defer_effect(i):(o&sn)!==0?n.push(i):Rr(i)&&((o&Zt)!==0&&this.#n.add(i),Er(i));var u=i.first;if(u!==null){i=u;continue}}var g=i.parent;for(i=i.next;i===null&&g!==null;)g===s&&(s=null),i=g.next,g=g.parent}}#l(t){for(var n=0;n<t.length;n+=1)Aa(t[n],this.#n,this.#r)}capture(t,n){n!==nt&&!this.previous.has(t)&&this.previous.set(t,n),(t.f&er)===0&&(this.current.set(t,t.v),St?.set(t,t.v))}activate(){He=this,this.apply()}deactivate(){He===this&&(He=null,St=null)}flush(){if(this.activate(),mt.length>0){if(Ra(),He!==null&&He!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#s)t(this);this.#s.clear()}#c(){if(this.#a===0){for(const t of this.#t)t();this.#t.clear()}this.#e===0&&this.#d()}#d(){if(zr.size>1){this.previous.clear();var t=St,n=!0;for(const i of zr){if(i===this){n=!1;continue}const s=[];for(const[c,l]of this.current){if(i.current.has(c))if(n&&l!==i.current.get(c))i.current.set(c,l);else continue;s.push(c)}if(s.length===0)continue;const o=[...i.current.keys()].filter(c=>!this.current.has(c));if(o.length>0){var a=mt;mt=[];const c=new Set,l=new Map;for(const d of s)Ia(d,o,c,l);if(mt.length>0){He=i,i.apply();for(const d of mt)i.#o(d,[],[]);i.deactivate()}mt=a}}He=null,St=t}this.committed=!0,zr.delete(this)}increment(t){this.#e+=1,t&&(this.#a+=1)}decrement(t){this.#e-=1,t&&(this.#a-=1),this.revive()}revive(){for(const t of this.#n)this.#r.delete(t),tt(t,dt),Vt(t);for(const t of this.#r)tt(t,It),Vt(t);this.flush()}oncommit(t){this.#t.add(t)}ondiscard(t){this.#s.add(t)}settled(){return(this.#i??=ma()).promise}static ensure(){if(He===null){const t=He=new Ct;zr.add(He),Wr||Ct.enqueue(()=>{He===t&&t.flush()})}return He}static enqueue(t){Cr(t)}apply(){}}function ls(e){var t=Wr;Wr=!0;try{for(var n;;){if(ss(),mt.length===0&&(He?.flush(),mt.length===0))return yn=null,n;Ra()}}finally{Wr=t}}function Ra(){var e=ur;kn=!0;var t=null;try{var n=0;for(ln(!0);mt.length>0;){var a=Ct.ensure();if(n++>1e3){var i,s;cs()}a.process(mt),tr.clear()}}finally{kn=!1,ln(e),yn=null}}function cs(){try{Fi()}catch(e){Mr(e,yn)}}let Yt=null;function ea(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var a=e[n++];if((a.f&(Ht|pt))===0&&Rr(a)&&(Yt=new Set,Er(a),a.deps===null&&a.first===null&&a.nodes===null&&(a.teardown===null&&a.ac===null?qa(a):a.fn=null),Yt?.size>0)){tr.clear();for(const i of Yt){if((i.f&(Ht|pt))!==0)continue;const s=[i];let o=i.parent;for(;o!==null;)Yt.has(o)&&(Yt.delete(o),s.push(o)),o=o.parent;for(let c=s.length-1;c>=0;c--){const l=s[c];(l.f&(Ht|pt))===0&&Er(l)}}Yt.clear()}}Yt=null}}function Ia(e,t,n,a){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const i of e.reactions){const s=i.f;(s&it)!==0?Ia(i,t,n,a):(s&(Yn|Zt))!==0&&(s&dt)===0&&Oa(i,t,a)&&(tt(i,dt),Vt(i))}}function Oa(e,t,n){const a=n.get(e);if(a!==void 0)return a;if(e.deps!==null)for(const i of e.deps){if(t.includes(i))return!0;if((i.f&it)!==0&&Oa(i,t,n))return n.set(i,!0),!0}return n.set(e,!1),!1}function Vt(e){for(var t=yn=e;t.parent!==null;){t=t.parent;var n=t.f;if(kn&&t===Fe&&(n&Zt)!==0&&(n&wa)===0)return;if((n&(yr|zt))!==0){if((n&at)===0)return;t.f^=at}}mt.push(t)}function ds(e){let t=0,n=hr(0),a;return()=>{Un()&&(r(n),Ar(()=>(t===0&&(a=f(()=>e(()=>Yr(n)))),t+=1,()=>{Cr(()=>{t-=1,t===0&&(a?.(),a=void 0,Yr(n))})})))}}var us=Lr|$r|jn;function fs(e,t,n){new vs(e,t,n)}class vs{parent;is_pending=!1;#t;#s=null;#e;#a;#i;#n=null;#r=null;#o=null;#l=null;#c=null;#d=0;#u=0;#v=!1;#h=new Set;#y=new Set;#f=null;#m=ds(()=>(this.#f=hr(this.#d),()=>{this.#f=null}));constructor(t,n,a){this.#t=t,this.#e=n,this.#a=a,this.parent=Fe.b,this.is_pending=!!this.#e.pending,this.#i=Kn(()=>{Fe.b=this;{var i=this.#x();try{this.#n=bt(()=>a(i))}catch(s){this.error(s)}this.#u>0?this.#p():this.is_pending=!1}return()=>{this.#c?.remove()}},us)}#b(){try{this.#n=bt(()=>this.#a(this.#t))}catch(t){this.error(t)}}#w(){const t=this.#e.pending;t&&(this.#r=bt(()=>t(this.#t)),Ct.enqueue(()=>{var n=this.#x();this.#n=this.#g(()=>(Ct.ensure(),bt(()=>this.#a(n)))),this.#u>0?this.#p():(dr(this.#r,()=>{this.#r=null}),this.is_pending=!1)}))}#x(){var t=this.#t;return this.is_pending&&(this.#c=Ut(),this.#t.before(this.#c),t=this.#c),t}defer_effect(t){Aa(t,this.#h,this.#y)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(t){var n=Fe,a=Ce,i=ze;Rt(this.#i),ut(this.#i),Sr(this.#i.ctx);try{return t()}catch(s){return Da(s),null}finally{Rt(n),ut(a),Sr(i)}}#p(){const t=this.#e.pending;this.#n!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#c),Qa(this.#n,this.#l)),this.#r===null&&(this.#r=bt(()=>t(this.#t)))}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}if(this.#u+=t,this.#u===0){this.is_pending=!1;for(const n of this.#h)tt(n,dt),Vt(n);for(const n of this.#y)tt(n,It),Vt(n);this.#h.clear(),this.#y.clear(),this.#r&&dr(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null)}}update_pending_count(t){this.#_(t),this.#d+=t,this.#f&&kr(this.#f,this.#d)}get_effect_pending(){return this.#m(),r(this.#f)}error(t){var n=this.#e.onerror;let a=this.#e.failed;if(this.#v||!n&&!a)throw t;this.#n&&(vt(this.#n),this.#n=null),this.#r&&(vt(this.#r),this.#r=null),this.#o&&(vt(this.#o),this.#o=null);var i=!1,s=!1;const o=()=>{if(i){ns();return}i=!0,s&&Vi(),Ct.ensure(),this.#d=0,this.#o!==null&&dr(this.#o,()=>{this.#o=null}),this.is_pending=this.has_pending_snippet(),this.#n=this.#g(()=>(this.#v=!1,bt(()=>this.#a(this.#t)))),this.#u>0?this.#p():this.is_pending=!1};var c=Ce;try{ut(null),s=!0,n?.(t,o),s=!1}catch(l){Mr(l,this.#i&&this.#i.parent)}finally{ut(c)}a&&Cr(()=>{this.#o=this.#g(()=>{Ct.ensure(),this.#v=!0;try{return bt(()=>{a(this.#t,()=>t,()=>o)})}catch(l){return Mr(l,this.#i.parent),null}finally{this.#v=!1}})})}}function hs(e,t,n,a){const i=Vr()?Xn:Je;if(n.length===0&&e.length===0){a(t.map(i));return}var s=He,o=Fe,c=ys();function l(){Promise.all(n.map(d=>gs(d))).then(d=>{c();try{a([...t.map(i),...d])}catch(u){(o.f&Ht)===0&&Mr(u,o)}s?.deactivate(),on()}).catch(d=>{Mr(d,o)})}e.length>0?Promise.all(e).then(()=>{c();try{return l()}finally{s?.deactivate(),on()}}):l()}function ys(){var e=Fe,t=Ce,n=ze,a=He;return function(s=!0){Rt(e),ut(t),Sr(n),s&&a?.activate()}}function on(){Rt(null),ut(null),Sr(null)}function Xn(e){var t=it|dt,n=Ce!==null&&(Ce.f&it)!==0?Ce:null;return Fe!==null&&(Fe.f|=$r),{ctx:ze,deps:null,effects:null,equals:Ea,f:t,fn:e,reactions:null,rv:0,v:nt,wv:0,parent:n??Fe,ac:null}}function gs(e,t,n){let a=Fe;a===null&&ji();var i=a.b,s=void 0,o=hr(nt),c=!Ce,l=new Map;return ks(()=>{var d=ma();s=d.promise;try{Promise.resolve(e()).then(d.resolve,d.reject).then(()=>{u===He&&u.committed&&u.deactivate(),on()})}catch(y){d.reject(y),on()}var u=He;if(c){var g=i.is_rendered();i.update_pending_count(1),u.increment(g),l.get(u)?.reject(xr),l.delete(u),l.set(u,d)}const h=(y,w=void 0)=>{if(u.activate(),w)w!==xr&&(o.f|=er,kr(o,w));else{(o.f&er)!==0&&(o.f^=er),kr(o,y);for(const[M,_]of l){if(l.delete(M),M===u)break;_.reject(xr)}}c&&(i.update_pending_count(-1),u.decrement(g))};d.promise.then(h,y=>h(null,y||"unknown"))}),pn(()=>{for(const d of l.values())d.reject(xr)}),new Promise(d=>{function u(g){function h(){g===s?d(o):u(s)}g.then(h,h)}u(s)})}function Je(e){const t=Xn(e);return t.equals=Pa,t}function Na(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)vt(t[n])}}function ps(e){for(var t=e.parent;t!==null;){if((t.f&it)===0)return(t.f&Ht)===0?t:null;t=t.parent}return null}function Hn(e){var t,n=Fe;Rt(ps(e));try{e.f&=~vr,Na(e),t=ni(e)}finally{Rt(n)}return t}function ja(e){var t=Hn(e);if(!e.equals(t)&&(e.wv=ti(),(!He?.is_fork||e.deps===null)&&(e.v=t,e.deps===null))){tt(e,at);return}rr||(St!==null?(Un()||He?.is_fork)&&St.set(e,t):Fn(e))}let En=new Set;const tr=new Map;let Wa=!1;function hr(e,t){var n={f:0,v:e,reactions:null,equals:Ea,rv:0,wv:0};return n}function qt(e,t){const n=hr(e);return Ps(n),n}function D(e,t=!1,n=!0){const a=hr(e);return t||(a.equals=Pa),Dr&&n&&ze!==null&&ze.l!==null&&(ze.l.s??=[]).push(a),a}function b(e,t,n=!1){Ce!==null&&(!Mt||(Ce.f&Qn)!==0)&&Vr()&&(Ce.f&(it|Zt|Yn|Qn))!==0&&!Kt?.includes(e)&&Ki();let a=n?_r(t):t;return kr(e,a)}function kr(e,t){if(!e.equals(t)){var n=e.v;rr?tr.set(e,t):tr.set(e,n),e.v=t;var a=Ct.ensure();if(a.capture(e,n),(e.f&it)!==0){const i=e;(e.f&dt)!==0&&Hn(i),Fn(i)}e.wv=ti(),Ya(e,dt),Vr()&&Fe!==null&&(Fe.f&at)!==0&&(Fe.f&(zt|yr))===0&&(_t===null?$s([e]):_t.push(e)),!a.is_fork&&En.size>0&&!Wa&&xs()}return t}function xs(){Wa=!1;var e=ur;ln(!0);const t=Array.from(En);try{for(const n of t)(n.f&at)!==0&&tt(n,It),Rr(n)&&Er(n)}finally{ln(e)}En.clear()}function Yr(e){b(e,e.v+1)}function Ya(e,t){var n=e.reactions;if(n!==null)for(var a=Vr(),i=n.length,s=0;s<i;s++){var o=n[s],c=o.f;if(!(!a&&o===Fe)){var l=(c&dt)===0;if(l&&tt(o,t),(c&it)!==0){var d=o;St?.delete(d),(c&vr)===0&&(c&wt&&(o.f|=vr),Ya(d,It))}else l&&((c&Zt)!==0&&Yt!==null&&Yt.add(o),Vt(o))}}}function _r(e){if(typeof e!="object"||e===null||cr in e)return e;const t=Nn(e);if(t!==Ai&&t!==Ri)return e;var n=new Map,a=On(e),i=qt(0),s=fr,o=c=>{if(fr===s)return c();var l=Ce,d=fr;ut(null),na(s);var u=c();return ut(l),na(d),u};return a&&n.set("length",qt(e.length)),new Proxy(e,{defineProperty(c,l,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Hi();var u=n.get(l);return u===void 0?u=o(()=>{var g=qt(d.value);return n.set(l,g),g}):b(u,d.value,!0),!0},deleteProperty(c,l){var d=n.get(l);if(d===void 0){if(l in c){const u=o(()=>qt(nt));n.set(l,u),Yr(i)}}else b(d,nt),Yr(i);return!0},get(c,l,d){if(l===cr)return e;var u=n.get(l),g=l in c;if(u===void 0&&(!g||lr(c,l)?.writable)&&(u=o(()=>{var y=_r(g?c[l]:nt),w=qt(y);return w}),n.set(l,u)),u!==void 0){var h=r(u);return h===nt?void 0:h}return Reflect.get(c,l,d)},getOwnPropertyDescriptor(c,l){var d=Reflect.getOwnPropertyDescriptor(c,l);if(d&&"value"in d){var u=n.get(l);u&&(d.value=r(u))}else if(d===void 0){var g=n.get(l),h=g?.v;if(g!==void 0&&h!==nt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(c,l){if(l===cr)return!0;var d=n.get(l),u=d!==void 0&&d.v!==nt||Reflect.has(c,l);if(d!==void 0||Fe!==null&&(!u||lr(c,l)?.writable)){d===void 0&&(d=o(()=>{var h=u?_r(c[l]):nt,y=qt(h);return y}),n.set(l,d));var g=r(d);if(g===nt)return!1}return u},set(c,l,d,u){var g=n.get(l),h=l in c;if(a&&l==="length")for(var y=d;y<g.v;y+=1){var w=n.get(y+"");w!==void 0?b(w,nt):y in c&&(w=o(()=>qt(nt)),n.set(y+"",w))}if(g===void 0)(!h||lr(c,l)?.writable)&&(g=o(()=>qt(void 0)),b(g,_r(d)),n.set(l,g));else{h=g.v!==nt;var M=o(()=>_r(d));b(g,M)}var _=Reflect.getOwnPropertyDescriptor(c,l);if(_?.set&&_.set.call(u,d),!h){if(a&&typeof l=="string"){var E=n.get("length"),P=Number(l);Number.isInteger(P)&&P>=E.v&&b(E,P+1)}Yr(i)}return!0},ownKeys(c){r(i);var l=Reflect.ownKeys(c).filter(g=>{var h=n.get(g);return h===void 0||h.v!==nt});for(var[d,u]of n)u.v!==nt&&!(d in c)&&l.push(d);return l},setPrototypeOf(){Ui()}})}var mr,Ba,Fa,Xa;function _s(){if(mr===void 0){mr=window,Ba=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Fa=lr(t,"firstChild").get,Xa=lr(t,"nextSibling").get,Jn(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Jn(n)&&(n.__t=void 0)}}function Ut(e=""){return document.createTextNode(e)}function Bt(e){return Fa.call(e)}function Zr(e){return Xa.call(e)}function m(e,t){return Bt(e)}function $e(e,t=!1){{var n=Bt(e);return n instanceof Comment&&n.data===""?Zr(n):n}}function x(e,t=1,n=!1){let a=e;for(;t--;)a=Zr(a);return a}function ms(e){e.textContent=""}function Ha(){return!1}let ta=!1;function bs(){ta||(ta=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function gn(e){var t=Ce,n=Fe;ut(null),Rt(null);try{return e()}finally{ut(t),Rt(n)}}function Ua(e,t,n,a=n){e.addEventListener(t,()=>gn(n));const i=e.__on_r;i?e.__on_r=()=>{i(),a(!0)}:e.__on_r=()=>a(!0),bs()}function Ka(e){Fe===null&&(Ce===null&&Bi(),Yi()),rr&&Wi()}function ws(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Ot(e,t,n){var a=Fe;a!==null&&(a.f&pt)!==0&&(e|=pt);var i={ctx:ze,deps:null,nodes:null,f:e|dt|wt,first:null,fn:t,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Er(i),i.f|=Wn}catch(c){throw vt(i),c}else t!==null&&Vt(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&$r)===0&&(s=s.first,(e&Zt)!==0&&(e&Lr)!==0&&s!==null&&(s.f|=Lr)),s!==null&&(s.parent=a,a!==null&&ws(s,a),Ce!==null&&(Ce.f&it)!==0&&(e&yr)===0)){var o=Ce;(o.effects??=[]).push(s)}return i}function Un(){return Ce!==null&&!Mt}function pn(e){const t=Ot(Kr,null,!1);return tt(t,at),t.teardown=e,t}function Tn(e){Ka();var t=Fe.f,n=!Ce&&(t&zt)!==0&&(t&Wn)===0;if(n){var a=ze;(a.e??=[]).push(e)}else return Va(e)}function Va(e){return Ot(sn|La,e,!1)}function Ls(e){return Ka(),Ot(Kr|La,e,!0)}function Ss(e){Ct.ensure();const t=Ot(yr|$r,e,!0);return(n={})=>new Promise(a=>{n.outro?dr(t,()=>{vt(t),a(void 0)}):(vt(t),a(void 0))})}function Ms(e){return Ot(sn,e,!1)}function q(e,t){var n=ze,a={effect:null,ran:!1,deps:e};n.l.$.push(a),a.effect=Ar(()=>{e(),!a.ran&&(a.ran=!0,f(t))})}function nr(){var e=ze;Ar(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&at)!==0&&n.deps!==null&&tt(n,It),Rr(n)&&Er(n),t.ran=!1}})}function ks(e){return Ot(Yn|$r,e,!0)}function Ar(e,t=0){return Ot(Kr|t,e,!0)}function R(e,t=[],n=[],a=[]){hs(a,t,n,i=>{Ot(Kr,()=>e(...i.map(r)),!0)})}function Kn(e,t=0){var n=Ot(Zt|t,e,!0);return n}function bt(e){return Ot(zt|$r,e,!0)}function Za(e){var t=e.teardown;if(t!==null){const n=rr,a=Ce;ra(!0),ut(null);try{t.call(null)}finally{ra(n),ut(a)}}}function za(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const i=n.ac;i!==null&&gn(()=>{i.abort(xr)});var a=n.next;(n.f&yr)!==0?n.parent=null:vt(n,t),n=a}}function Es(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&zt)===0&&vt(t),t=n}}function vt(e,t=!0){var n=!1;(t||(e.f&wa)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Ts(e.nodes.start,e.nodes.end),n=!0),za(e,t&&!n),cn(e,0),tt(e,Ht);var a=e.nodes&&e.nodes.t;if(a!==null)for(const s of a)s.stop();Za(e);var i=e.parent;i!==null&&i.first!==null&&qa(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Ts(e,t){for(;e!==null;){var n=e===t?null:Zr(e);e.remove(),e=n}}function qa(e){var t=e.parent,n=e.prev,a=e.next;n!==null&&(n.next=a),a!==null&&(a.prev=n),t!==null&&(t.first===e&&(t.first=a),t.last===e&&(t.last=n))}function dr(e,t,n=!0){var a=[];Ga(e,a,!0);var i=()=>{n&&vt(e),t&&t()},s=a.length;if(s>0){var o=()=>--s||i();for(var c of a)c.out(o)}else i()}function Ga(e,t,n){if((e.f&pt)===0){e.f^=pt;var a=e.nodes&&e.nodes.t;if(a!==null)for(const c of a)(c.is_global||n)&&t.push(c);for(var i=e.first;i!==null;){var s=i.next,o=(i.f&Lr)!==0||(i.f&zt)!==0&&(e.f&Zt)!==0;Ga(i,t,o?n:!1),i=s}}}function Vn(e){Ja(e,!0)}function Ja(e,t){if((e.f&pt)!==0){e.f^=pt,(e.f&at)===0&&(tt(e,dt),Vt(e));for(var n=e.first;n!==null;){var a=n.next,i=(n.f&Lr)!==0||(n.f&zt)!==0;Ja(n,i?t:!1),n=a}var s=e.nodes&&e.nodes.t;if(s!==null)for(const o of s)(o.is_global||t)&&o.in()}}function Qa(e,t){if(e.nodes)for(var n=e.nodes.start,a=e.nodes.end;n!==null;){var i=n===a?null:Zr(n);t.append(n),n=i}}let ur=!1;function ln(e){ur=e}let rr=!1;function ra(e){rr=e}let Ce=null,Mt=!1;function ut(e){Ce=e}let Fe=null;function Rt(e){Fe=e}let Kt=null;function Ps(e){Ce!==null&&(Kt===null?Kt=[e]:Kt.push(e))}let ct=null,ht=0,_t=null;function $s(e){_t=e}let ei=1,Hr=0,fr=Hr;function na(e){fr=e}function ti(){return++ei}function Rr(e){var t=e.f;if((t&dt)!==0)return!0;if(t&it&&(e.f&=~vr),(t&It)!==0){for(var n=e.deps,a=n.length,i=0;i<a;i++){var s=n[i];if(Rr(s)&&ja(s),s.wv>e.wv)return!0}(t&wt)!==0&&St===null&&tt(e,at)}return!1}function ri(e,t,n=!0){var a=e.reactions;if(a!==null&&!Kt?.includes(e))for(var i=0;i<a.length;i++){var s=a[i];(s.f&it)!==0?ri(s,t,!1):t===s&&(n?tt(s,dt):(s.f&at)!==0&&tt(s,It),Vt(s))}}function ni(e){var t=ct,n=ht,a=_t,i=Ce,s=Kt,o=ze,c=Mt,l=fr,d=e.f;ct=null,ht=0,_t=null,Ce=(d&(zt|yr))===0?e:null,Kt=null,Sr(e.ctx),Mt=!1,fr=++Hr,e.ac!==null&&(gn(()=>{e.ac.abort(xr)}),e.ac=null);try{e.f|=Mn;var u=e.fn,g=u(),h=e.deps;if(ct!==null){var y;if(cn(e,ht),h!==null&&ht>0)for(h.length=ht+ct.length,y=0;y<ct.length;y++)h[ht+y]=ct[y];else e.deps=h=ct;if(Un()&&(e.f&wt)!==0)for(y=ht;y<h.length;y++)(h[y].reactions??=[]).push(e)}else h!==null&&ht<h.length&&(cn(e,ht),h.length=ht);if(Vr()&&_t!==null&&!Mt&&h!==null&&(e.f&(it|It|dt))===0)for(y=0;y<_t.length;y++)ri(_t[y],e);return i!==null&&i!==e&&(Hr++,_t!==null&&(a===null?a=_t:a.push(..._t))),(e.f&er)!==0&&(e.f^=er),g}catch(w){return Da(w)}finally{e.f^=Mn,ct=t,ht=n,_t=a,Ce=i,Kt=s,Sr(o),Mt=c,fr=l}}function Ds(e,t){let n=t.reactions;if(n!==null){var a=Ci.call(n,e);if(a!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[a]=n[i],n.pop())}}if(n===null&&(t.f&it)!==0&&(ct===null||!ct.includes(t))){var s=t;(s.f&wt)!==0&&(s.f^=wt,s.f&=~vr),Fn(s),Na(s),cn(s,0)}}function cn(e,t){var n=e.deps;if(n!==null)for(var a=t;a<n.length;a++)Ds(e,n[a])}function Er(e){var t=e.f;if((t&Ht)===0){tt(e,at);var n=Fe,a=ur;Fe=e,ur=!0;try{(t&(Zt|ba))!==0?Es(e):za(e),Za(e);var i=ni(e);e.teardown=typeof i=="function"?i:null,e.wv=ei;var s;Sn&&as&&(e.f&dt)!==0&&e.deps}finally{ur=a,Fe=n}}}async function Cs(){await Promise.resolve(),ls()}function r(e){var t=e.f,n=(t&it)!==0;if(Ce!==null&&!Mt){var a=Fe!==null&&(Fe.f&Ht)!==0;if(!a&&!Kt?.includes(e)){var i=Ce.deps;if((Ce.f&Mn)!==0)e.rv<Hr&&(e.rv=Hr,ct===null&&i!==null&&i[ht]===e?ht++:ct===null?ct=[e]:ct.includes(e)||ct.push(e));else{(Ce.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[Ce]:s.includes(Ce)||s.push(Ce)}}}if(rr&&tr.has(e))return tr.get(e);if(n){var o=e;if(rr){var c=o.v;return((o.f&at)===0&&o.reactions!==null||ii(o))&&(c=Hn(o)),tr.set(o,c),c}var l=(o.f&wt)===0&&!Mt&&Ce!==null&&(ur||(Ce.f&wt)!==0),d=o.deps===null;Rr(o)&&(l&&(o.f|=wt),ja(o)),l&&!d&&ai(o)}if(St?.has(e))return St.get(e);if((e.f&er)!==0)throw e.v;return e.v}function ai(e){if(e.deps!==null){e.f|=wt;for(const t of e.deps)(t.reactions??=[]).push(e),(t.f&it)!==0&&(t.f&wt)===0&&ai(t)}}function ii(e){if(e.v===nt)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(tr.has(t)||(t.f&it)!==0&&ii(t))return!0;return!1}function f(e){var t=Mt;try{return Mt=!0,e()}finally{Mt=t}}function F(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(cr in e)Pn(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&cr in n&&Pn(n)}}}function Pn(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let a in e)try{Pn(e[a],t)}catch{}const n=Nn(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const a=_a(n);for(let i in a){const s=a[i].get;if(s)try{s.call(e)}catch{}}}}}const As=["touchstart","touchmove"];function Rs(e){return As.includes(e)}const Is=new Set,aa=new Set;function Os(e,t,n,a={}){function i(s){if(a.capture||Or.call(t,s),!s.cancelBubble)return gn(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Cr(()=>{t.addEventListener(e,i,a)}):t.addEventListener(e,i,a),i}function Y(e,t,n,a,i){var s={capture:a,passive:i},o=Os(e,t,n,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&pn(()=>{t.removeEventListener(e,o,s)})}let ia=null;function Or(e){var t=this,n=t.ownerDocument,a=e.type,i=e.composedPath?.()||[],s=i[0]||e.target;ia=e;var o=0,c=ia===e&&e.__root;if(c){var l=i.indexOf(c);if(l!==-1&&(t===document||t===window)){e.__root=t;return}var d=i.indexOf(t);if(d===-1)return;l<=d&&(o=l)}if(s=i[o]||e.target,s!==t){xa(e,"currentTarget",{configurable:!0,get(){return s||n}});var u=Ce,g=Fe;ut(null),Rt(null);try{for(var h,y=[];s!==null;){var w=s.assignedSlot||s.parentNode||s.host||null;try{var M=s["__"+a];M!=null&&(!s.disabled||e.target===s)&&M.call(s,e)}catch(_){h?y.push(_):h=_}if(e.cancelBubble||w===t||w===null)break;s=w}if(h){for(let _ of y)queueMicrotask(()=>{throw _});throw h}}finally{e.__root=t,delete e.currentTarget,ut(u),Rt(g)}}}function si(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Tr(e,t){var n=Fe;n.nodes===null&&(n.nodes={start:e,end:t,a:null,t:null})}function ie(e,t){var n=(t&ka)!==0,a=(t&ts)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=si(s?e:"<!>"+e),n||(i=Bt(i)));var o=a||Ba?document.importNode(i,!0):i.cloneNode(!0);if(n){var c=Bt(o),l=o.lastChild;Tr(c,l)}else Tr(o,o);return o}}function Ns(e,t,n="svg"){var a=!e.startsWith("<!>"),i=(t&ka)!==0,s=`<${n}>${a?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var c=si(s),l=Bt(c);if(i)for(o=document.createDocumentFragment();Bt(l);)o.appendChild(Bt(l));else o=Bt(l)}var d=o.cloneNode(!0);if(i){var u=Bt(d),g=d.lastChild;Tr(u,g)}else Tr(d,d);return d}}function ye(e,t){return Ns(e,t,"svg")}function oi(e=""){{var t=Ut(e+"");return Tr(t,t),t}}function st(){var e=document.createDocumentFragment(),t=document.createComment(""),n=Ut();return e.append(t,n),Tr(t,n),e}function L(e,t){e!==null&&e.before(t)}function Me(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function js(e,t){return Ws(e,t)}const gr=new Map;function Ws(e,{target:t,anchor:n,props:a={},events:i,context:s,intro:o=!0}){_s();var c=new Set,l=g=>{for(var h=0;h<g.length;h++){var y=g[h];if(!c.has(y)){c.add(y);var w=Rs(y);t.addEventListener(y,Or,{passive:w});var M=gr.get(y);M===void 0?(document.addEventListener(y,Or,{passive:w}),gr.set(y,1)):gr.set(y,M+1)}}};l(hn(Is)),aa.add(l);var d=void 0,u=Ss(()=>{var g=n??t.appendChild(Ut());return fs(g,{pending:()=>{}},h=>{if(s){Et({});var y=ze;y.c=s}i&&(a.$$events=i),d=e(h,a)||{},s&&Tt()}),()=>{for(var h of c){t.removeEventListener(h,Or);var y=gr.get(h);--y===0?(document.removeEventListener(h,Or),gr.delete(h)):gr.set(h,y)}aa.delete(l),g!==n&&g.parentNode?.removeChild(g)}});return Ys.set(d,u),d}let Ys=new WeakMap;class Bs{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#i=!0;constructor(t,n=!0){this.anchor=t,this.#i=n}#n=()=>{var t=He;if(this.#t.has(t)){var n=this.#t.get(t),a=this.#s.get(n);if(a)Vn(a),this.#a.delete(n);else{var i=this.#e.get(n);i&&(this.#s.set(n,i.effect),this.#e.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[s,o]of this.#t){if(this.#t.delete(s),s===t)break;const c=this.#e.get(o);c&&(vt(c.effect),this.#e.delete(o))}for(const[s,o]of this.#s){if(s===n||this.#a.has(s))continue;const c=()=>{if(Array.from(this.#t.values()).includes(s)){var d=document.createDocumentFragment();Qa(o,d),d.append(Ut()),this.#e.set(s,{effect:o,fragment:d})}else vt(o);this.#a.delete(s),this.#s.delete(s)};this.#i||!a?(this.#a.add(s),dr(o,c,!1)):c()}}};#r=t=>{this.#t.delete(t);const n=Array.from(this.#t.values());for(const[a,i]of this.#e)n.includes(a)||(vt(i.effect),this.#e.delete(a))};ensure(t,n){var a=He,i=Ha();if(n&&!this.#s.has(t)&&!this.#e.has(t))if(i){var s=document.createDocumentFragment(),o=Ut();s.append(o),this.#e.set(t,{effect:bt(()=>n(o)),fragment:s})}else this.#s.set(t,bt(()=>n(this.anchor)));if(this.#t.set(a,t),i){for(const[c,l]of this.#s)c===t?a.skipped_effects.delete(l):a.skipped_effects.add(l);for(const[c,l]of this.#e)c===t?a.skipped_effects.delete(l.effect):a.skipped_effects.add(l.effect);a.oncommit(this.#n),a.ondiscard(this.#r)}else this.#n()}}function he(e,t,n=!1){var a=new Bs(e),i=n?Lr:0;function s(o,c){a.ensure(o,c)}Kn(()=>{var o=!1;t((c,l=!0)=>{o=!0,s(l,c)}),o||s(!1,null)},i)}function Oe(e,t){return t}function Fs(e,t,n){for(var a=[],i=t.length,s,o=t.length,c=0;c<i;c++){let g=t[c];dr(g,()=>{if(s){if(s.pending.delete(g),s.done.add(g),s.pending.size===0){var h=e.outrogroups;$n(hn(s.done)),h.delete(s),h.size===0&&(e.outrogroups=null)}}else o-=1},!1)}if(o===0){var l=a.length===0&&n!==null;if(l){var d=n,u=d.parentNode;ms(u),u.append(d),e.items.clear()}$n(t,!l)}else s={pending:new Set(t),done:new Set},(e.outrogroups??=new Set).add(s)}function $n(e,t=!0){for(var n=0;n<e.length;n++)vt(e[n],t)}var sa;function be(e,t,n,a,i,s=null){var o=e,c=new Map,l=(t&Ma)!==0;if(l){var d=e;o=d.appendChild(Ut())}var u=null,g=Je(()=>{var E=n();return On(E)?E:E==null?[]:hn(E)}),h,y=!0;function w(){_.fallback=u,Xs(_,h,o,t,a),u!==null&&(h.length===0?(u.f&Xt)===0?Vn(u):(u.f^=Xt,Nr(u,null,o)):dr(u,()=>{u=null}))}var M=Kn(()=>{h=r(g);for(var E=h.length,P=new Set,re=He,V=Ha(),z=0;z<E;z+=1){var we=h[z],De=a(we,z),A=y?null:c.get(De);A?(A.v&&kr(A.v,we),A.i&&kr(A.i,z),V&&re.skipped_effects.delete(A.e)):(A=Hs(c,y?o:sa??=Ut(),we,De,z,i,t,n),y||(A.e.f|=Xt),c.set(De,A)),P.add(De)}if(E===0&&s&&!u&&(y?u=bt(()=>s(o)):(u=bt(()=>s(sa??=Ut())),u.f|=Xt)),!y)if(V){for(const[de,G]of c)P.has(de)||re.skipped_effects.add(G.e);re.oncommit(w),re.ondiscard(()=>{})}else w();r(g)}),_={effect:M,items:c,outrogroups:null,fallback:u};y=!1}function Xs(e,t,n,a,i){var s=(a&qi)!==0,o=t.length,c=e.items,l=e.effect.first,d,u=null,g,h=[],y=[],w,M,_,E;if(s)for(E=0;E<o;E+=1)w=t[E],M=i(w,E),_=c.get(M).e,(_.f&Xt)===0&&(_.nodes?.a?.measure(),(g??=new Set).add(_));for(E=0;E<o;E+=1){if(w=t[E],M=i(w,E),_=c.get(M).e,e.outrogroups!==null)for(const G of e.outrogroups)G.pending.delete(_),G.done.delete(_);if((_.f&Xt)!==0)if(_.f^=Xt,_===l)Nr(_,null,n);else{var P=u?u.next:l;_===e.effect.last&&(e.effect.last=_.prev),_.prev&&(_.prev.next=_.next),_.next&&(_.next.prev=_.prev),Gt(e,u,_),Gt(e,_,P),Nr(_,P,n),u=_,h=[],y=[],l=u.next;continue}if((_.f&pt)!==0&&(Vn(_),s&&(_.nodes?.a?.unfix(),(g??=new Set).delete(_))),_!==l){if(d!==void 0&&d.has(_)){if(h.length<y.length){var re=y[0],V;u=re.prev;var z=h[0],we=h[h.length-1];for(V=0;V<h.length;V+=1)Nr(h[V],re,n);for(V=0;V<y.length;V+=1)d.delete(y[V]);Gt(e,z.prev,we.next),Gt(e,u,z),Gt(e,we,re),l=re,u=we,E-=1,h=[],y=[]}else d.delete(_),Nr(_,l,n),Gt(e,_.prev,_.next),Gt(e,_,u===null?e.effect.first:u.next),Gt(e,u,_),u=_;continue}for(h=[],y=[];l!==null&&l!==_;)(d??=new Set).add(l),y.push(l),l=l.next;if(l===null)continue}(_.f&Xt)===0&&h.push(_),u=_,l=_.next}if(e.outrogroups!==null){for(const G of e.outrogroups)G.pending.size===0&&($n(hn(G.done)),e.outrogroups?.delete(G));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||d!==void 0){var De=[];if(d!==void 0)for(_ of d)(_.f&pt)===0&&De.push(_);for(;l!==null;)(l.f&pt)===0&&l!==e.fallback&&De.push(l),l=l.next;var A=De.length;if(A>0){var de=(a&Ma)!==0&&o===0?n:null;if(s){for(E=0;E<A;E+=1)De[E].nodes?.a?.measure();for(E=0;E<A;E+=1)De[E].nodes?.a?.fix()}Fs(e,De,de)}}s&&Cr(()=>{if(g!==void 0)for(_ of g)_.nodes?.a?.apply()})}function Hs(e,t,n,a,i,s,o,c){var l=(o&Zi)!==0?(o&Gi)===0?D(n,!1,!1):hr(n):null,d=(o&zi)!==0?hr(i):null;return{v:l,i:d,e:bt(()=>(s(t,l??n,d??i,c),()=>{e.delete(a)}))}}function Nr(e,t,n){if(e.nodes)for(var a=e.nodes.start,i=e.nodes.end,s=t&&(t.f&Xt)===0?t.nodes.start:n;a!==null;){var o=Zr(a);if(s.before(a),a===i)return;a=o}}function Gt(e,t,n){t===null?e.effect.first=n:t.next=n,n===null?e.effect.last=t:n.prev=t}function li(e,t,n,a,i){var s=t.$$slots?.[n],o=!1;s===!0&&(s=t.children,o=!0),s===void 0||s(e,o?()=>a:a)}const oa=[...` 	
\r\f \v\uFEFF`];function Us(e,t,n){var a=e==null?"":""+e;if(n){for(var i in n)if(n[i])a=a?a+" "+i:i;else if(a.length)for(var s=i.length,o=0;(o=a.indexOf(i,o))>=0;){var c=o+s;(o===0||oa.includes(a[o-1]))&&(c===a.length||oa.includes(a[c]))?a=(o===0?"":a.substring(0,o))+a.substring(c+1):o=c}}return a===""?null:a}function Ks(e,t){return e==null?null:String(e)}function At(e,t,n,a,i,s){var o=e.__className;if(o!==n||o===void 0){var c=Us(n,a,s);c==null?e.removeAttribute("class"):t?e.className=c:e.setAttribute("class",c),e.__className=n}else if(s&&i!==s)for(var l in s){var d=!!s[l];(i==null||d!==!!i[l])&&e.classList.toggle(l,d)}return s}function Vs(e,t,n,a){var i=e.__style;if(i!==t){var s=Ks(t);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}return a}const Zs=Symbol("is custom element"),zs=Symbol("is html");function qs(e,t){var n=ci(e);n.value===(n.value=t??void 0)||e.value===t&&(t!==0||e.nodeName!=="PROGRESS")||(e.value=t??"")}function v(e,t,n,a){var i=ci(e);i[t]!==(i[t]=n)&&(t==="loading"&&(e[Ni]=n),n==null?e.removeAttribute(t):typeof n!="string"&&Gs(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function ci(e){return e.__attributes??={[Zs]:e.nodeName.includes("-"),[zs]:e.namespaceURI===rs}}var la=new Map;function Gs(e){var t=e.getAttribute("is")||e.nodeName,n=la.get(t);if(n)return n;la.set(t,n=[]);for(var a,i=e,s=Element.prototype;s!==i;){a=_a(i);for(var o in a)a[o].set&&n.push(o);i=Nn(i)}return n}function mn(e,t,n=t){var a=new WeakSet;Ua(e,"input",async i=>{var s=i?e.defaultValue:e.value;if(s=bn(e)?wn(s):s,n(s),He!==null&&a.add(He),await Cs(),s!==(s=t())){var o=e.selectionStart,c=e.selectionEnd,l=e.value.length;if(e.value=s??"",c!==null){var d=e.value.length;o===c&&c===l&&d>l?(e.selectionStart=d,e.selectionEnd=d):(e.selectionStart=o,e.selectionEnd=Math.min(c,d))}}}),f(t)==null&&e.value&&(n(bn(e)?wn(e.value):e.value),He!==null&&a.add(He)),Ar(()=>{var i=t();if(e===document.activeElement){var s=rn??He;if(a.has(s))return}bn(e)&&i===wn(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Dn(e,t,n=t){Ua(e,"change",a=>{var i=a?e.defaultChecked:e.checked;n(i)}),f(t)==null&&n(e.checked),Ar(()=>{var a=t();e.checked=!!a})}function bn(e){var t=e.type;return t==="number"||t==="range"}function wn(e){return e===""?null:+e}function Js(e,t,n){var a=lr(e,t);a&&a.set&&(e[t]=n,pn(()=>{e[t]=null}))}function ca(e,t){return e===t||e?.[cr]===t}function di(e={},t,n,a){return Ms(()=>{var i,s;return Ar(()=>{i=s,s=[],f(()=>{e!==n(...s)&&(t(e,...s),i&&ca(n(...i),e)&&t(null,...i))})}),()=>{Cr(()=>{s&&ca(n(...s),e)&&t(null,...s)})}}),e}function da(e){return function(...t){var n=t[0];return n.stopPropagation(),e?.apply(this,t)}}function Nt(e=!1){const t=ze,n=t.l.u;if(!n)return;let a=()=>F(t.s);if(e){let i=0,s={};const o=Xn(()=>{let c=!1;const l=t.s;for(const d in l)l[d]!==s[d]&&(s[d]=l[d],c=!0);return c&&i++,i});a=()=>r(o)}n.b.length&&Ls(()=>{ua(t,a),an(n.b)}),Tn(()=>{const i=f(()=>n.m.map(Ii));return()=>{for(const s of i)typeof s=="function"&&s()}}),n.a.length&&Tn(()=>{ua(t,a),an(n.a)})}function ua(e,t){if(e.l.s)for(const n of e.l.s)r(n);t()}function fa(e,t){var n=e.$$events?.[t.type],a=On(n)?n.slice():n==null?[]:[n];for(var i of a)i.call(this,t)}function Zn(e,t,n){if(e==null)return t(void 0),n&&n(void 0),Qt;const a=f(()=>e.subscribe(t,n));return a.unsubscribe?()=>a.unsubscribe():a}const pr=[];function Qs(e,t){return{subscribe:rt(e,t).subscribe}}function rt(e,t=Qt){let n=null;const a=new Set;function i(c){if(Ta(e,c)&&(e=c,n)){const l=!pr.length;for(const d of a)d[1](),pr.push(d,e);if(l){for(let d=0;d<pr.length;d+=2)pr[d][0](pr[d+1]);pr.length=0}}}function s(c){i(c(e))}function o(c,l=Qt){const d=[c,l];return a.add(d),a.size===1&&(n=t(i,s)||Qt),c(e),()=>{a.delete(d),a.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:o}}function ar(e,t,n){const a=!Array.isArray(e),i=a?[e]:e;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=t.length<2;return Qs(n,(o,c)=>{let l=!1;const d=[];let u=0,g=Qt;const h=()=>{if(u)return;g();const w=t(a?d[0]:d,o,c);s?o(w):g=typeof w=="function"?w:Qt},y=i.map((w,M)=>Zn(w,_=>{d[M]=_,u&=~(1<<M),l&&h()},()=>{u|=1<<M}));return l=!0,h(),function(){an(y),g(),l=!1}})}function dn(e){let t;return Zn(e,n=>t=n)(),t}let qr=!1,Cn=Symbol();function Ze(e,t,n){const a=n[t]??={store:null,source:D(void 0),unsubscribe:Qt};if(a.store!==e&&!(Cn in n))if(a.unsubscribe(),a.store=e??null,e==null)a.source.v=void 0,a.unsubscribe=Qt;else{var i=!0;a.unsubscribe=Zn(e,s=>{i?a.source.v=s:b(a.source,s)}),i=!1}return e&&Cn in n?dn(e):r(a.source)}function eo(e,t){return e.set(t),t}function xn(){const e={};function t(){pn(()=>{for(var n in e)e[n].unsubscribe();xa(e,Cn,{enumerable:!1,value:!0})})}return[e,t]}function to(e){var t=qr;try{return qr=!1,[e(),qr]}finally{qr=t}}function Se(e,t,n,a){var i=!Dr||(n&Ji)!==0,s=(n&es)!==0,o=a,c=!0,l=()=>(c&&(c=!1,o=a),o),d;{var u=cr in e||Oi in e;d=lr(e,t)?.set??(u&&t in e?P=>e[t]=P:void 0)}var g,h=!1;[g,h]=to(()=>e[t]),g===void 0&&a!==void 0&&(g=l(),d&&(i&&Xi(),d(g)));var y;if(i?y=()=>{var P=e[t];return P===void 0?l():(c=!0,P)}:y=()=>{var P=e[t];return P!==void 0&&(o=void 0),P===void 0?o:P},i&&(n&Qi)===0)return y;if(d){var w=e.$$legacy;return(function(P,re){return arguments.length>0?((!i||!re||w||h)&&d(re?y():P),P):y()})}var M=!1,_=Je(()=>(M=!1,y()));r(_);var E=Fe;return(function(P,re){if(arguments.length>0){const V=re?r(_):i&&s?_r(P):P;return b(_,V),M=!0,o!==void 0&&(o=V),P}return rr&&M||(E.f&Ht)!==0?_.v:r(_)})}function Ir(e){ze===null&&Sa(),Dr&&ze.l!==null?ro(ze).m.push(e):Tn(()=>{const t=f(e);if(typeof t=="function")return t})}function ui(e){ze===null&&Sa(),Ir(()=>()=>f(e))}function ro(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const no="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(no);is();function ao(e,t,n,a){const i=br(n,a,e),s=br(n,a,t),o=br(e,t,n),c=br(e,t,a);return!!((i>0&&s<0||i<0&&s>0)&&(o>0&&c<0||o<0&&c>0)||i===0&&Gr(n,a,e)||s===0&&Gr(n,a,t)||o===0&&Gr(e,t,n)||c===0&&Gr(e,t,a))}function br(e,t,n){return(n.x-e.x)*(t.y-e.y)-(t.x-e.x)*(n.y-e.y)}function Gr(e,t,n){return Math.min(e.x,t.x)<=n.x&&n.x<=Math.max(e.x,t.x)&&Math.min(e.y,t.y)<=n.y&&n.y<=Math.max(e.y,t.y)}function va(e,t,n,a=16){const i=[];for(let s=0;s<a;s++){const o=2*Math.PI*s/a;i.push({x:e+n*Math.cos(o),y:t+n*Math.sin(o)})}return i}function io(e,t,n,a,i=0,s=16){const o=[],c=i*Math.PI/180,l=Math.cos(c),d=Math.sin(c);for(let u=0;u<s;u++){const g=2*Math.PI*u/s,h=n*Math.cos(g),y=a*Math.sin(g);o.push({x:e+h*l-y*d,y:t+h*d+y*l})}return o}function ha(e,t,n){const a=n.length;for(let i=0;i<a;i++){const s=n[i],o=n[(i+1)%a];if(ao(e,t,s,o))return!0}return!1}function fi(e,t,n){const a=n*Math.PI/180,i=Math.cos(a),s=Math.sin(a),o=e.x-t.x,c=e.y-t.y;return{x:t.x+o*i-c*s,y:t.y+o*s+c*i}}function vi(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function Ur(e){const t=vi(e),n=e.rotation||0;return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}].map(i=>fi(i,t,n))}function so(e){const i=e.x,s=e.y+e.height;return[{x:i,y:s},{x:i,y:s-8},{x:i+.5,y:s-8},{x:i+.5,y:s-.5},{x:i+4,y:s-.5},{x:i+4,y:s}]}function oo(e){const t=so(e),n=vi(e),a=e.rotation||0;return t.map(i=>fi(i,n,a))}function lo(e,t,n,a,i=.01){const s=Math.abs(br(e,t,n)),o=Math.abs(br(e,t,a)),c=Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),l=i*c;if(s>l||o>l)return!1;const d=t.x-e.x,u=t.y-e.y,g=Math.sqrt(d*d+u*u);if(g<i)return!1;const h=d/g,y=u/g,w=0,M=g,_=(n.x-e.x)*h+(n.y-e.y)*y,E=(a.x-e.x)*h+(a.y-e.y)*y,P=Math.min(w,M),re=Math.max(w,M),V=Math.min(_,E),z=Math.max(_,E),we=Math.max(P,V);return Math.min(re,z)-we>i}function co(e,t,n=.1){const a=e.length,i=t.length;for(let s=0;s<a;s++){const o=e[s],c=e[(s+1)%a];for(let l=0;l<i;l++){const d=t[l],u=t[(l+1)%i];if(lo(o,c,d,u,n))return!0}}return!1}function uo(e){const t=e.length;if(t===0)return new Map;const n=Array.from({length:t},(c,l)=>l);function a(c){return n[c]!==c&&(n[c]=a(n[c])),n[c]}function i(c,l){const d=a(c),u=a(l);d!==u&&(n[d]=u)}for(let c=0;c<t;c++)for(let l=c+1;l<t;l++)co(e[c].vertices,e[l].vertices)&&i(c,l);const s=new Map;e.forEach((c,l)=>s.set(c.id,l));const o=new Map;return e.forEach((c,l)=>{o.set(c.id,a(l))}),o}function fo(e,t,n){const a=t.get(e);return a===void 0?[e]:n.filter(i=>t.get(i.id)===a).map(i=>i.id)}const Ln=16;function An(e){return e.radius!==void 0?va(e.x,e.y,e.radius,Ln):e.rx!==void 0&&e.ry!==void 0?io(e.x,e.y,e.rx,e.ry,e.rotation||0,Ln):va(e.x,e.y,.5,Ln)}function ya(e,t){const n=An(e);for(const a of n)if(ga(a,t))return!0;return!!ga({x:e.x,y:e.y},t)}function ga(e,t){const n=t.length;let a=null;for(let i=0;i<n;i++){const s=t[i],o=t[(i+1)%n],c=(o.x-s.x)*(e.y-s.y)-(o.y-s.y)*(e.x-s.x);if(c!==0){const l=c>0;if(a===null)a=l;else if(a!==l)return!1}}return!0}function hi(e,t,n,a){const i=An(e),s=An(t),o=uo(n),c=new Set;for(const g of n){const h=ya(e,g.vertices),y=ya(t,g.vertices);if(h||y){const w=fo(g.id,o,n);for(const M of w)c.add(M)}}const l=[];let d=!1,u=null;for(const g of i)for(const h of s){const y={from:g,to:h,blocked:!1,blockedBy:null};let w=!1;for(const _ of n)if(!c.has(_.id)&&ha(g,h,_.vertices)){y.blocked=!0,y.blockedBy="terrain",w=!0;break}if(w){l.push(y);continue}let M=!1;for(const _ of a)if(ha(g,h,_)){y.blocked=!0,y.blockedBy="wall",M=!0;break}M||(y.blocked=!1,d||(u=y),d=!0),l.push(y)}return{canSee:d,rays:l,firstClearRay:u,terrainsIgnored:Array.from(c)}}const oe={width:60,height:44},yi=rt([{id:"terrain1",x:20,y:16,width:6,height:12,rotation:0},{id:"terrain2",x:34,y:10,width:6,height:12,rotation:45},{id:"terrain3",x:44,y:20,width:6,height:12,rotation:-30}]);ar(yi,e=>e.map(t=>oo(t)));ar(yi,e=>e.map(t=>({id:t.id,vertices:Ur(t)})));const pa=rt(!1);var vo=ye('<line stroke="#3a4a3a" stroke-width="0.05"></line>'),ho=ye('<line stroke="#3a4a3a" stroke-width="0.05"></line>'),yo=ye('<line stroke="#5a6a5a" stroke-width="0.08"></line>'),go=ye('<line stroke="#5a6a5a" stroke-width="0.08"></line>'),po=ye('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),xo=ye('<line stroke="#666"></line><!>',1),_o=ye('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),mo=ye('<line stroke="#666"></line><!>',1),bo=ye('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),wo=ye('<line stroke="#666"></line><!>',1),Lo=ye('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),So=ye('<line stroke="#666"></line><!>',1),Mo=ye('<svg preserveAspectRatio="xMidYMid meet"><rect x="0" y="0" fill="#1a1a1a"></rect><rect fill="#4a5a4a"></rect><!><!><!><!><!><!><!><!><g><!></g></svg>');function _n(e,t){Et(t,!1);const n=D(),a=D(),i=D(),s=D(),o=D(),c=D(),l=D();let d=D();const u=2,g=oe.width+u*2,h=oe.height+u*2;let y=D(1),w=D(0),M=D(0),_=D(!1),E={x:0,y:0},P=D(!1);const re=.5,V=4;function z(Z,W){if(!r(d))return{x:0,y:0};const C=r(d).createSVGPoint();C.x=Z,C.y=W;const S=C.matrixTransform(r(d).getScreenCTM().inverse());return{x:S.x-u,y:S.y-u}}function we(Z){Z.preventDefault();const W=r(d).getBoundingClientRect(),C=Z.clientX-W.left,S=Z.clientY-W.top,xe=r(i)+C/W.width*r(n),Ue=r(s)+S/W.height*r(a),Ke=Z.deltaY>0?.9:1.1,Ye=Math.max(re,Math.min(V,r(y)*Ke)),ot=g/Ye,p=h/Ye,T=xe-C/W.width*ot,O=Ue-S/W.height*p;b(y,Ye),b(w,T),b(M,O)}function De(Z){(Z.button===1||Z.button===0&&r(P))&&(Z.preventDefault(),b(_,!0),E={x:Z.clientX,y:Z.clientY})}function A(Z){if(!r(_))return;const W=r(d).getBoundingClientRect(),C=(Z.clientX-E.x)/W.width*r(n),S=(Z.clientY-E.y)/W.height*r(a);b(w,r(w)-C),b(M,r(M)-S),E={x:Z.clientX,y:Z.clientY}}function de(){b(_,!1)}function G(Z){Z.code==="Space"&&!Z.repeat&&Z.target.tagName!=="INPUT"&&(Z.preventDefault(),b(P,!0))}function Ae(Z){Z.code==="Space"&&b(P,!1)}function Ne(){b(y,1),b(w,0),b(M,0)}q(()=>r(y),()=>{b(n,g/r(y))}),q(()=>r(y),()=>{b(a,h/r(y))}),q(()=>r(w),()=>{b(i,r(w))}),q(()=>r(M),()=>{b(s,r(M))}),q(()=>(r(i),r(s),r(n),r(a)),()=>{b(o,`${r(i)} ${r(s)} ${r(n)} ${r(a)}`)}),q(()=>oe,()=>{b(c,Array.from({length:oe.width+1},(Z,W)=>W))}),q(()=>oe,()=>{b(l,Array.from({length:oe.height+1},(Z,W)=>W))}),nr();var Ve={screenToSvg:z};Nt();var le=Mo();Y("keydown",mr,G),Y("keyup",mr,Ae),Y("mouseup",mr,de),Y("mousemove",mr,A);let ne;var J=m(le),ge=x(J);v(ge,"x",u),v(ge,"y",u);var H=x(ge);be(H,1,()=>(F(oe),f(()=>Array(oe.width+1))),Oe,(Z,W,C)=>{var S=vo();v(S,"x1",u+C),v(S,"y1",u),v(S,"x2",u+C),R(()=>v(S,"y2",(F(oe),f(()=>u+oe.height)))),L(Z,S)});var ue=x(H);be(ue,1,()=>(F(oe),f(()=>Array(oe.height+1))),Oe,(Z,W,C)=>{var S=ho();v(S,"x1",u),v(S,"y1",u+C),v(S,"y2",u+C),R(()=>v(S,"x2",(F(oe),f(()=>u+oe.width)))),L(Z,S)});var B=x(ue);be(B,1,()=>(F(oe),f(()=>Array(Math.floor(oe.width/6)+1))),Oe,(Z,W,C)=>{var S=yo();v(S,"x1",u+C*6),v(S,"y1",u),v(S,"x2",u+C*6),R(()=>v(S,"y2",(F(oe),f(()=>u+oe.height)))),L(Z,S)});var te=x(B);be(te,1,()=>(F(oe),f(()=>Array(Math.floor(oe.height/6)+1))),Oe,(Z,W,C)=>{var S=go();v(S,"x1",u),v(S,"y1",u+C*6),v(S,"y2",u+C*6),R(()=>v(S,"x2",(F(oe),f(()=>u+oe.width)))),L(Z,S)});var pe=x(te);be(pe,1,()=>r(c),Oe,(Z,W)=>{var C=xo(),S=$e(C);v(S,"y2",u);var xe=x(S);{var Ue=Ke=>{var Ye=po();v(Ye,"y",1.2);var ot=m(Ye);R(()=>{v(Ye,"x",u+r(W)),Me(ot,`${r(W)??""}"`)}),L(Ke,Ye)};he(xe,Ke=>{r(W)%6===0&&Ke(Ue)})}R(()=>{v(S,"x1",u+r(W)),v(S,"y1",r(W)%6===0?.5:u-.8),v(S,"x2",u+r(W)),v(S,"stroke-width",r(W)%6===0?.08:.04)}),L(Z,C)});var Q=x(pe);be(Q,1,()=>r(c),Oe,(Z,W)=>{var C=mo(),S=$e(C),xe=x(S);{var Ue=Ke=>{var Ye=_o(),ot=m(Ye);R(()=>{v(Ye,"x",u+r(W)),v(Ye,"y",(F(oe),f(()=>u+oe.height+1.8))),Me(ot,`${r(W)??""}"`)}),L(Ke,Ye)};he(xe,Ke=>{r(W)%6===0&&Ke(Ue)})}R(()=>{v(S,"x1",u+r(W)),v(S,"y1",(F(oe),f(()=>u+oe.height))),v(S,"x2",u+r(W)),v(S,"y2",(F(oe),r(W),f(()=>u+oe.height+(r(W)%6===0?1.5:.8)))),v(S,"stroke-width",r(W)%6===0?.08:.04)}),L(Z,C)});var _e=x(Q);be(_e,1,()=>r(l),Oe,(Z,W)=>{var C=wo(),S=$e(C);v(S,"x2",u);var xe=x(S);{var Ue=Ke=>{var Ye=bo();v(Ye,"x",1);var ot=m(Ye);R(()=>{v(Ye,"y",u+r(W)+.35),Me(ot,`${r(W)??""}"`)}),L(Ke,Ye)};he(xe,Ke=>{r(W)%6===0&&Ke(Ue)})}R(()=>{v(S,"x1",r(W)%6===0?.5:u-.8),v(S,"y1",u+r(W)),v(S,"y2",u+r(W)),v(S,"stroke-width",r(W)%6===0?.08:.04)}),L(Z,C)});var me=x(_e);be(me,1,()=>r(l),Oe,(Z,W)=>{var C=So(),S=$e(C),xe=x(S);{var Ue=Ke=>{var Ye=Lo(),ot=m(Ye);R(()=>{v(Ye,"x",(F(oe),f(()=>u+oe.width+1))),v(Ye,"y",u+r(W)+.35),Me(ot,`${r(W)??""}"`)}),L(Ke,Ye)};he(xe,Ke=>{r(W)%6===0&&Ke(Ue)})}R(()=>{v(S,"x1",(F(oe),f(()=>u+oe.width))),v(S,"y1",u+r(W)),v(S,"x2",(F(oe),r(W),f(()=>u+oe.width+(r(W)%6===0?1.5:.8)))),v(S,"y2",u+r(W)),v(S,"stroke-width",r(W)%6===0?.08:.04)}),L(Z,C)});var Re=x(me);v(Re,"transform","translate(2, 2)");var Qe=m(Re);return li(Qe,t,"default",{screenToSvg:z}),di(le,Z=>b(d,Z),()=>r(d)),R(()=>{v(le,"viewBox",r(o)),ne=At(le,0,"battlefield svelte-n43bnt",null,ne,{panning:r(_)||r(P)}),v(J,"width",(F(oe),f(()=>oe.width+u*2))),v(J,"height",(F(oe),f(()=>oe.height+u*2))),v(ge,"width",(F(oe),f(()=>oe.width))),v(ge,"height",(F(oe),f(()=>oe.height)))}),Y("wheel",le,we),Y("mousedown",le,De),Y("dblclick",le,Ne),L(e,le),Js(t,"screenToSvg",z),Tt(Ve)}var ko=ye('<line stroke="#3b82f6" stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-trljjm"></circle>',1),Eo=ye('<g><g><rect role="button" tabindex="0" class="svelte-trljjm"></rect></g><!></g>');function gi(e,t){Et(t,!1);const n=D(),a=D(),i=D(),s=D(),o=D();let c=Se(t,"id",8),l=Se(t,"x",8),d=Se(t,"y",8),u=Se(t,"width",8),g=Se(t,"height",8),h=Se(t,"rotation",8,0),y=Se(t,"selected",8,!1),w=Se(t,"screenToSvg",8),M=Se(t,"onSelect",8,()=>{}),_=Se(t,"onDrag",8,()=>{}),E=Se(t,"onRotate",8,()=>{}),P=D(!1),re=!1,V={x:0,y:0};function z(H){H.stopPropagation(),M()(c())}function we(H){if(H.button!==0)return;H.preventDefault(),H.stopPropagation(),M()(c()),b(P,!0);const ue=w()(H.clientX,H.clientY);V={x:ue.x-l(),y:ue.y-d()},window.addEventListener("mousemove",De),window.addEventListener("mouseup",A)}function De(H){if(!r(P))return;const ue=w()(H.clientX,H.clientY);let B=ue.x-V.x,te=ue.y-V.y;H.shiftKey||(B=Math.round(B),te=Math.round(te));const pe=Math.max(u(),g())/2;B=Math.max(-pe,Math.min(oe.width-u()+pe,B)),te=Math.max(-pe,Math.min(oe.height-g()+pe,te)),_()(c(),B,te)}function A(){b(P,!1),window.removeEventListener("mousemove",De),window.removeEventListener("mouseup",A)}function de(H){H.preventDefault(),H.stopPropagation(),re=!0,window.addEventListener("mousemove",G),window.addEventListener("mouseup",Ae)}function G(H){if(!re)return;const ue=w()(H.clientX,H.clientY),B=ue.x-r(n),te=ue.y-r(a);let pe=Math.atan2(te,B)*180/Math.PI+45;H.shiftKey||(pe=Math.round(pe/15)*15),E()(c(),pe)}function Ae(){re=!1,window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",Ae)}q(()=>(F(l()),F(u())),()=>{b(n,l()+u()/2)}),q(()=>(F(d()),F(g())),()=>{b(a,d()+g()/2)}),q(()=>(F(u()),F(g())),()=>{b(i,Math.max(u(),g())/2+1.5)}),q(()=>(r(n),r(i),F(h())),()=>{b(s,r(n)+r(i)*Math.cos((h()-45)*Math.PI/180))}),q(()=>(r(a),r(i),F(h())),()=>{b(o,r(a)+r(i)*Math.sin((h()-45)*Math.PI/180))}),nr(),Nt();var Ne=Eo();let Ve;var le=m(Ne),ne=m(le),J=x(le);{var ge=H=>{var ue=ko(),B=$e(ue),te=x(B);R(()=>{v(B,"x1",r(n)),v(B,"y1",r(a)),v(B,"x2",r(s)),v(B,"y2",r(o)),v(te,"cx",r(s)),v(te,"cy",r(o))}),Y("mousedown",te,de),L(H,ue)};he(J,H=>{y()&&H(ge)})}R(()=>{Ve=At(Ne,0,"terrain-rect svelte-trljjm",null,Ve,{selected:y(),dragging:r(P)}),v(le,"transform",`rotate(${h()??""}, ${r(n)??""}, ${r(a)??""})`),v(ne,"x",l()),v(ne,"y",d()),v(ne,"width",u()),v(ne,"height",g()),v(ne,"fill",y()?"rgba(59, 130, 246, 0.3)":"rgba(139, 90, 43, 0.3)"),v(ne,"stroke",y()?"#3b82f6":"#8b5a2b"),v(ne,"stroke-width",y()?.15:.1)}),Y("click",ne,z),Y("mousedown",ne,we),L(e,Ne),Tt()}const pi="warhammer-deployment-layouts",xi=[{label:'6" x 12"',width:6,height:12},{label:'5" x 10"',width:5,height:10},{label:'4" x 6"',width:4,height:6}],Rn=[{label:"L 4x8",shape:"L-4x8"},{label:"L 4x8 ⌐",shape:"L-4x8-mirror"},{label:"C 4-8-4",shape:"C-4-8-4"},{label:"L 5x6",shape:"L-5x6"},{label:"L 5x6 ⌐",shape:"L-5x6-mirror"},{label:"L 4x6",shape:"L-4x6"},{label:"L 4x6 ⌐",shape:"L-4x6-mirror"}],_i=[{name:"Layout 1",terrains:[{id:"a",x:28,y:0,width:4,height:6,rotation:0},{id:"b",x:28,y:38,width:4,height:6,rotation:0},{id:"c",x:6,y:5,width:6,height:12,rotation:0},{id:"d",x:48,y:27,width:6,height:12,rotation:0},{id:"e",x:16,y:28,width:6,height:12,rotation:0},{id:"f",x:7,y:19,width:6,height:12,rotation:90},{id:"g",x:38,y:4,width:6,height:12,rotation:0},{id:"h",x:47,y:13,width:6,height:12,rotation:90},{id:"i",x:32.74,y:23.59,width:5,height:10,rotation:135},{id:"j",x:35.06,y:19.5,width:4,height:6,rotation:45},{id:"k",x:22.07,y:10.17,width:5,height:10,rotation:-45},{id:"l",x:20.72,y:18.23,width:4,height:6,rotation:45}],walls:[{id:"wa",x:38,y:6,shape:"C-4-8-4",rotation:0},{id:"wb",x:18,y:30,shape:"C-4-8-4",rotation:180},{id:"wc",x:13.33,y:20.15,shape:"L-4x8-mirror",rotation:-90},{id:"wd",x:49.67,y:15.93,shape:"L-4x8-mirror",rotation:90},{id:"we",x:48.2,y:30.88,shape:"L-4x8",rotation:0},{id:"wf",x:7.84,y:5.01,shape:"L-4x8",rotation:180},{id:"wg",x:27.06,y:11.52,shape:"L-4x8-mirror",rotation:-45},{id:"wh",x:35.81,y:24.24,shape:"L-4x8-mirror",rotation:135}]},{name:"Layout 2",terrains:[{id:"a",x:31,y:7,width:4,height:6,rotation:-90},{id:"b",x:25,y:30,width:4,height:6,rotation:90},{id:"c",x:5,y:4,width:6,height:12,rotation:0},{id:"d",x:49,y:28,width:6,height:12,rotation:0},{id:"e",x:46,y:4,width:6,height:12,rotation:0},{id:"f",x:16.32,y:16.13,width:6,height:12,rotation:135},{id:"g",x:53,y:15,width:4,height:6,rotation:90},{id:"h",x:8,y:28,width:6,height:12,rotation:0},{id:"i",x:3,y:23,width:4,height:6,rotation:90},{id:"j",x:32.62,y:32.55,width:5,height:10,rotation:-90},{id:"k",x:22.48,y:.51,width:5,height:10,rotation:-90},{id:"l",x:37,y:16,width:6,height:12,rotation:135}],walls:[{id:"wa",x:49,y:32,shape:"L-4x8",rotation:0},{id:"wb",x:7,y:4,shape:"L-4x8",rotation:180},{id:"wc",x:46,y:8,shape:"L-4x8",rotation:0},{id:"wd",x:10,y:28,shape:"L-4x8",rotation:180},{id:"we",x:35.07,y:34.56,shape:"L-5x6-mirror",rotation:-90},{id:"wf",x:29.09,y:2.47,shape:"L-5x6-mirror",rotation:90},{id:"wg",x:17.86,y:17.53,shape:"C-4-8-4",rotation:135},{id:"wh",x:37.24,y:18.38,shape:"C-4-8-4",rotation:-45}]},{name:"Layout 3",terrains:[{id:"a",x:11,y:3,width:4,height:6,rotation:90},{id:"b",x:45,y:35,width:4,height:6,rotation:90},{id:"c",x:25,y:1,width:6,height:12,rotation:90},{id:"d",x:29,y:31,width:6,height:12,rotation:90},{id:"e",x:7.74,y:26.05,width:6,height:12,rotation:125.31},{id:"f",x:46.34,y:5.51,width:6,height:12,rotation:121.72},{id:"g",x:5.14,y:10.46,width:6,height:12,rotation:41.51},{id:"h",x:48.67,y:21.52,width:6,height:12,rotation:41.51},{id:"i",x:19.59,y:14.36,width:5,height:10,rotation:-38.13},{id:"j",x:20.69,y:24.37,width:4,height:6,rotation:-39.33},{id:"k",x:35.34,y:19.61,width:5,height:10,rotation:-38.13},{id:"l",x:35.31,y:13.5,width:4,height:6,rotation:-39.33}],walls:[{id:"aa",x:30,y:32,shape:"C-4-8-4",rotation:90},{id:"ab",x:26,y:4,shape:"C-4-8-4",rotation:-90},{id:"ac",x:8.19,y:11.64,shape:"L-4x8",rotation:222.46},{id:"ad",x:47.79,y:24.3,shape:"L-4x8",rotation:41.26},{id:"ae",x:38.64,y:20.09,shape:"L-5x6-mirror",rotation:141.31},{id:"af",x:25.26,y:17.9,shape:"L-5x6-mirror",rotation:-37.61},{id:"ag",x:14.37,y:28.38,shape:"L-4x8-mirror",rotation:-54.26},{id:"ah",x:48.75,y:7.3,shape:"L-4x8-mirror",rotation:122.02}]},{name:"Layout 4",terrains:[{id:"a",x:15,y:1,width:6,height:12,rotation:90},{id:"b",x:8,y:10,width:4,height:6,rotation:0},{id:"c",x:4,y:19,width:4,height:6,rotation:0},{id:"d",x:7.5,y:27.68,width:6,height:12,rotation:-48.57},{id:"e",x:46.53,y:4.24,width:6,height:12,rotation:-48.57},{id:"f",x:53,y:19,width:4,height:6,rotation:0},{id:"g",x:48,y:28,width:4,height:6,rotation:0},{id:"h",x:39,y:31,width:6,height:12,rotation:90},{id:"i",x:33.03,y:2.97,width:6,height:12,rotation:-37.25},{id:"j",x:20.96,y:28.96,width:6,height:12,rotation:-37.25},{id:"k",x:16.93,y:16.51,width:5,height:10,rotation:-41.85},{id:"l",x:37.96,y:17.43,width:5,height:10,rotation:-41.85}],walls:[{id:"aa",x:18,y:4,shape:"L-4x8",rotation:-90},{id:"ab",x:9.04,y:29.01,shape:"C-4-8-4",rotation:131.97},{id:"ac",x:47,y:7,shape:"C-4-8-4",rotation:-48.54},{id:"ad",x:38,y:32,shape:"L-4x8",rotation:90},{id:"ae",x:34.42,y:7.12,shape:"L-4x8",rotation:-37.53},{id:"af",x:21.57,y:28.8,shape:"L-4x8",rotation:142.46},{id:"ag",x:15.7,y:17.01,shape:"L-5x6",rotation:137.87},{id:"ah",x:39.17,y:20.85,shape:"L-5x6",rotation:-40.92}]},{name:"Layout 5",terrains:[{id:"aa",x:27,y:1,width:6,height:12,rotation:90},{id:"ab",x:36.53,y:12.48,width:5,height:10,rotation:-90},{id:"ac",x:13,y:3,width:4,height:6,rotation:90},{id:"ad",x:43,y:35,width:4,height:6,rotation:90},{id:"ae",x:27,y:31,width:6,height:12,rotation:90},{id:"af",x:18.43,y:21.49,width:5,height:10,rotation:-90},{id:"ag",x:1,y:23,width:4,height:6,rotation:90},{id:"ah",x:55,y:15,width:4,height:6,rotation:90},{id:"ai",x:7.83,y:30.22,width:6,height:12,rotation:-60},{id:"aj",x:46.32,y:1.58,width:6,height:12,rotation:-60},{id:"ak",x:8.74,y:10.19,width:6,height:12,rotation:65.22},{id:"al",x:45.22,y:21.75,width:6,height:12,rotation:65.22}],walls:[{id:"a1",x:28,y:32,shape:"C-4-8-4",rotation:90},{id:"a2",x:28,y:4,shape:"C-4-8-4",rotation:-90},{id:"a3",x:11.88,y:12.29,shape:"L-4x8",rotation:-114.74},{id:"a4",x:43.97,y:23.59,shape:"L-4x8",rotation:64.22},{id:"a5",x:24.91,y:23.52,shape:"L-5x6-mirror",rotation:-90.37},{id:"a6",x:39,y:14.51,shape:"L-5x6-mirror",rotation:89.9},{id:"a7",x:7.58,y:30.57,shape:"L-4x8",rotation:120.93},{id:"a8",x:48.51,y:5.28,shape:"L-4x8",rotation:-59.06}]},{name:"Layout 6",terrains:[{id:"aa",x:13,y:1,width:6,height:12,rotation:90},{id:"ab",x:6,y:10,width:4,height:6,rotation:0},{id:"ac",x:25,y:11,width:4,height:6,rotation:90},{id:"ad",x:7.34,y:27.57,width:6,height:12,rotation:-40.32},{id:"ae",x:46.69,y:4.57,width:6,height:12,rotation:-41.9},{id:"af",x:31,y:27,width:4,height:6,rotation:-90},{id:"ag",x:50,y:28,width:4,height:6,rotation:0},{id:"ah",x:41,y:31,width:6,height:12,rotation:90},{id:"ai",x:34,y:4,width:6,height:12,rotation:0},{id:"aj",x:20,y:28,width:6,height:12,rotation:0},{id:"ak",x:15.7,y:15.03,width:5,height:10,rotation:-41.85},{id:"al",x:39.43,y:19.24,width:5,height:10,rotation:-39.95}],walls:[{id:"a1",x:16,y:4,shape:"L-4x8",rotation:-90},{id:"a2",x:9.04,y:29.01,shape:"C-4-8-4",rotation:140.05},{id:"a3",x:47,y:7.16,shape:"C-4-8-4",rotation:-41.53},{id:"a4",x:40,y:32,shape:"L-4x8",rotation:90},{id:"a5",x:34.15,y:7.88,shape:"L-4x8",rotation:0},{id:"a6",x:22,y:28,shape:"L-4x8",rotation:180},{id:"a7",x:14.47,y:15.47,shape:"L-5x6",rotation:137.87},{id:"a8",x:40.53,y:22.78,shape:"L-5x6",rotation:-40.92}]},{name:"Layout 7",terrains:[{id:"aa",x:8,y:8,width:6,height:12,rotation:0},{id:"ab",x:6,y:28,width:6,height:12,rotation:0},{id:"ac",x:7,y:39,width:4,height:6,rotation:90},{id:"ad",x:18,y:26,width:5,height:10,rotation:0},{id:"ae",x:19,y:20,width:4,height:6,rotation:0},{id:"af",x:23,y:3,width:6,height:12,rotation:0},{id:"ag",x:31,y:29,width:6,height:12,rotation:0},{id:"ah",x:37,y:18,width:4,height:6,rotation:0},{id:"ai",x:37,y:8,width:5,height:10,rotation:0},{id:"aj",x:46,y:24,width:6,height:12,rotation:0},{id:"ak",x:48,y:4,width:6,height:12,rotation:0},{id:"al",x:49,y:-1,width:4,height:6,rotation:90}],walls:[{id:"a1",x:9,y:10,shape:"L-5x6",rotation:180},{id:"a2",x:11.44,y:31.97,shape:"L-4x8-mirror",rotation:0},{id:"a3",x:19,y:20,shape:"L-4x6",rotation:180},{id:"a4",x:22.53,y:30.02,shape:"L-5x6-mirror",rotation:0},{id:"a5",x:25,y:5,shape:"C-4-8-4",rotation:180},{id:"a6",x:31,y:31,shape:"C-4-8-4",rotation:0},{id:"a7",x:37,y:18,shape:"L-4x6",rotation:0},{id:"a8",x:41.51,y:8.09,shape:"L-5x6-mirror",rotation:180},{id:"a9",x:46,y:28,shape:"L-5x6",rotation:0},{id:"a10",x:51.51,y:4.01,shape:"L-4x8-mirror",rotation:180}]},{name:"Layout 8",terrains:[{id:"aa",x:23,y:22,width:4,height:6,rotation:0},{id:"ab",x:23,y:28,width:4,height:6,rotation:0},{id:"ac",x:33,y:16,width:4,height:6,rotation:0},{id:"ad",x:33,y:10,width:4,height:6,rotation:0},{id:"ae",x:41,y:19,width:6,height:12,rotation:0},{id:"af",x:13,y:13,width:6,height:12,rotation:0},{id:"ag",x:32,y:32,width:6,height:12,rotation:0},{id:"ah",x:22,y:0,width:6,height:12,rotation:0},{id:"ai",x:9.5,y:27.68,width:6,height:12,rotation:-48.69},{id:"aj",x:44.51,y:4.35,width:6,height:12,rotation:-48.69},{id:"ak",x:6.95,y:4,width:5,height:10,rotation:53.9},{id:"al",x:48,y:30,width:5,height:10,rotation:53.9}],walls:[{id:"a1",x:32,y:34,shape:"C-4-8-4",rotation:0},{id:"a2",x:24,y:2,shape:"C-4-8-4",rotation:180},{id:"a3",x:44.68,y:19.06,shape:"L-4x8-mirror",rotation:180},{id:"a4",x:18.43,y:16.91,shape:"L-4x8-mirror",rotation:0},{id:"a5",x:46.38,y:33.13,shape:"L-5x6",rotation:52.87},{id:"a6",x:8.55,y:4.89,shape:"L-5x6",rotation:-127.66},{id:"a7",x:16,y:30.28,shape:"L-4x8-mirror",rotation:-48.62},{id:"a8",x:46.91,y:5.85,shape:"L-4x8-mirror",rotation:132.19}]}];function To(){return"terrain-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function Ft(){const e=localStorage.getItem(pi);if(e)try{return JSON.parse(e)}catch(t){return console.error("Failed to parse saved layouts:",t),{}}return{}}function un(e){localStorage.setItem(pi,JSON.stringify(e))}function mi(){const{subscribe:e,set:t,update:n}=rt([]);return{subscribe:e,set:t,update:n,add(a,i){n(s=>[...s,{id:To(),x:30-a/2,y:22-i/2,width:a,height:i,rotation:0}])},updateTerrain(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){t([])},save(a){const i=dn({subscribe:e}),s=Ft();s[a]={terrains:i,savedAt:Date.now()},un(s)},load(a){const i=Ft();return i[a]?(t(i[a].terrains),!0):!1},deleteLayout(a){const i=Ft();delete i[a],un(i)},getSavedLayoutNames(){const a=Ft();return Object.keys(a).map(i=>({name:i,savedAt:a[i].savedAt,terrainCount:a[i].terrains.length})).sort((i,s)=>s.savedAt-i.savedAt)},hasSaved(){const a=Ft();return Object.keys(a).length>0}}}const xt=mi();function bi(){const{subscribe:e,set:t,update:n}=rt([]);return{subscribe:e,set:t,update:n,add(a){n(i=>[...i,{id:"wall-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),x:30,y:22,shape:a,rotation:0}])},updateWall(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){t([])}}}const yt=bi(),Jr=mi(),Qr=bi(),en=rt(null),tn=rt(null);function Pr(e){switch(e){case"L-4x8":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];case"L-4x8-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:8},{x:-4+.5,y:8},{x:-4+.5,y:8-.5},{x:0,y:8-.5}];case"C-4-8-4":return[{x:0,y:0},{x:4,y:0},{x:4,y:.5},{x:.5,y:.5},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];case"L-5x6":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:5,y:6-.5},{x:5,y:6},{x:0,y:6}];case"L-5x6-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-5+.5,y:6},{x:-5+.5,y:6-.5},{x:0,y:6-.5}];case"L-4x6":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:4,y:6-.5},{x:4,y:6},{x:0,y:6}];case"L-4x6-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-4+.5,y:6},{x:-4+.5,y:6-.5},{x:0,y:6-.5}];default:return[]}}function zn(e,t,n,a){if(e.length===0)return[];const i=e.map(E=>E.x),s=e.map(E=>E.y),o=Math.min(...i),c=Math.max(...i),l=Math.min(...s),d=Math.max(...s),u=c-o,g=d-l,h=t+o+u/2,y=n+l+g/2,w=a*Math.PI/180,M=Math.cos(w),_=Math.sin(w);return e.map(E=>{const P=t+E.x,re=n+E.y,V=P-h,z=re-y;return{x:h+V*M-z*_,y:y+V*_+z*M}})}ar(yt,e=>e.map(t=>zn(Pr(t.shape),t.x,t.y,t.rotation)));const $t=rt(null),Dt=rt(null),qn=rt([]);function Po(e,t=[]){const n=dn(xt),a=dn(yt),i=Ft();i[e]={terrains:n,walls:a,models:t,savedAt:Date.now()},un(i)}function $o(e){const t=Ft();return t[e]?(xt.set(t[e].terrains||[]),yt.set(t[e].walls||[]),{terrains:t[e].terrains||[],walls:t[e].walls||[],models:t[e].models||[]}):null}function Do(e){const t=Ft();delete t[e],un(t)}function Co(){const e=Ft();return Object.keys(e).map(t=>({name:t,savedAt:e[t].savedAt,terrainCount:(e[t].terrains||[]).length,wallCount:(e[t].walls||[]).length,modelCount:(e[t].models||[]).length})).sort((t,n)=>n.savedAt-t.savedAt)}function jr(){qn.set(Co())}var Ao=ye('<line stroke="#3b82f6" stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-1tez9jd"></circle>',1),Ro=ye('<g><g><path role="button" tabindex="0" class="svelte-1tez9jd"></path></g><!></g>');function Gn(e,t){Et(t,!1);const n=D(),a=D(),i=D(),s=D(),o=D(),c=D(),l=D(),d=D(),u=D(),g=D();let h=Se(t,"id",8),y=Se(t,"x",8),w=Se(t,"y",8),M=Se(t,"shape",8),_=Se(t,"rotation",8,0),E=Se(t,"selected",8,!1),P=Se(t,"screenToSvg",8),re=Se(t,"onSelect",8,()=>{}),V=Se(t,"onDrag",8,()=>{}),z=Se(t,"onRotate",8,()=>{});function we(Q){const _e=Q.map(Re=>Re.x),me=Q.map(Re=>Re.y);return{minX:Math.min(..._e),maxX:Math.max(..._e),minY:Math.min(...me),maxY:Math.max(...me)}}let De=D(!1),A=!1,de={x:0,y:0};function G(Q){Q.stopPropagation(),re()(h())}function Ae(Q){if(Q.button!==0)return;Q.preventDefault(),Q.stopPropagation(),re()(h()),b(De,!0);const _e=P()(Q.clientX,Q.clientY);de={x:_e.x-y(),y:_e.y-w()},window.addEventListener("mousemove",Ne),window.addEventListener("mouseup",Ve)}function Ne(Q){if(!r(De))return;const _e=P()(Q.clientX,Q.clientY);let me=_e.x-de.x,Re=_e.y-de.y;Q.shiftKey||(me=Math.round(me),Re=Math.round(Re));const Qe=Math.max(r(i),r(s));me=Math.max(-Qe,Math.min(oe.width+Qe-r(i),me)),Re=Math.max(-Qe,Math.min(oe.height+Qe-r(s),Re)),V()(h(),me,Re)}function Ve(){b(De,!1),window.removeEventListener("mousemove",Ne),window.removeEventListener("mouseup",Ve)}function le(Q){Q.preventDefault(),Q.stopPropagation(),A=!0,window.addEventListener("mousemove",ne),window.addEventListener("mouseup",J)}function ne(Q){if(!A)return;const _e=P()(Q.clientX,Q.clientY),me=_e.x-r(o),Re=_e.y-r(c);let Qe=Math.atan2(Re,me)*180/Math.PI+45;Q.shiftKey||(Qe=Math.round(Qe/15)*15),z()(h(),Qe)}function J(){A=!1,window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",J)}q(()=>F(M()),()=>{b(n,Pr(M()))}),q(()=>r(n),()=>{b(a,we(r(n)))}),q(()=>r(a),()=>{b(i,r(a).maxX-r(a).minX)}),q(()=>r(a),()=>{b(s,r(a).maxY-r(a).minY)}),q(()=>(F(y()),r(a),r(i)),()=>{b(o,y()+r(a).minX+r(i)/2)}),q(()=>(F(w()),r(a),r(s)),()=>{b(c,w()+r(a).minY+r(s)/2)}),q(()=>(r(n),F(y()),F(w())),()=>{b(l,r(n).length>0?`M ${r(n).map(Q=>`${y()+Q.x},${w()+Q.y}`).join(" L ")} Z`:"")}),q(()=>(r(i),r(s)),()=>{b(d,Math.max(r(i),r(s))/2+1.5)}),q(()=>(r(o),r(d),F(_())),()=>{b(u,r(o)+r(d)*Math.cos((_()-45)*Math.PI/180))}),q(()=>(r(c),r(d),F(_())),()=>{b(g,r(c)+r(d)*Math.sin((_()-45)*Math.PI/180))}),nr(),Nt();var ge=Ro();let H;var ue=m(ge),B=m(ue),te=x(ue);{var pe=Q=>{var _e=Ao(),me=$e(_e),Re=x(me);R(()=>{v(me,"x1",r(o)),v(me,"y1",r(c)),v(me,"x2",r(u)),v(me,"y2",r(g)),v(Re,"cx",r(u)),v(Re,"cy",r(g))}),Y("mousedown",Re,le),L(Q,_e)};he(te,Q=>{E()&&Q(pe)})}R(()=>{H=At(ge,0,"wall-piece svelte-1tez9jd",null,H,{selected:E(),dragging:r(De)}),v(ue,"transform",`rotate(${_()??""}, ${r(o)??""}, ${r(c)??""})`),v(B,"d",r(l)),v(B,"fill",E()?"rgba(139, 69, 19, 0.6)":"rgba(139, 69, 19, 0.8)"),v(B,"stroke",E()?"#3b82f6":"#5c3317"),v(B,"stroke-width",E()?.15:.1)}),Y("click",B,G),Y("mousedown",B,Ae),L(e,ge),Tt()}var Io=ie('<div class="section-content svelte-7o4pd4"><!></div>'),Oo=ie('<section><div class="section-header svelte-7o4pd4" role="button" tabindex="0"><h3 class="svelte-7o4pd4"> </h3> <span class="toggle-icon svelte-7o4pd4"> </span></div> <!></section>');function ft(e,t){let n=Se(t,"title",8),a=Se(t,"defaultOpen",8,!0),i=D(a());function s(){b(i,!r(i))}var o=Oo();let c;var l=m(o),d=m(l),u=m(d),g=x(d,2),h=m(g),y=x(l,2);{var w=M=>{var _=Io(),E=m(_);li(E,t,"default",{}),L(M,_)};he(y,M=>{r(i)&&M(w)})}R(()=>{c=At(o,1,"collapsible-section svelte-7o4pd4",null,c,{collapsed:!r(i)}),Me(u,n()),Me(h,r(i)?"▼":"▶")}),Y("click",l,s),L(e,o)}var No=ie('<button class="svelte-10mgcx0"> </button>'),jo=ie('<div class="button-group svelte-10mgcx0"></div>'),Wo=ie('<button class="svelte-10mgcx0"> </button>'),Yo=ie('<div class="button-group svelte-10mgcx0"></div>'),Bo=ie('<div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Size</span> <span class="value svelte-10mgcx0"> </span></div> <div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Rotation</span> <span class="value svelte-10mgcx0"> </span></div>',1),Fo=ie('<div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Shape</span> <span class="value svelte-10mgcx0"> </span></div> <div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Rotation</span> <span class="value svelte-10mgcx0"> </span></div>',1),Xo=ie('<div class="edit-form svelte-10mgcx0"><div class="field svelte-10mgcx0"><label for="edit-x" class="svelte-10mgcx0">X (inches)</label> <input id="edit-x" type="number" step="0.1" class="svelte-10mgcx0"/></div> <div class="field svelte-10mgcx0"><label for="edit-y" class="svelte-10mgcx0">Y (inches)</label> <input id="edit-y" type="number" step="0.1" class="svelte-10mgcx0"/></div> <!> <button class="danger svelte-10mgcx0">Remove</button></div>'),Ho=ie('<p class="hint svelte-10mgcx0">Click a piece to select it</p>'),Uo=ie('<div class="button-group vertical svelte-10mgcx0"><button class="svelte-10mgcx0">Save Layout</button> <button class="svelte-10mgcx0">Load Layout</button> <div class="button-row svelte-10mgcx0"><button class="secondary small svelte-10mgcx0">Export</button> <button class="secondary small svelte-10mgcx0">Import</button></div> <button class="secondary svelte-10mgcx0">Clear All</button></div>'),Ko=ie("<!> <!>",1),Vo=ie('<div class="modal-overlay svelte-10mgcx0" role="presentation"><div class="modal svelte-10mgcx0" role="dialog"><h2 class="svelte-10mgcx0">Save Layout</h2> <div class="modal-field svelte-10mgcx0"><label for="layout-name" class="svelte-10mgcx0">Layout Name</label> <input id="layout-name" type="text" placeholder="Enter a name..." class="svelte-10mgcx0"/></div> <div class="modal-actions svelte-10mgcx0"><button class="secondary svelte-10mgcx0">Cancel</button> <button class="svelte-10mgcx0">Save</button></div></div></div>'),Zo=ie('<p class="hint svelte-10mgcx0">No saved layouts yet</p>'),zo=ie('<div class="layout-item svelte-10mgcx0" role="button" tabindex="0"><div class="layout-info svelte-10mgcx0"><span class="layout-name svelte-10mgcx0"> </span> <span class="layout-meta svelte-10mgcx0"> </span></div> <button class="delete-btn svelte-10mgcx0" title="Delete">×</button></div>'),qo=ie('<div class="layout-list svelte-10mgcx0"></div>'),Go=ie('<div class="modal-overlay svelte-10mgcx0" role="presentation"><div class="modal svelte-10mgcx0" role="dialog"><h2 class="svelte-10mgcx0">Load Layout</h2> <!> <div class="modal-actions svelte-10mgcx0"><button class="secondary svelte-10mgcx0">Cancel</button></div></div></div>'),Jo=ie('<main class="svelte-10mgcx0"><div class="header svelte-10mgcx0"><h1 class="svelte-10mgcx0">Layout Builder</h1> <nav class="nav-links svelte-10mgcx0"><a href="#/setup" class="svelte-10mgcx0">Battlefield Setup</a> <a href="#/deployment" class="svelte-10mgcx0">Deployment</a> <a href="#/" class="active svelte-10mgcx0">Layout Builder</a> <a href="#/debug" class="svelte-10mgcx0">Debug Mode</a></nav></div> <div class="layout svelte-10mgcx0"><div class="sidebar svelte-10mgcx0"><!> <!> <!> <!> <input type="file" accept=".json" style="display: none;"/></div> <div class="battlefield-area svelte-10mgcx0"><div class="battlefield-container svelte-10mgcx0" role="presentation"><!></div> <div class="info svelte-10mgcx0"><p class="svelte-10mgcx0"> </p> <p class="hint svelte-10mgcx0">Scroll to zoom | Space+drag or middle-click to pan | Double-click to reset view</p></div></div></div></main> <!> <!>',1);function Qo(e,t){Et(t,!1);const n=()=>Ze($t,"$selectedTerrainId",c),a=()=>Ze(Dt,"$selectedWallId",c),i=()=>Ze(xt,"$layoutTerrains",c),s=()=>Ze(yt,"$layoutWalls",c),o=()=>Ze(qn,"$savedLayoutsList",c),[c,l]=xn(),d=D(),u=D();let g=D(!1),h=D(!1),y=D(""),w=null;Ir(()=>{jr(),window.addEventListener("keydown",M)}),ui(()=>{window.removeEventListener("keydown",M)});function M(k){if(k.target.tagName==="INPUT"||r(g)||r(h))return;const j=n()||a();if((k.key==="Delete"||k.key==="Backspace")&&j){k.preventDefault(),Ae();return}if(j&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(k.key)){k.preventDefault();const I=k.shiftKey?.1:1;let ee=0,U=0;switch(k.key){case"ArrowUp":U=-I;break;case"ArrowDown":U=I;break;case"ArrowLeft":ee=-I;break;case"ArrowRight":ee=I;break}if(n()){const se=i().find(ae=>ae.id===n());se&&xt.updateTerrain(n(),{x:se.x+ee,y:se.y+U})}else if(a()){const se=s().find(ae=>ae.id===a());se&&yt.updateWall(a(),{x:se.x+ee,y:se.y+U})}return}if(k.key==="c"&&(k.ctrlKey||k.metaKey)&&j){if(k.preventDefault(),n()){const I=i().find(ee=>ee.id===n());I&&(w={type:"terrain",data:{...I}})}else if(a()){const I=s().find(ee=>ee.id===a());I&&(w={type:"wall",data:{...I}})}return}if(k.key==="v"&&(k.ctrlKey||k.metaKey)&&w){if(k.preventDefault(),w.type==="terrain"){const I="terrain-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),ee={...w.data,id:I,x:w.data.x+2,y:w.data.y+2};xt.update(U=>[...U,ee]),$t.set(I),Dt.set(null),w.data.x+=2,w.data.y+=2}else if(w.type==="wall"){const I="wall-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),ee={...w.data,id:I,x:w.data.x+2,y:w.data.y+2};yt.update(U=>[...U,ee]),Dt.set(I),$t.set(null),w.data.x+=2,w.data.y+=2}return}if(k.key==="Escape"){we();return}}let _=D(""),E=D("");function P(k,j){xt.add(k,j)}function re(k){yt.add(k)}function V(k){$t.set(k),Dt.set(null)}function z(k){Dt.set(k),$t.set(null)}function we(){$t.set(null),Dt.set(null)}function De(k,j,I){xt.updateTerrain(k,{x:j,y:I})}function A(k,j,I){yt.updateWall(k,{x:j,y:I})}function de(k,j){xt.updateTerrain(k,{rotation:j})}function G(k,j){yt.updateWall(k,{rotation:j})}function Ae(){n()?(xt.remove(n()),$t.set(null)):a()&&(yt.remove(a()),Dt.set(null))}function Ne(){const k=parseFloat(r(_)),j=parseFloat(r(E));!isNaN(k)&&!isNaN(j)&&(n()?xt.updateTerrain(n(),{x:k,y:j}):a()&&yt.updateWall(a(),{x:k,y:j}))}function Ve(){b(y,""),b(g,!0)}function le(){r(y).trim()&&(Po(r(y).trim()),jr(),b(g,!1),b(y,""))}function ne(){jr(),b(h,!0)}function J(k){$o(k),$t.set(null),Dt.set(null),b(h,!1)}function ge(k,j){j.stopPropagation(),confirm(`Delete layout "${k}"?`)&&(Do(k),jr())}function H(){confirm("Clear all terrain and walls?")&&(xt.clear(),yt.clear(),$t.set(null),Dt.set(null))}function ue(k){return new Date(k).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function B(k){const j=Rn.find(I=>I.shape===k);return j?j.label:k}function te(){const k=i(),j=s(),I={version:1,exportedAt:Date.now(),terrains:k,walls:j},ee=JSON.stringify(I,null,2),U=new Blob([ee],{type:"application/json"}),se=URL.createObjectURL(U),ae=document.createElement("a");ae.href=se,ae.download=`layout-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(se)}let pe=D();function Q(){r(pe).click()}function _e(k){const j=k.target.files[0];if(!j)return;const I=new FileReader;I.onload=ee=>{try{const U=JSON.parse(ee.target.result);U.terrains&&Array.isArray(U.terrains)&&xt.set(U.terrains),U.walls&&Array.isArray(U.walls)&&yt.set(U.walls),$t.set(null),Dt.set(null)}catch(U){alert("Failed to import layout: Invalid file format"),console.error("Import error:",U)}},I.readAsText(j),k.target.value=""}q(()=>(i(),n()),()=>{b(d,i().find(k=>k.id===n()))}),q(()=>(s(),a()),()=>{b(u,s().find(k=>k.id===a()))}),q(()=>(r(d),r(u)),()=>{r(d)?(b(_,r(d).x.toFixed(1)),b(E,r(d).y.toFixed(1))):r(u)&&(b(_,r(u).x.toFixed(1)),b(E,r(u).y.toFixed(1)))}),nr(),Nt();var me=Jo(),Re=$e(me),Qe=x(m(Re),2),Z=m(Qe),W=m(Z);ft(W,{title:"Add Terrain",children:(k,j)=>{var I=jo();be(I,5,()=>xi,Oe,(ee,U)=>{var se=No(),ae=m(se);R(()=>Me(ae,(r(U),f(()=>r(U).label)))),Y("click",se,()=>P(r(U).width,r(U).height)),L(ee,se)}),L(k,I)},$$slots:{default:!0}});var C=x(W,2);ft(C,{title:"Add Wall",children:(k,j)=>{var I=Yo();be(I,5,()=>Rn,Oe,(ee,U)=>{var se=Wo(),ae=m(se);R(()=>Me(ae,(r(U),f(()=>r(U).label)))),Y("click",se,()=>re(r(U).shape)),L(ee,se)}),L(k,I)},$$slots:{default:!0}});var S=x(C,2);{let k=Je(()=>r(d)?"Terrain":r(u)?"Wall":"Item");ft(S,{get title(){return`Selected ${r(k)??""}`},children:(j,I)=>{var ee=st(),U=$e(ee);{var se=K=>{var X=Xo(),N=m(X),ce=x(m(N),2),$=x(N,2),ve=x(m($),2),Xe=x($,2);{var je=Te=>{var Pe=Bo(),We=$e(Pe),qe=x(m(We),2),Pt=m(qe),Ge=x(We,2),lt=x(m(Ge),2),Lt=m(lt);R(jt=>{Me(Pt,`${r(d),f(()=>r(d).width)??""}" x ${r(d),f(()=>r(d).height)??""}"`),Me(Lt,`${jt??""}°`)},[()=>(r(d),f(()=>Math.round(r(d).rotation)))]),L(Te,Pe)},Le=Te=>{var Pe=st(),We=$e(Pe);{var qe=Pt=>{var Ge=Fo(),lt=$e(Ge),Lt=x(m(lt),2),jt=m(Lt),Wt=x(lt,2),Ti=x(m(Wt),2),Pi=m(Ti);R(($i,Di)=>{Me(jt,$i),Me(Pi,`${Di??""}°`)},[()=>(r(u),f(()=>B(r(u).shape))),()=>(r(u),f(()=>Math.round(r(u).rotation)))]),L(Pt,Ge)};he(We,Pt=>{r(u)&&Pt(qe)},!0)}L(Te,Pe)};he(Xe,Te=>{r(d)?Te(je):Te(Le,!1)})}var Be=x(Xe,2);mn(ce,()=>r(_),Te=>b(_,Te)),Y("change",ce,Ne),mn(ve,()=>r(E),Te=>b(E,Te)),Y("change",ve,Ne),Y("click",Be,Ae),L(K,X)},ae=K=>{var X=Ho();L(K,X)};he(U,K=>{r(d)||r(u)?K(se):K(ae,!1)})}L(j,ee)},$$slots:{default:!0}})}var xe=x(S,2);ft(xe,{title:"Layout",children:(k,j)=>{var I=Uo(),ee=m(I),U=x(ee,2),se=x(U,2),ae=m(se),K=x(ae,2),X=x(se,2);R(()=>U.disabled=(o(),f(()=>o().length===0))),Y("click",ee,Ve),Y("click",U,ne),Y("click",ae,te),Y("click",K,Q),Y("click",X,H),L(k,I)},$$slots:{default:!0}});var Ue=x(xe,2);di(Ue,k=>b(pe,k),()=>r(pe));var Ke=x(Z,2),Ye=m(Ke),ot=m(Ye);_n(ot,{children:Bn,$$slots:{default:(k,j)=>{const I=Je(()=>j.screenToSvg);var ee=Ko(),U=$e(ee);be(U,1,i,ae=>ae.id,(ae,K)=>{{let X=Je(()=>(r(K),n(),f(()=>r(K).id===n())));gi(ae,{get id(){return r(K),f(()=>r(K).id)},get x(){return r(K),f(()=>r(K).x)},get y(){return r(K),f(()=>r(K).y)},get width(){return r(K),f(()=>r(K).width)},get height(){return r(K),f(()=>r(K).height)},get rotation(){return r(K),f(()=>r(K).rotation)},get selected(){return r(X)},get screenToSvg(){return r(I)},onSelect:V,onDrag:De,onRotate:de})}});var se=x(U,2);be(se,1,s,ae=>ae.id,(ae,K)=>{{let X=Je(()=>(r(K),a(),f(()=>r(K).id===a())));Gn(ae,{get id(){return r(K),f(()=>r(K).id)},get x(){return r(K),f(()=>r(K).x)},get y(){return r(K),f(()=>r(K).y)},get shape(){return r(K),f(()=>r(K).shape)},get rotation(){return r(K),f(()=>r(K).rotation)},get selected(){return r(X)},get screenToSvg(){return r(I)},onSelect:z,onDrag:A,onRotate:G})}}),L(k,ee)}}});var p=x(Ye,2),T=m(p),O=m(T),ke=x(Re,2);{var fe=k=>{var j=Vo(),I=m(j),ee=x(m(I),2),U=x(m(ee),2),se=x(ee,2),ae=m(se),K=x(ae,2);R(X=>K.disabled=X,[()=>(r(y),f(()=>!r(y).trim()))]),mn(U,()=>r(y),X=>b(y,X)),Y("keydown",U,X=>X.key==="Enter"&&le()),Y("click",ae,()=>b(g,!1)),Y("click",K,le),Y("click",I,da(function(X){fa.call(this,t,X)})),Y("click",j,()=>b(g,!1)),L(k,j)};he(ke,k=>{r(g)&&k(fe)})}var Ee=x(ke,2);{var Ie=k=>{var j=Go(),I=m(j),ee=x(m(I),2);{var U=X=>{var N=Zo();L(X,N)},se=X=>{var N=qo();be(N,5,o,Oe,(ce,$)=>{var ve=zo(),Xe=m(ve),je=m(Xe),Le=m(je),Be=x(je,2),Te=m(Be),Pe=x(Xe,2);R(We=>{Me(Le,(r($),f(()=>r($).name))),Me(Te,`${r($),f(()=>r($).terrainCount)??""} terrain${r($),f(()=>r($).terrainCount!==1?"s":"")??""}, ${r($),f(()=>r($).wallCount||0)??""} wall${r($),f(()=>(r($).wallCount||0)!==1?"s":"")??""} · ${We??""}`)},[()=>(r($),f(()=>ue(r($).savedAt)))]),Y("click",Pe,We=>ge(r($).name,We)),Y("click",ve,()=>J(r($).name)),L(ce,ve)}),L(X,N)};he(ee,X=>{o(),f(()=>o().length===0)?X(U):X(se,!1)})}var ae=x(ee,2),K=m(ae);Y("click",K,()=>b(h,!1)),Y("click",I,da(function(X){fa.call(this,t,X)})),Y("click",j,()=>b(h,!1)),L(k,j)};he(Ee,k=>{r(h)&&k(Ie)})}R(()=>Me(O,`Battlefield: 60" x 44" | ${i(),f(()=>i().length)??""} terrain${i(),f(()=>i().length!==1?"s":"")??""} | ${s(),f(()=>s().length)??""} wall${s(),f(()=>s().length!==1?"s":"")??""}`)),Y("change",Ue,_e),Y("click",Ye,we),L(e,me),Tt(),l()}const wi=1/25.4,Li=40*wi/2,Si=3+20*wi;function Mi(e="item"){return e+"-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function el(){const{subscribe:e,set:t,update:n}=rt([]);return{subscribe:e,set:t,update:n,add(a){const i=Mi("zone");return n(s=>[...s,{id:i,...a}]),i},updateZone(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){t([])}}}function tl(){const{subscribe:e,set:t,update:n}=rt([]);return{subscribe:e,set:t,update:n,add(a,i,s=!1){const o=Mi("obj"),c=Math.round(a),l=Math.round(i);return n(d=>[...d,{id:o,x:c,y:l,isPrimary:s}]),o},updateObjective(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){t([])}}}el();tl();const rl=[{name:"Dawn of War",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:32},{type:"L",x:60,y:32},{type:"L",x:60,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:0,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:12},{type:"L",x:0,y:12},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:10,y:22,isPrimary:!1},{x:50,y:22,isPrimary:!1},{x:30,y:6,isPrimary:!1},{x:30,y:38,isPrimary:!1}]},{name:"Hammer and Anvil",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:18,y:0},{type:"L",x:18,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:42,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:44},{type:"L",x:42,y:44},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:30,y:6,isPrimary:!1},{x:30,y:38,isPrimary:!1},{x:10,y:22,isPrimary:!1},{x:50,y:22,isPrimary:!1}]},{name:"Tipping Point",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:12,y:0},{type:"L",x:12,y:22},{type:"L",x:20,y:22},{type:"L",x:20,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:40,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:44},{type:"L",x:48,y:44},{type:"L",x:48,y:22},{type:"L",x:40,y:22},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:14,y:34,isPrimary:!1},{x:22,y:8,isPrimary:!1},{x:38,y:36,isPrimary:!1},{x:46,y:10,isPrimary:!1}]},{name:"Search and Destroy",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:22},{type:"L",x:21,y:22},{type:"A",rx:9,ry:9,rotation:0,largeArc:0,sweep:0,x:30,y:31},{type:"L",x:30,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:30,y:0},{type:"L",x:30,y:13},{type:"A",rx:9,ry:9,rotation:0,largeArc:0,sweep:1,x:39,y:22},{type:"L",x:60,y:22},{type:"L",x:60,y:0},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:14,y:10,isPrimary:!1},{x:46,y:34,isPrimary:!1},{x:14,y:34,isPrimary:!1},{x:46,y:10,isPrimary:!1}]},{name:"Sweeping Engagement",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:0,y:8},{type:"L",x:30,y:8},{type:"L",x:30,y:14},{type:"L",x:60,y:14},{type:"L",x:60,y:0},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:0,y:44},{type:"L",x:60,y:44},{type:"L",x:60,y:36},{type:"L",x:30,y:36},{type:"L",x:30,y:30},{type:"L",x:0,y:30},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:10,y:18,isPrimary:!1},{x:50,y:26,isPrimary:!1},{x:18,y:38,isPrimary:!1},{x:42,y:6,isPrimary:!1}]},{name:"Crucible of Battle",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:30,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:60,y:44},{type:"L",x:30,y:0},{type:"L",x:60,y:0},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:20,y:8,isPrimary:!1},{x:40,y:36,isPrimary:!1},{x:14,y:34,isPrimary:!1},{x:46,y:10,isPrimary:!1}]}];function In(e){return e.map(t=>{switch(t.type){case"M":return`M ${t.x} ${t.y}`;case"L":return`L ${t.x} ${t.y}`;case"A":return`A ${t.rx} ${t.ry} ${t.rotation} ${t.largeArc} ${t.sweep} ${t.x} ${t.y}`;case"Z":return"Z";default:return""}}).join(" ")}const nn=rt(null),wr=rt(null),Br=rt(null),ki=ar([wr,Br],([e,t])=>{if(!e)return{terrains:[],walls:[]};if(t==="preset"){const n=_i.find(a=>a.name===e);return n?{terrains:n.terrains||[],walls:n.walls||[]}:{terrains:[],walls:[]}}else if(t==="saved"){const n=localStorage.getItem("warhammer-deployment-layouts");if(n)try{const a=JSON.parse(n);if(a[e])return{terrains:a[e].terrains||[],walls:a[e].walls||[]}}catch(a){console.error("Failed to load layout:",a)}}return{terrains:[],walls:[]}});var nl=ie('<div class="selected-item svelte-1jotvmi"><span class="selected-name svelte-1jotvmi"> </span> <button class="small secondary svelte-1jotvmi">Change</button></div>'),al=ie('<button class="svelte-1jotvmi"> </button>'),il=ie('<div class="button-group svelte-1jotvmi"></div>'),sl=ie('<div class="selected-item svelte-1jotvmi"><span class="selected-name svelte-1jotvmi"> </span> <button class="small secondary svelte-1jotvmi">Change</button></div>'),ol=ie('<button class="svelte-1jotvmi"> </button>'),ll=ie('<button class="svelte-1jotvmi"> </button>'),cl=ie('<div class="layout-group svelte-1jotvmi"><h4 class="svelte-1jotvmi">Saved</h4> <div class="button-group svelte-1jotvmi"></div></div>'),dl=ie('<div class="layout-sections svelte-1jotvmi"><div class="layout-group svelte-1jotvmi"><h4 class="svelte-1jotvmi">Presets</h4> <div class="button-group svelte-1jotvmi"></div></div> <!></div>'),ul=ie('<div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Objectives:</span> <span class="value svelte-1jotvmi"> </span></div>'),fl=ie('<div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Pieces:</span> <span class="value svelte-1jotvmi"> </span></div>'),vl=ie('<div class="summary svelte-1jotvmi"><div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Deployment:</span> <span class="value svelte-1jotvmi"> </span></div> <div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Terrain:</span> <span class="value svelte-1jotvmi"> </span></div> <!> <!></div>'),hl=ye('<path stroke-width="0.10" stroke-dasharray="0.5,0.25"></path>'),yl=ye('<circle stroke-width="0.05" stroke-dasharray="0.3,0.15"></circle><circle stroke="#000" stroke-width="0.06"></circle><circle r="0.15" fill="#000"></circle>',1),gl=ye("<!><!>",1),pl=ye('<g><rect fill="rgba(139, 90, 43, 0.6)" stroke="#8b5a2b" stroke-width="0.1"></rect></g>'),xl=ye('<g><path fill="rgba(139, 69, 19, 0.8)" stroke="#5c3317" stroke-width="0.1"></path></g>'),_l=ye("<!><!><!>",1),ml=ie('<main class="svelte-1jotvmi"><div class="header svelte-1jotvmi"><h1 class="svelte-1jotvmi">Battlefield Setup</h1> <nav class="nav-links svelte-1jotvmi"><a href="#/setup" class="active svelte-1jotvmi">Battlefield Setup</a> <a href="#/deployment" class="svelte-1jotvmi">Deployment</a> <a href="#/" class="svelte-1jotvmi">Layout Builder</a> <a href="#/debug" class="svelte-1jotvmi">Debug Mode</a></nav></div> <div class="layout svelte-1jotvmi"><div class="sidebar svelte-1jotvmi"><!> <!> <!></div> <div class="battlefield-area svelte-1jotvmi"><div class="battlefield-container svelte-1jotvmi"><!></div> <div class="info svelte-1jotvmi"><p class="svelte-1jotvmi">Battlefield: 60" x 44"</p> <p class="hint svelte-1jotvmi">Scroll to zoom | Space+drag to pan | Double-click to reset view</p></div></div></div></main>');function bl(e,t){Et(t,!1);const n=()=>Ze(nn,"$selectedDeployment",o),a=()=>Ze(wr,"$selectedLayoutName",o),i=()=>Ze(qn,"$savedLayoutsList",o),s=()=>Ze(ki,"$loadedTerrain",o),[o,c]=xn();Ir(()=>{jr()});function l(A){nn.set(A)}function d(A){wr.set(A.name),Br.set("preset")}function u(A){wr.set(A),Br.set("saved")}function g(){wr.set(null),Br.set(null)}function h(){nn.set(null)}function y(A){let G=[];switch(A.shape){case"L-4x8":G=[{x:0,y:0},{x:.5,y:0},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];break;case"L-4x8-mirror":G=[{x:0,y:0},{x:.5,y:0},{x:.5,y:8},{x:-4+.5,y:8},{x:-4+.5,y:8-.5},{x:0,y:8-.5}];break;case"C-4-8-4":G=[{x:0,y:0},{x:4,y:0},{x:4,y:.5},{x:.5,y:.5},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];break;case"L-5x6":G=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:5,y:6-.5},{x:5,y:6},{x:0,y:6}];break;case"L-5x6-mirror":G=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-5+.5,y:6},{x:-5+.5,y:6-.5},{x:0,y:6-.5}];break;case"L-4x6":G=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:4,y:6-.5},{x:4,y:6},{x:0,y:6}];break;case"L-4x6-mirror":G=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-4+.5,y:6},{x:-4+.5,y:6-.5},{x:0,y:6-.5}];break;default:return""}return`M ${G.map(Ae=>`${A.x+Ae.x},${A.y+Ae.y}`).join(" L ")} Z`}function w(A){switch(A.shape){case"L-4x8":return{x:A.x+2,y:A.y+4};case"L-4x8-mirror":return{x:A.x-2+.5,y:A.y+4};case"C-4-8-4":return{x:A.x+2,y:A.y+4};case"L-5x6":return{x:A.x+2.5,y:A.y+3};case"L-5x6-mirror":return{x:A.x-2.5+.5,y:A.y+3};case"L-4x6":return{x:A.x+2,y:A.y+3};case"L-4x6-mirror":return{x:A.x-2+.5,y:A.y+3};default:return{x:A.x,y:A.y}}}Nt();var M=ml(),_=x(m(M),2),E=m(_),P=m(E);ft(P,{title:"Deployment",children:(A,de)=>{var G=st(),Ae=$e(G);{var Ne=le=>{var ne=nl(),J=m(ne),ge=m(J),H=x(J,2);R(()=>Me(ge,n().name)),Y("click",H,h),L(le,ne)},Ve=le=>{var ne=il();be(ne,5,()=>rl,Oe,(J,ge)=>{var H=al(),ue=m(H);R(()=>Me(ue,r(ge).name)),Y("click",H,()=>l(r(ge))),L(J,H)}),L(le,ne)};he(Ae,le=>{n()?le(Ne):le(Ve,!1)})}L(A,G)},$$slots:{default:!0}});var re=x(P,2);ft(re,{title:"Terrain Layout",children:(A,de)=>{var G=st(),Ae=$e(G);{var Ne=le=>{var ne=sl(),J=m(ne),ge=m(J),H=x(J,2);R(()=>Me(ge,a())),Y("click",H,g),L(le,ne)},Ve=le=>{var ne=dl(),J=m(ne),ge=x(m(J),2);be(ge,5,()=>_i,Oe,(B,te)=>{var pe=ol(),Q=m(pe);R(()=>Me(Q,r(te).name)),Y("click",pe,()=>d(r(te))),L(B,pe)});var H=x(J,2);{var ue=B=>{var te=cl(),pe=x(m(te),2);be(pe,5,i,Oe,(Q,_e)=>{var me=ll(),Re=m(me);R(()=>Me(Re,r(_e).name)),Y("click",me,()=>u(r(_e).name)),L(Q,me)}),L(B,te)};he(H,B=>{i().length>0&&B(ue)})}L(le,ne)};he(Ae,le=>{a()?le(Ne):le(Ve,!1)})}L(A,G)},$$slots:{default:!0}});var V=x(re,2);ft(V,{title:"Summary",children:(A,de)=>{var G=vl(),Ae=m(G),Ne=x(m(Ae),2),Ve=m(Ne),le=x(Ae,2),ne=x(m(le),2),J=m(ne),ge=x(le,2);{var H=te=>{var pe=ul(),Q=x(m(pe),2),_e=m(Q);R(()=>Me(_e,n().objectives.length)),L(te,pe)};he(ge,te=>{n()&&te(H)})}var ue=x(ge,2);{var B=te=>{var pe=fl(),Q=x(m(pe),2),_e=m(Q);R(()=>Me(_e,`${s().terrains.length??""} terrain, ${s().walls.length??""} walls`)),L(te,pe)};he(ue,te=>{(s().terrains.length>0||s().walls.length>0)&&te(B)})}R(()=>{Me(Ve,n()?.name||"None"),Me(J,a()||"None")}),L(A,G)},$$slots:{default:!0}});var z=x(E,2),we=m(z),De=m(we);_n(De,{children:(A,de)=>{var G=_l(),Ae=$e(G);{var Ne=ne=>{var J=gl(),ge=$e(J);be(ge,1,()=>n().zones,Oe,(ue,B)=>{var te=hl();R(pe=>{v(te,"d",pe),v(te,"fill",r(B).color),v(te,"stroke",r(B).borderColor)},[()=>In(r(B).path)]),L(ue,te)});var H=x(ge);be(H,1,()=>n().objectives,Oe,(ue,B)=>{const te=Je(()=>r(B).isPrimary?"#fbbf24":"#9ca3af"),pe=Je(()=>r(B).isPrimary?"rgba(251, 191, 36, 0.15)":"rgba(156, 163, 175, 0.15)");var Q=yl(),_e=$e(Q),me=x(_e),Re=x(me);R(()=>{v(_e,"cx",r(B).x),v(_e,"cy",r(B).y),v(_e,"r",Si),v(_e,"fill",r(pe)),v(_e,"stroke",r(te)),v(me,"cx",r(B).x),v(me,"cy",r(B).y),v(me,"r",Li),v(me,"fill",r(te)),v(Re,"cx",r(B).x),v(Re,"cy",r(B).y)}),L(ue,Q)}),L(ne,J)};he(Ae,ne=>{n()&&ne(Ne)})}var Ve=x(Ae);be(Ve,1,()=>s().terrains,Oe,(ne,J)=>{const ge=Je(()=>r(J).x+r(J).width/2),H=Je(()=>r(J).y+r(J).height/2);var ue=pl(),B=m(ue);R(()=>{v(ue,"transform",`rotate(${r(J).rotation??""}, ${r(ge)??""}, ${r(H)??""})`),v(B,"x",r(J).x),v(B,"y",r(J).y),v(B,"width",r(J).width),v(B,"height",r(J).height)}),L(ne,ue)});var le=x(Ve);be(le,1,()=>s().walls,Oe,(ne,J)=>{const ge=Je(()=>w(r(J)));var H=xl(),ue=m(H);R(B=>{v(H,"transform",`rotate(${r(J).rotation??""}, ${r(ge).x??""}, ${r(ge).y??""})`),v(ue,"d",B)},[()=>y(r(J))]),L(ne,H)}),L(A,G)},$$slots:{default:!0}}),L(e,M),Tt(),c()}const et=1/25.4,kt={circles:[{type:"25mm",radius:25*et/2,label:"25mm"},{type:"28.5mm",radius:28.5*et/2,label:"28mm.5"},{type:"32mm",radius:32*et/2,label:"32mm"},{type:"40mm",radius:40*et/2,label:"40mm"},{type:"50mm",radius:50*et/2,label:"50mm"},{type:"60mm",radius:60*et/2,label:"60mm"},{type:"80mm",radius:80*et/2,label:"80mm"},{type:"90mm",radius:90*et/2,label:"90mm"},{type:"100mm",radius:100*et/2,label:"100mm"},{type:"130mm",radius:130*et/2,label:"130mm"}],ovals:[{type:"60x35.5mm",width:60*et,height:35.5*et,label:"60×35.5mm"},{type:"75x42mm",width:75*et,height:42*et,label:"75×42mm"},{type:"90x52.5mm",width:90*et,height:52.5*et,label:"90×52.5mm"},{type:"105x70mm",width:105*et,height:70*et,label:"105×70mm"},{type:"120x90mm",width:120*et,height:90*et,label:"120×90mm"}]};function Fr(e){const t=kt.circles.find(a=>a.type===e);return t||kt.ovals.find(a=>a.type===e)}function Xr(e){return kt.ovals.some(t=>t.type===e)}function wl(){return"model-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function Ei(){const{subscribe:e,set:t,update:n}=rt([]);return{subscribe:e,set:t,update:n,add(a,i,s,o){const c=wl(),l={id:c,baseType:a,playerId:i,x:s,y:o,rotation:0};return n(d=>[...d,l]),c},updateModel(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},removeByPlayer(a){n(i=>i.filter(s=>s.playerId!==a))},clear(){t([])}}}const gt=Ei(),Ll=ar(gt,e=>e.filter(t=>t.playerId===1)),Sl=ar(gt,e=>e.filter(t=>t.playerId===2)),ir=rt(null);ar([gt,ir],([e,t])=>t?e.find(n=>n.id===t):null);const Jt=Ei(),sr=rt(null);ar([Jt,sr],([e,t])=>t?e.find(n=>n.id===t):null);var Ml=ye('<g><ellipse role="button" tabindex="0" class="svelte-hycs6b"></ellipse></g>'),kl=ye('<circle role="button" tabindex="0" class="svelte-hycs6b"></circle>'),El=ye('<text text-anchor="middle" dominant-baseline="middle" font-size="0.4" font-weight="bold" fill="white" pointer-events="none" class="model-name"> </text>'),Tl=ye('<line stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-hycs6b"></circle>',1),Pl=ye("<g><!><!><!></g>");function fn(e,t){Et(t,!1);const n=D(),a=D(),i=D(),s=D(),o=D(),c=D(),l=D(),d=D(),u=D(),g=D(),h=D();let y=Se(t,"id",8),w=Se(t,"x",8),M=Se(t,"y",8),_=Se(t,"baseType",8),E=Se(t,"playerId",8),P=Se(t,"rotation",8,0),re=Se(t,"selected",8,!1),V=Se(t,"name",8,""),z=Se(t,"screenToSvg",8),we=Se(t,"onSelect",8,()=>{}),De=Se(t,"onDrag",8,()=>{}),A=Se(t,"onRotate",8,()=>{}),de=Se(t,"onRename",8,()=>{}),G=D(!1),Ae=!1,Ne={x:0,y:0};function Ve(C){C.stopPropagation(),we()(y())}function le(C){C.stopPropagation();const S=prompt("Model name:",V());S!==null&&de()(y(),S)}function ne(C){if(C.button!==0)return;C.preventDefault(),C.stopPropagation(),we()(y()),b(G,!0);const S=z()(C.clientX,C.clientY);Ne={x:S.x-w(),y:S.y-M()},window.addEventListener("mousemove",J),window.addEventListener("mouseup",ge)}function J(C){if(!r(G))return;const S=z()(C.clientX,C.clientY);let xe=S.x-Ne.x,Ue=S.y-Ne.y;De()(y(),xe,Ue)}function ge(){b(G,!1),window.removeEventListener("mousemove",J),window.removeEventListener("mouseup",ge)}function H(C){C.preventDefault(),C.stopPropagation(),Ae=!0,window.addEventListener("mousemove",ue),window.addEventListener("mouseup",B)}function ue(C){if(!Ae)return;const S=z()(C.clientX,C.clientY),xe=S.x-w(),Ue=S.y-M();let Ke=Math.atan2(Ue,xe)*180/Math.PI+45;C.shiftKey||(Ke=Math.round(Ke/15)*15),A()(y(),Ke)}function B(){Ae=!1,window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",B)}q(()=>F(_()),()=>{b(n,Fr(_()))}),q(()=>F(_()),()=>{b(a,Xr(_()))}),q(()=>F(E()),()=>{b(i,E()===1?"#3b82f6":"#ef4444")}),q(()=>F(E()),()=>{b(s,E()===1?"rgba(59, 130, 246, 0.5)":"rgba(239, 68, 68, 0.5)")}),q(()=>F(re()),()=>{b(o,re()?.15:.1)}),q(()=>r(n),()=>{b(c,r(n)?.radius||.5)}),q(()=>r(n),()=>{b(l,r(n)?.width?r(n).width/2:0)}),q(()=>r(n),()=>{b(d,r(n)?.height?r(n).height/2:0)}),q(()=>(r(a),r(l),r(d)),()=>{b(u,r(a)?Math.max(r(l),r(d))+1:0)}),q(()=>(F(w()),r(u),F(P())),()=>{b(g,w()+r(u)*Math.cos((P()-45)*Math.PI/180))}),q(()=>(F(M()),r(u),F(P())),()=>{b(h,M()+r(u)*Math.sin((P()-45)*Math.PI/180))}),nr(),Nt();var te=Pl();let pe;var Q=m(te);{var _e=C=>{var S=Ml(),xe=m(S);R(()=>{v(S,"transform",`rotate(${P()??""}, ${w()??""}, ${M()??""})`),v(xe,"cx",w()),v(xe,"cy",M()),v(xe,"rx",r(l)),v(xe,"ry",r(d)),v(xe,"fill",re()?r(i):r(s)),v(xe,"stroke",r(i)),v(xe,"stroke-width",r(o))}),Y("click",xe,Ve),Y("dblclick",xe,le),Y("mousedown",xe,ne),L(C,S)},me=C=>{var S=kl();R(()=>{v(S,"cx",w()),v(S,"cy",M()),v(S,"r",r(c)),v(S,"fill",re()?r(i):r(s)),v(S,"stroke",r(i)),v(S,"stroke-width",r(o))}),Y("click",S,Ve),Y("dblclick",S,le),Y("mousedown",S,ne),L(C,S)};he(Q,C=>{r(a)?C(_e):C(me,!1)})}var Re=x(Q);{var Qe=C=>{var S=El(),xe=m(S);R(()=>{v(S,"x",w()),v(S,"y",M()),Me(xe,V())}),L(C,S)};he(Re,C=>{V()&&C(Qe)})}var Z=x(Re);{var W=C=>{var S=Tl(),xe=$e(S),Ue=x(xe);R(()=>{v(xe,"x1",w()),v(xe,"y1",M()),v(xe,"x2",r(g)),v(xe,"y2",r(h)),v(xe,"stroke",r(i)),v(Ue,"cx",r(g)),v(Ue,"cy",r(h)),v(Ue,"fill",r(i)),v(Ue,"stroke",E()===1?"#1d4ed8":"#b91c1c")}),Y("mousedown",Ue,H),L(C,S)};he(Z,C=>{re()&&r(a)&&C(W)})}R(()=>pe=At(te,0,"model-base svelte-hycs6b",null,pe,{selected:re(),dragging:r(G)})),L(e,te),Tt()}var $l=ye('<ellipse fill="none" stroke-width="2"></ellipse>'),Dl=ye('<circle fill="none" stroke-width="2"></circle>'),Cl=ie('<button class="palette-item svelte-1urec28"><svg class="svelte-1urec28"><!></svg> <span class="label svelte-1urec28"> </span></button>');function vn(e,t){Et(t,!1);const n=D(),a=D(),i=D(),s=D(),o=D(),c=D();let l=Se(t,"baseSize",8),d=Se(t,"playerId",8),u=Se(t,"onDragStart",8,()=>{});const g=3;function h(V){V.button===0&&(V.preventDefault(),u()(l(),V))}q(()=>F(d()),()=>{b(n,d()===1?"#3b82f6":"#ef4444")}),q(()=>F(l()),()=>{b(a,l().width!==void 0)}),q(()=>(r(a),F(l())),()=>{b(i,r(a)?null:l().radius*g)}),q(()=>(r(a),F(l())),()=>{b(s,r(a)?l().width/2*g:null)}),q(()=>(r(a),F(l())),()=>{b(o,r(a)?l().height/2*g:null)}),q(()=>(r(a),F(l())),()=>{b(c,r(a)?Math.max(l().width,l().height)*g:l().radius*2*g)}),nr(),Nt();var y=Cl(),w=m(y),M=m(w);{var _=V=>{var z=$l();R(()=>{v(z,"cx",(r(c)+8)/2),v(z,"cy",(r(c)+8)/2),v(z,"rx",r(s)),v(z,"ry",r(o)),v(z,"stroke",r(n))}),L(V,z)},E=V=>{var z=Dl();R(()=>{v(z,"cx",(r(c)+8)/2),v(z,"cy",(r(c)+8)/2),v(z,"r",r(i)),v(z,"stroke",r(n))}),L(V,z)};he(M,V=>{r(a)?V(_):V(E,!1)})}var P=x(w,2),re=m(P);R(()=>{Vs(y,`border-color: ${r(n)??""}`),v(y,"title",(F(l()),f(()=>l().label))),v(w,"width",r(c)+8),v(w,"height",r(c)+8),v(w,"viewBox",`0 0 ${r(c)+8} ${r(c)+8}`),Me(re,(F(l()),f(()=>l().label)))}),Y("mousedown",y,h),L(e,y),Tt()}var Al=ie('<div class="player-toggle svelte-1g40uyy"><button>Player 1</button> <button>Player 2</button></div> <div class="base-palette svelte-1g40uyy"><div class="palette-section svelte-1g40uyy"><h4 class="svelte-1g40uyy">Circles</h4> <div class="palette-grid svelte-1g40uyy"></div></div> <div class="palette-section svelte-1g40uyy"><h4 class="svelte-1g40uyy">Ovals</h4> <div class="palette-grid svelte-1g40uyy"></div></div></div>',1),Rl=ie('<div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Rotation</span> <span class="value svelte-1g40uyy"> </span></div>'),Il=ie('<div class="field svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> Show Debug Rays</label></div>'),Ol=ie('<div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">LoS Status</span> <span class="value svelte-1g40uyy"> </span></div>'),Nl=ie('<div class="edit-form svelte-1g40uyy"><div class="field svelte-1g40uyy"><label for="model-name">Name</label> <input id="model-name" type="text"/></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Base Type</span> <span class="value svelte-1g40uyy"> </span></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Player</span> <span class="value svelte-1g40uyy"> </span></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Position</span> <span class="value svelte-1g40uyy"> </span></div> <!> <div class="field svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> Show Line of Sight</label></div> <!> <!> <button class="danger svelte-1g40uyy">Remove</button></div>'),jl=ie('<p class="hint svelte-1g40uyy">Click a model to select it</p>'),Wl=ie('<div class="button-group vertical svelte-1g40uyy"><button class="svelte-1g40uyy">Save State</button> <button class="svelte-1g40uyy">Restore State</button> <button class="secondary svelte-1g40uyy">Clear All Models</button> <button class="secondary svelte-1g40uyy">Clear Saved State</button></div>'),Yl=ye('<path stroke-width="0.10" stroke-dasharray="0.5,0.25" pointer-events="none"></path>'),Bl=ye('<circle stroke-width="0.05" stroke-dasharray="0.3,0.15" pointer-events="none"></circle><circle stroke="#000" stroke-width="0.06" pointer-events="none"></circle><circle r="0.15" fill="#000" pointer-events="none"></circle>',1),Fl=ye("<!><!>",1),Xl=ye('<g><rect fill="rgba(139, 90, 43, 0.2)" stroke="#8b5a2b" stroke-width="0.1" pointer-events="none"></rect></g>'),Hl=ye('<g opacity="0.5" pointer-events="none"><!></g>'),Ul=ye('<line stroke-width="0.05" pointer-events="none"></line>'),Kl=ye('<line stroke="#22c55e" stroke-width="0.15" opacity="0.7" pointer-events="none"></line>'),Vl=ye('<line stroke="#ef4444" stroke-width="0.1" stroke-dasharray="0.5 0.25" opacity="0.7" pointer-events="none"></line>'),Zl=ye("<!><!><!><!><!><!><!><!>",1),zl=ie('<main class="svelte-1g40uyy"><div class="header svelte-1g40uyy"><h1 class="svelte-1g40uyy">Deployment Practice</h1> <nav class="nav-links svelte-1g40uyy"><a href="#/setup" class="svelte-1g40uyy">Battlefield Setup</a> <a href="#/deployment" class="active svelte-1g40uyy">Deployment</a> <a href="#/" class="svelte-1g40uyy">Layout Builder</a> <a href="#/debug" class="svelte-1g40uyy">Debug Mode</a></nav></div> <div class="layout svelte-1g40uyy"><div class="sidebar svelte-1g40uyy"><!> <!> <!></div> <div class="battlefield-area svelte-1g40uyy"><div class="battlefield-container svelte-1g40uyy" role="presentation"><!></div> <div class="info svelte-1g40uyy"><p class="svelte-1g40uyy"> </p> <p class="hint svelte-1g40uyy">Press 1/2 to switch player | Press L to toggle LoS | Drag models to move</p></div></div></div></main>');function ql(e,t){Et(t,!1);const n=()=>Ze(nn,"$selectedDeployment",u),a=()=>Ze(wr,"$selectedLayoutName",u),i=()=>Ze(Br,"$selectedLayoutType",u),s=()=>Ze(gt,"$models",u),o=()=>Ze(ir,"$selectedModelId",u),c=()=>Ze(ki,"$loadedTerrain",u),l=()=>Ze(Ll,"$player1Models",u),d=()=>Ze(Sl,"$player2Models",u),[u,g]=xn(),h=D(),y=D(),w=D(),M=D(),_=D();let E=D(1),P=D(null),re=!1,V=null,z=D(null),we=D(!1),De=D(!1);const A=5,de="warhammer-deployment-state";function G(){const p={deployment:n()?.name||null,layout:a()||null,layoutType:i()||null,models:s()};localStorage.setItem(de,JSON.stringify(p))}function Ae(){const p=localStorage.getItem(de);if(p)try{const T=JSON.parse(p);T.models&&Array.isArray(T.models)&&gt.set(T.models)}catch(T){console.error("Failed to restore deployment state:",T)}}function Ne(){localStorage.removeItem(de),gt.clear()}Ir(()=>{window.addEventListener("keydown",Ve)}),ui(()=>{window.removeEventListener("keydown",Ve)});function Ve(p){if(p.target.tagName==="INPUT")return;const T=o();if(p.key==="1"){p.preventDefault(),b(E,1);return}if(p.key==="2"){p.preventDefault(),b(E,2);return}if(p.key==="l"||p.key==="L"){p.preventDefault(),b(we,!r(we));return}if((p.key==="Delete"||p.key==="Backspace")&&T){p.preventDefault(),pe();return}if(T&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(p.key)){p.preventDefault();const O=p.shiftKey?.1:1;let ke=0,fe=0;switch(p.key){case"ArrowUp":fe=-O;break;case"ArrowDown":fe=O;break;case"ArrowLeft":ke=-O;break;case"ArrowRight":ke=O;break}if(o()){const Ee=s().find(Ie=>Ie.id===o());Ee&&gt.updateModel(o(),{x:Ee.x+ke,y:Ee.y+fe})}return}if(p.key==="Escape"){le();return}}function le(){ir.set(null)}function ne(p,T){if(!r(z))return;re=!0,V={x:T.clientX,y:T.clientY};const O=r(z)(T.clientX,T.clientY);b(P,{baseType:p.type,x:O.x,y:O.y}),window.addEventListener("mousemove",J),window.addEventListener("mouseup",ge)}function J(p){if(!re||!r(P)||!r(z))return;const T=r(z)(p.clientX,p.clientY);b(P,{...r(P),x:T.x,y:T.y})}function ge(p){if(!re||!r(P)){re=!1,b(P,null),V=null,window.removeEventListener("mousemove",J),window.removeEventListener("mouseup",ge);return}const T=p.clientX-V.x,O=p.clientY-V.y,ke=Math.sqrt(T*T+O*O);let fe,Ee;ke<A?(fe=30,Ee=22):(fe=r(P).x,Ee=r(P).y);const Ie=gt.add(r(P).baseType,r(E),fe,Ee);ir.set(Ie),b(P,null),re=!1,V=null,window.removeEventListener("mousemove",J),window.removeEventListener("mouseup",ge)}function H(p){ir.set(p)}function ue(p,T,O){gt.updateModel(p,{x:T,y:O})}function B(p,T){gt.updateModel(p,{rotation:T})}function te(p,T){gt.updateModel(p,{name:T})}function pe(){o()&&(gt.remove(o()),ir.set(null))}function Q(){confirm("Clear all models?")&&(gt.clear(),ir.set(null))}function _e(p){const T=Fr(p.baseType);return Xr(p.baseType)?{x:p.x,y:p.y,rx:T.width/2,ry:T.height/2,rotation:p.rotation||0}:{x:p.x,y:p.y,radius:T.radius}}q(()=>(s(),o()),()=>{b(h,s().find(p=>p.id===o()))}),q(()=>(r(h),s()),()=>{b(y,r(h)?s().filter(p=>p.playerId!==r(h).playerId):[])}),q(()=>(c(),Ur),()=>{b(w,c().terrains.map(p=>({id:p.id,vertices:Ur(p)})))}),q(()=>(c(),Pr),()=>{b(M,c().walls.map(p=>zn(Pr(p.shape),p.x,p.y,p.rotation)))}),q(()=>(r(h),r(we),r(y),r(w),r(M)),()=>{b(_,r(h)&&r(we)&&r(y).length>0?r(y).map(p=>{const T=hi(_e(r(h)),_e(p),r(w),r(M));return{targetId:p.id,target:p,canSee:T.canSee,firstClearRay:T.firstClearRay,rays:T.rays}}):[])}),nr(),Nt();var me=zl(),Re=x(m(me),2),Qe=m(Re),Z=m(Qe);ft(Z,{title:"Add Models",children:(p,T)=>{var O=Al(),ke=$e(O),fe=m(ke);let Ee;var Ie=x(fe,2);let k;var j=x(ke,2),I=m(j),ee=x(m(I),2);be(ee,5,()=>(F(kt),f(()=>kt.circles)),Oe,(ae,K)=>{vn(ae,{get baseSize(){return r(K)},get playerId(){return r(E)},onDragStart:ne})});var U=x(I,2),se=x(m(U),2);be(se,5,()=>(F(kt),f(()=>kt.ovals)),Oe,(ae,K)=>{vn(ae,{get baseSize(){return r(K)},get playerId(){return r(E)},onDragStart:ne})}),R(()=>{Ee=At(fe,1,"toggle-btn svelte-1g40uyy",null,Ee,{active:r(E)===1}),k=At(Ie,1,"toggle-btn svelte-1g40uyy",null,k,{active:r(E)===2})}),Y("click",fe,()=>b(E,1)),Y("click",Ie,()=>b(E,2)),L(p,O)},$$slots:{default:!0}});var W=x(Z,2);ft(W,{title:"Selected Model",children:(p,T)=>{var O=st(),ke=$e(O);{var fe=Ie=>{var k=Nl(),j=m(k),I=x(m(j),2),ee=x(j,2),U=x(m(ee),2),se=m(U),ae=x(ee,2),K=x(m(ae),2),X=m(K),N=x(ae,2),ce=x(m(N),2),$=m(ce),ve=x(N,2);{var Xe=Ge=>{var lt=Rl(),Lt=x(m(lt),2),jt=m(Lt);R(Wt=>Me(jt,`${Wt??""}°`),[()=>(r(h),f(()=>Math.round(r(h).rotation||0)))]),L(Ge,lt)};he(ve,Ge=>{F(Xr),r(h),f(()=>Xr(r(h).baseType))&&Ge(Xe)})}var je=x(ve,2),Le=m(je),Be=m(Le),Te=x(je,2);{var Pe=Ge=>{var lt=Il(),Lt=m(lt),jt=m(Lt);Dn(jt,()=>r(De),Wt=>b(De,Wt)),L(Ge,lt)};he(Te,Ge=>{r(we)&&Ge(Pe)})}var We=x(Te,2);{var qe=Ge=>{var lt=Ol(),Lt=x(m(lt),2),jt=m(Lt);R(Wt=>Me(jt,`${Wt??""}/${r(_),f(()=>r(_).length)??""} visible`),[()=>(r(_),f(()=>r(_).filter(Wt=>Wt.canSee).length))]),L(Ge,lt)};he(We,Ge=>{r(we),r(_),f(()=>r(we)&&r(_).length>0)&&Ge(qe)})}var Pt=x(We,2);R((Ge,lt,Lt)=>{qs(I,(r(h),f(()=>r(h).name||""))),Me(se,Ge),Me(X,`Player ${r(h),f(()=>r(h).playerId)??""}`),Me($,`${lt??""}", ${Lt??""}"`)},[()=>(F(Fr),r(h),f(()=>Fr(r(h).baseType).label)),()=>(r(h),f(()=>r(h).x.toFixed(1))),()=>(r(h),f(()=>r(h).y.toFixed(1)))]),Y("change",I,Ge=>te(r(h).id,Ge.target.value)),Dn(Be,()=>r(we),Ge=>b(we,Ge)),Y("click",Pt,pe),L(Ie,k)},Ee=Ie=>{var k=jl();L(Ie,k)};he(ke,Ie=>{r(h)?Ie(fe):Ie(Ee,!1)})}L(p,O)},$$slots:{default:!0}});var C=x(W,2);ft(C,{title:"Actions",children:(p,T)=>{var O=Wl(),ke=m(O),fe=x(ke,2),Ee=x(fe,2),Ie=x(Ee,2);Y("click",ke,G),Y("click",fe,Ae),Y("click",Ee,Q),Y("click",Ie,Ne),L(p,O)},$$slots:{default:!0}});var S=x(Qe,2),xe=m(S),Ue=m(xe);_n(Ue,{children:Bn,$$slots:{default:(p,T)=>{const O=Je(()=>T.screenToSvg);var ke=Zl(),fe=$e(ke);{var Ee=ce=>{var $=oi();R(()=>Me($,(r(z),F(r(O)),f(()=>(b(z,r(O)),""))))),L(ce,$)};he(fe,ce=>{r(O)&&!r(z)&&ce(Ee)})}var Ie=x(fe);{var k=ce=>{var $=Fl(),ve=$e($);be(ve,1,()=>(n(),f(()=>n().zones)),Oe,(je,Le)=>{var Be=Yl();R(Te=>{v(Be,"d",Te),v(Be,"fill",(r(Le),f(()=>r(Le).color))),v(Be,"stroke",(r(Le),f(()=>r(Le).borderColor)))},[()=>(F(In),r(Le),f(()=>In(r(Le).path)))]),L(je,Be)});var Xe=x(ve);be(Xe,1,()=>(n(),f(()=>n().objectives)),Oe,(je,Le)=>{const Be=Je(()=>(r(Le),f(()=>r(Le).isPrimary?"#fbbf24":"#9ca3af"))),Te=Je(()=>(r(Le),f(()=>r(Le).isPrimary?"rgba(251, 191, 36, 0.15)":"rgba(156, 163, 175, 0.15)")));var Pe=Bl(),We=$e(Pe),qe=x(We),Pt=x(qe);R(()=>{v(We,"cx",(r(Le),f(()=>r(Le).x))),v(We,"cy",(r(Le),f(()=>r(Le).y))),v(We,"r",Si),v(We,"fill",r(Te)),v(We,"stroke",r(Be)),v(qe,"cx",(r(Le),f(()=>r(Le).x))),v(qe,"cy",(r(Le),f(()=>r(Le).y))),v(qe,"r",Li),v(qe,"fill",r(Be)),v(Pt,"cx",(r(Le),f(()=>r(Le).x))),v(Pt,"cy",(r(Le),f(()=>r(Le).y)))}),L(je,Pe)}),L(ce,$)};he(Ie,ce=>{n()&&ce(k)})}var j=x(Ie);be(j,1,()=>(c(),f(()=>c().terrains)),Oe,(ce,$)=>{var ve=Xl(),Xe=m(ve);R(()=>{v(ve,"transform",`rotate(${r($),f(()=>r($).rotation)??""}, ${r($),f(()=>r($).x+r($).width/2)??""}, ${r($),f(()=>r($).y+r($).height/2)??""})`),v(Xe,"x",(r($),f(()=>r($).x))),v(Xe,"y",(r($),f(()=>r($).y))),v(Xe,"width",(r($),f(()=>r($).width))),v(Xe,"height",(r($),f(()=>r($).height)))}),L(ce,ve)});var I=x(j);be(I,1,()=>(c(),f(()=>c().walls)),Oe,(ce,$)=>{var ve=Hl(),Xe=m(ve);Gn(Xe,{get id(){return r($),f(()=>r($).id)},get x(){return r($),f(()=>r($).x)},get y(){return r($),f(()=>r($).y)},get shape(){return r($),f(()=>r($).shape)},get rotation(){return r($),f(()=>r($).rotation)},selected:!1,get screenToSvg(){return r(O)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}}),L(ce,ve)});var ee=x(I);be(ee,1,s,ce=>ce.id,(ce,$)=>{{let ve=Je(()=>(r($),f(()=>r($).name||""))),Xe=Je(()=>(r($),o(),f(()=>r($).id===o())));fn(ce,{get id(){return r($),f(()=>r($).id)},get x(){return r($),f(()=>r($).x)},get y(){return r($),f(()=>r($).y)},get baseType(){return r($),f(()=>r($).baseType)},get playerId(){return r($),f(()=>r($).playerId)},get rotation(){return r($),f(()=>r($).rotation)},get name(){return r(ve)},get selected(){return r(Xe)},get screenToSvg(){return r(O)},onSelect:H,onDrag:ue,onRotate:B,onRename:te})}});var U=x(ee);{var se=ce=>{fn(ce,{id:"phantom",get x(){return r(P),f(()=>r(P).x)},get y(){return r(P),f(()=>r(P).y)},get baseType(){return r(P),f(()=>r(P).baseType)},get playerId(){return r(E)},rotation:0,selected:!1,get screenToSvg(){return r(O)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}})};he(U,ce=>{r(P)&&ce(se)})}var ae=x(U);{var K=ce=>{var $=st(),ve=$e($);be(ve,1,()=>r(_),Oe,(Xe,je)=>{var Le=st(),Be=$e(Le);be(Be,1,()=>(r(je),f(()=>r(je).rays)),Oe,(Te,Pe)=>{var We=Ul();R(()=>{v(We,"x1",(r(Pe),f(()=>r(Pe).from.x))),v(We,"y1",(r(Pe),f(()=>r(Pe).from.y))),v(We,"x2",(r(Pe),f(()=>r(Pe).to.x))),v(We,"y2",(r(Pe),f(()=>r(Pe).to.y))),v(We,"stroke",(r(Pe),f(()=>r(Pe).blocked?"#ff000033":"#00ff0033")))}),L(Te,We)}),L(Xe,Le)}),L(ce,$)};he(ae,ce=>{r(De),r(we),r(h),r(_),f(()=>r(De)&&r(we)&&r(h)&&r(_).length>0)&&ce(K)})}var X=x(ae);{var N=ce=>{var $=st(),ve=$e($);be(ve,1,()=>r(_),Oe,(Xe,je)=>{var Le=st(),Be=$e(Le);{var Te=We=>{var qe=Kl();R(()=>{v(qe,"x1",(r(je),f(()=>r(je).firstClearRay.from.x))),v(qe,"y1",(r(je),f(()=>r(je).firstClearRay.from.y))),v(qe,"x2",(r(je),f(()=>r(je).firstClearRay.to.x))),v(qe,"y2",(r(je),f(()=>r(je).firstClearRay.to.y)))}),L(We,qe)},Pe=We=>{var qe=Vl();R(()=>{v(qe,"x1",(r(h),f(()=>r(h).x))),v(qe,"y1",(r(h),f(()=>r(h).y))),v(qe,"x2",(r(je),f(()=>r(je).target.x))),v(qe,"y2",(r(je),f(()=>r(je).target.y)))}),L(We,qe)};he(Be,We=>{r(je),f(()=>r(je).firstClearRay)?We(Te):We(Pe,!1)})}L(Xe,Le)}),L(ce,$)};he(X,ce=>{r(we),r(h),r(_),f(()=>r(we)&&r(h)&&r(_).length>0)&&ce(N)})}L(p,ke)}}});var Ke=x(xe,2),Ye=m(Ke),ot=m(Ye);R(()=>Me(ot,`Battlefield: 60" x 44" | ${l(),f(()=>l().length)??""} P1 models | ${d(),f(()=>d().length)??""} P2 models`)),Y("click",xe,le),L(e,me),Tt(),g()}var Gl=ie("<span> </span>"),Jl=ie('<span class="los-status svelte-12aohay">No enemies</span>'),Ql=ie('<div class="controls svelte-12aohay"><label class="svelte-12aohay"><input type="checkbox" class="svelte-12aohay"/> Show debug rays</label> <!></div>'),ec=ie('<button class="svelte-12aohay"> </button>'),tc=ie('<div class="button-group svelte-12aohay"></div>'),rc=ie('<button class="svelte-12aohay"> </button>'),nc=ie('<div class="button-group svelte-12aohay"></div>'),ac=ie('<div class="player-toggle svelte-12aohay"><button>Player 1</button> <button>Player 2</button></div> <div class="base-palette svelte-12aohay"><div class="palette-section svelte-12aohay"><h4 class="svelte-12aohay">Circles</h4> <div class="palette-grid svelte-12aohay"></div></div> <div class="palette-section svelte-12aohay"><h4 class="svelte-12aohay">Ovals</h4> <div class="palette-grid svelte-12aohay"></div></div></div>',1),ic=ye('<line stroke-width="0.05"></line>'),sc=ye('<line stroke="#22c55e" stroke-width="0.15" opacity="0.7" pointer-events="none"></line>'),oc=ye('<line stroke="#ef4444" stroke-width="0.1" stroke-dasharray="0.5 0.25" opacity="0.7" pointer-events="none"></line>'),lc=ye("<!><!><!><!><!><!><!>",1),cc=ie('<p class="svelte-12aohay"> </p>'),dc=ie('<main class="svelte-12aohay"><div class="header svelte-12aohay"><h1 class="svelte-12aohay">Debug Mode</h1> <nav class="nav-links svelte-12aohay"><a href="#/setup" class="svelte-12aohay">Battlefield Setup</a> <a href="#/deployment" class="svelte-12aohay">Deployment</a> <a href="#/" class="svelte-12aohay">Layout Builder</a> <a href="#/debug" class="active svelte-12aohay">Debug Mode</a></nav></div> <div class="layout svelte-12aohay"><div class="sidebar svelte-12aohay"><!> <!> <!> <!></div> <div class="battlefield-area svelte-12aohay"><div class="battlefield-container svelte-12aohay"><!></div> <div class="info svelte-12aohay"><p class="svelte-12aohay"> </p> <!> <p class="hint svelte-12aohay">Scroll to zoom | Space+drag to pan | Double-click to reset view</p></div></div></div></main>');function uc(e,t){Et(t,!1);const n=()=>Ze(Jt,"$debugModels",d),a=()=>Ze(sr,"$debugSelectedModelId",d),i=()=>Ze(Jr,"$debugTerrains",d),s=()=>Ze(Qr,"$debugWalls",d),o=()=>Ze(pa,"$debugMode",d),c=()=>Ze(en,"$debugSelectedTerrainId",d),l=()=>Ze(tn,"$debugSelectedWallId",d),[d,u]=xn(),g=D(),h=D(),y=D(),w=D(),M=D();function _(p,T){Jr.add(p,T)}function E(p){Qr.add(p)}function P(p){en.set(p),tn.set(null),sr.set(null)}function re(p){tn.set(p),en.set(null),sr.set(null)}function V(p,T,O){Jr.updateTerrain(p,{x:T,y:O})}function z(p,T,O){Qr.updateWall(p,{x:T,y:O})}function we(p,T){Jr.updateTerrain(p,{rotation:T})}function De(p,T){Qr.updateWall(p,{rotation:T})}let A=D(1),de=D(null),G=!1,Ae=null,Ne=D(null);const Ve=5;Ir(()=>{if(n().length===0){const p=Jt.add("32mm",1,10,22);Jt.add("32mm",2,50,22),sr.set(p)}});function le(p,T){if(!r(Ne))return;G=!0,Ae={x:T.clientX,y:T.clientY};const O=r(Ne)(T.clientX,T.clientY);b(de,{baseType:p.type,x:O.x,y:O.y}),window.addEventListener("mousemove",ne),window.addEventListener("mouseup",J)}function ne(p){if(!G||!r(de)||!r(Ne))return;const T=r(Ne)(p.clientX,p.clientY);b(de,{...r(de),x:T.x,y:T.y})}function J(p){if(!G||!r(de)){G=!1,b(de,null),Ae=null,window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",J);return}const T=p.clientX-Ae.x,O=p.clientY-Ae.y,ke=Math.sqrt(T*T+O*O);let fe,Ee;ke<Ve?(fe=30,Ee=22):(fe=r(de).x,Ee=r(de).y);const Ie=Jt.add(r(de).baseType,r(A),fe,Ee);sr.set(Ie),b(de,null),G=!1,Ae=null,window.removeEventListener("mousemove",ne),window.removeEventListener("mouseup",J)}function ge(p){sr.set(p),en.set(null),tn.set(null)}function H(p,T,O){Jt.updateModel(p,{x:T,y:O})}function ue(p,T){Jt.updateModel(p,{rotation:T})}function B(p,T){Jt.updateModel(p,{name:T})}function te(p){const T=Fr(p.baseType);return Xr(p.baseType)?{x:p.x,y:p.y,rx:T.width/2,ry:T.height/2,rotation:p.rotation||0}:{x:p.x,y:p.y,radius:T.radius}}q(()=>(n(),a()),()=>{b(g,n().find(p=>p.id===a()))}),q(()=>(r(g),n()),()=>{b(h,r(g)?n().filter(p=>p.playerId!==r(g).playerId):[])}),q(()=>(i(),Ur),()=>{b(y,i().map(p=>({id:p.id,vertices:Ur(p)})))}),q(()=>(s(),Pr),()=>{b(w,s().map(p=>zn(Pr(p.shape),p.x,p.y,p.rotation)))}),q(()=>(r(g),r(h),r(y),r(w)),()=>{b(M,r(g)&&r(h).length>0?r(h).map(p=>{const T=hi(te(r(g)),te(p),r(y),r(w));return{targetId:p.id,target:p,canSee:T.canSee,firstClearRay:T.firstClearRay,rays:T.rays}}):[])}),nr(),Nt();var pe=dc(),Q=x(m(pe),2),_e=m(Q),me=m(_e);ft(me,{title:"LOS Debug",children:(p,T)=>{var O=Ql(),ke=m(O),fe=m(ke),Ee=x(ke,2);{var Ie=j=>{var I=Gl();let ee;var U=m(I);R((se,ae)=>{ee=At(I,1,"los-status svelte-12aohay",null,ee,se),Me(U,`${ae??""}/${r(M),f(()=>r(M).length)??""} visible`)},[()=>({"can-see":r(M).some(se=>se.canSee),blocked:!r(M).some(se=>se.canSee)}),()=>(r(M),f(()=>r(M).filter(se=>se.canSee).length))]),L(j,I)},k=j=>{var I=Jl();L(j,I)};he(Ee,j=>{r(g),r(M),f(()=>r(g)&&r(M).length>0)?j(Ie):j(k,!1)})}Dn(fe,o,j=>eo(pa,j)),L(p,O)},$$slots:{default:!0}});var Re=x(me,2);ft(Re,{title:"Add Terrain",defaultOpen:!1,children:(p,T)=>{var O=tc();be(O,5,()=>xi,Oe,(ke,fe)=>{var Ee=ec(),Ie=m(Ee);R(()=>Me(Ie,(r(fe),f(()=>r(fe).label)))),Y("click",Ee,()=>_(r(fe).width,r(fe).height)),L(ke,Ee)}),L(p,O)},$$slots:{default:!0}});var Qe=x(Re,2);ft(Qe,{title:"Add Wall",defaultOpen:!1,children:(p,T)=>{var O=nc();be(O,5,()=>Rn,Oe,(ke,fe)=>{var Ee=rc(),Ie=m(Ee);R(()=>Me(Ie,(r(fe),f(()=>r(fe).label)))),Y("click",Ee,()=>E(r(fe).shape)),L(ke,Ee)}),L(p,O)},$$slots:{default:!0}});var Z=x(Qe,2);ft(Z,{title:"Add Models",defaultOpen:!1,children:(p,T)=>{var O=ac(),ke=$e(O),fe=m(ke);let Ee;var Ie=x(fe,2);let k;var j=x(ke,2),I=m(j),ee=x(m(I),2);be(ee,5,()=>(F(kt),f(()=>kt.circles)),Oe,(ae,K)=>{vn(ae,{get baseSize(){return r(K)},get playerId(){return r(A)},onDragStart:le})});var U=x(I,2),se=x(m(U),2);be(se,5,()=>(F(kt),f(()=>kt.ovals)),Oe,(ae,K)=>{vn(ae,{get baseSize(){return r(K)},get playerId(){return r(A)},onDragStart:le})}),R(()=>{Ee=At(fe,1,"toggle-btn svelte-12aohay",null,Ee,{active:r(A)===1}),k=At(Ie,1,"toggle-btn svelte-12aohay",null,k,{active:r(A)===2})}),Y("click",fe,()=>b(A,1)),Y("click",Ie,()=>b(A,2)),L(p,O)},$$slots:{default:!0}});var W=x(_e,2),C=m(W),S=m(C);_n(S,{children:Bn,$$slots:{default:(p,T)=>{const O=Je(()=>T.screenToSvg);var ke=lc(),fe=$e(ke);{var Ee=X=>{var N=oi();R(()=>Me(N,(r(Ne),F(r(O)),f(()=>(b(Ne,r(O)),""))))),L(X,N)};he(fe,X=>{r(O)&&!r(Ne)&&X(Ee)})}var Ie=x(fe);{var k=X=>{var N=st(),ce=$e(N);be(ce,1,()=>r(M),Oe,($,ve)=>{var Xe=st(),je=$e(Xe);be(je,1,()=>(r(ve),f(()=>r(ve).rays)),Oe,(Le,Be)=>{var Te=ic();R(()=>{v(Te,"x1",(r(Be),f(()=>r(Be).from.x))),v(Te,"y1",(r(Be),f(()=>r(Be).from.y))),v(Te,"x2",(r(Be),f(()=>r(Be).to.x))),v(Te,"y2",(r(Be),f(()=>r(Be).to.y))),v(Te,"stroke",(r(Be),f(()=>r(Be).blocked?"#ff000033":"#00ff0033")))}),L(Le,Te)}),L($,Xe)}),L(X,N)};he(Ie,X=>{o(),r(g),r(M),f(()=>o()&&r(g)&&r(M).length>0)&&X(k)})}var j=x(Ie);be(j,1,i,X=>X.id,(X,N)=>{{let ce=Je(()=>(r(N),c(),f(()=>r(N).id===c())));gi(X,{get id(){return r(N),f(()=>r(N).id)},get x(){return r(N),f(()=>r(N).x)},get y(){return r(N),f(()=>r(N).y)},get width(){return r(N),f(()=>r(N).width)},get height(){return r(N),f(()=>r(N).height)},get rotation(){return r(N),f(()=>r(N).rotation)},get selected(){return r(ce)},get screenToSvg(){return r(O)},onSelect:P,onDrag:V,onRotate:we})}});var I=x(j);be(I,1,s,X=>X.id,(X,N)=>{{let ce=Je(()=>(r(N),l(),f(()=>r(N).id===l())));Gn(X,{get id(){return r(N),f(()=>r(N).id)},get x(){return r(N),f(()=>r(N).x)},get y(){return r(N),f(()=>r(N).y)},get shape(){return r(N),f(()=>r(N).shape)},get rotation(){return r(N),f(()=>r(N).rotation)},get selected(){return r(ce)},get screenToSvg(){return r(O)},onSelect:re,onDrag:z,onRotate:De})}});var ee=x(I);be(ee,1,n,X=>X.id,(X,N)=>{{let ce=Je(()=>(r(N),f(()=>r(N).name||""))),$=Je(()=>(r(N),a(),f(()=>r(N).id===a())));fn(X,{get id(){return r(N),f(()=>r(N).id)},get x(){return r(N),f(()=>r(N).x)},get y(){return r(N),f(()=>r(N).y)},get baseType(){return r(N),f(()=>r(N).baseType)},get playerId(){return r(N),f(()=>r(N).playerId)},get rotation(){return r(N),f(()=>r(N).rotation)},get name(){return r(ce)},get selected(){return r($)},get screenToSvg(){return r(O)},onSelect:ge,onDrag:H,onRotate:ue,onRename:B})}});var U=x(ee);{var se=X=>{var N=st(),ce=$e(N);be(ce,1,()=>r(M),Oe,($,ve)=>{var Xe=st(),je=$e(Xe);{var Le=Te=>{var Pe=sc();R(()=>{v(Pe,"x1",(r(ve),f(()=>r(ve).firstClearRay.from.x))),v(Pe,"y1",(r(ve),f(()=>r(ve).firstClearRay.from.y))),v(Pe,"x2",(r(ve),f(()=>r(ve).firstClearRay.to.x))),v(Pe,"y2",(r(ve),f(()=>r(ve).firstClearRay.to.y)))}),L(Te,Pe)},Be=Te=>{var Pe=oc();R(()=>{v(Pe,"x1",(r(g),f(()=>r(g).x))),v(Pe,"y1",(r(g),f(()=>r(g).y))),v(Pe,"x2",(r(ve),f(()=>r(ve).target.x))),v(Pe,"y2",(r(ve),f(()=>r(ve).target.y)))}),L(Te,Pe)};he(je,Te=>{r(ve),f(()=>r(ve).firstClearRay)?Te(Le):Te(Be,!1)})}L($,Xe)}),L(X,N)};he(U,X=>{o(),r(g),r(M),f(()=>o()&&r(g)&&r(M).length>0)&&X(se)})}var ae=x(U);{var K=X=>{fn(X,{id:"phantom",get x(){return r(de),f(()=>r(de).x)},get y(){return r(de),f(()=>r(de).y)},get baseType(){return r(de),f(()=>r(de).baseType)},get playerId(){return r(A)},rotation:0,selected:!1,get screenToSvg(){return r(O)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}})};he(ae,X=>{r(de)&&X(K)})}L(p,ke)}}});var xe=x(C,2),Ue=m(xe),Ke=m(Ue),Ye=x(Ue,2);{var ot=p=>{var T=cc(),O=m(T);R(ke=>Me(O,`Selected model LOS: ${ke??""}/${r(M),f(()=>r(M).length)??""} visible`),[()=>(r(M),f(()=>r(M).filter(ke=>ke.canSee).length))]),L(p,T)};he(Ye,p=>{o(),r(g),r(M),f(()=>o()&&r(g)&&r(M).length>0)&&p(ot)})}R(()=>Me(Ke,`Battlefield: 60" x 44" | ${i(),f(()=>i().length)??""} terrain | ${s(),f(()=>s().length)??""} walls | ${n(),f(()=>n().length)??""} models`)),L(e,pe),Tt(),u()}function fc(e,t){Et(t,!1);let n=D("main");function a(){const l=window.location.hash;l==="#/debug"?b(n,"debug"):l==="#/setup"?b(n,"setup"):l==="#/deployment"?b(n,"deployment"):b(n,"setup")}Ir(()=>(a(),window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a))),Nt();var i=st(),s=$e(i);{var o=l=>{uc(l,{})},c=l=>{var d=st(),u=$e(d);{var g=y=>{bl(y,{})},h=y=>{var w=st(),M=$e(w);{var _=P=>{ql(P,{})},E=P=>{Qo(P,{})};he(M,P=>{r(n)==="deployment"?P(_):P(E,!1)},!0)}L(y,w)};he(u,y=>{r(n)==="setup"?y(g):y(h,!1)},!0)}L(l,d)};he(s,l=>{r(n)==="debug"?l(o):l(c,!1)})}L(e,i),Tt()}js(fc,{target:document.getElementById("app")});
//# sourceMappingURL=index-DDLS-gAh.js.map
