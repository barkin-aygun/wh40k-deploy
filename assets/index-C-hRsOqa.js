(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const Yn=!1;var Jn=Array.isArray,Xi=Array.prototype.indexOf,Dn=Array.from,Ra=Object.defineProperty,Sr=Object.getOwnPropertyDescriptor,Ia=Object.getOwnPropertyDescriptors,Ui=Object.prototype,Ki=Array.prototype,Qn=Object.getPrototypeOf,ha=Object.isExtensible;const yr=()=>{};function Vi(e){return e()}function wn(e){for(var r=0;r<e.length;r++)e[r]()}function Oa(){var e,r,n=new Promise((a,i)=>{e=a,r=i});return{promise:n,resolve:e,reject:r}}const yt=2,Ln=4,cn=8,Na=1<<24,lr=16,cr=32,Dr=64,ea=128,Ot=512,ht=1024,mt=2048,Vt=4096,Pt=8192,ar=16384,ta=32768,jr=65536,ya=1<<17,Wa=1<<18,Kr=1<<19,ja=1<<20,nr=1<<25,Pr=32768,Bn=1<<21,ra=1<<22,gr=1<<23,Mr=Symbol("$state"),Zi=Symbol("legacy props"),zi=Symbol(""),Rr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function na(){throw new Error("https://svelte.dev/e/invalid_default_snippet")}function Ha(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function qi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Gi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Ji(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Qi(e){throw new Error("https://svelte.dev/e/effect_orphan")}function es(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function ts(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function rs(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ns(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function as(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function is(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const ss=1,os=2,Ya=4,ls=8,cs=16,us=2,ds=4,fs=8,Ba=1,vs=2,vt=Symbol(),hs="http://www.w3.org/1999/xhtml";function ys(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Fa(e){return e===this.v}function Xa(e,r){return e!=e?r==r:e!==r||e!==null&&typeof e=="object"||typeof e=="function"}function Ua(e){return!Xa(e,this.v)}let Vr=!1,gs=!1;function ps(){Vr=!0}let Qe=null;function Hr(e){Qe=e}function Ht(e,r=!1,n){Qe={p:Qe,i:!1,c:null,e:null,s:e,x:null,l:Vr&&!r?{s:null,u:null,$:[]}:null}}function Yt(e){var r=Qe,n=r.e;if(n!==null){r.e=null;for(var a of n)ci(a)}return e!==void 0&&(r.x=e),r.i=!0,Qe=r.p,e??{}}function un(){return!Vr||Qe!==null&&Qe.l===null}let Lr=[];function Ka(){var e=Lr;Lr=[],wn(e)}function Zr(e){if(Lr.length===0&&!rn){var r=Lr;queueMicrotask(()=>{r===Lr&&Ka()})}Lr.push(e)}function xs(){for(;Lr.length>0;)Ka()}function Va(e){var r=Be;if(r===null)return Ae.f|=gr,e;if((r.f&ta)===0){if((r.f&ea)===0)throw e;r.b.error(e)}else Yr(e,r)}function Yr(e,r){for(;r!==null;){if((r.f&ea)!==0)try{r.b.error(e);return}catch(n){e=n}r=r.parent}throw e}const _s=-7169;function lt(e,r){e.f=e.f&_s|r}function aa(e){(e.f&Ot)!==0||e.deps===null?lt(e,ht):lt(e,Vt)}function Za(e){if(e!==null)for(const r of e)(r.f&yt)===0||(r.f&Pr)===0||(r.f^=Pr,Za(r.deps))}function za(e,r,n){(e.f&mt)!==0?r.add(e):(e.f&Vt)!==0&&n.add(e),Za(e.deps),lt(e,ht)}const fn=new Set;let Ke=null,mn=null,Nt=null,Rt=[],An=null,Fn=!1,rn=!1;class Xt{committed=!1;current=new Map;previous=new Map;#t=new Set;#s=new Set;#e=0;#a=0;#i=null;#n=new Set;#r=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#a>0}process(r){Rt=[],mn=null,this.apply();var n=[],a=[];for(const i of r)this.#o(i,n,a);this.is_fork||this.#c(),this.is_deferred()?(this.#l(a),this.#l(n)):(mn=this,Ke=null,ga(a),ga(n),mn=null,this.#i?.resolve()),Nt=null}#o(r,n,a){r.f^=ht;for(var i=r.first,s=null;i!==null;){var o=i.f,c=(o&(cr|Dr))!==0,l=c&&(o&ht)!==0,d=l||(o&Pt)!==0||this.skipped_effects.has(i);if(!d&&i.fn!==null){c?i.f^=ht:s!==null&&(o&(Ln|cn|Na))!==0?s.b.defer_effect(i):(o&Ln)!==0?n.push(i):qr(i)&&((o&lr)!==0&&this.#n.add(i),Fr(i));var v=i.first;if(v!==null){i=v;continue}}var g=i.parent;for(i=i.next;i===null&&g!==null;)g===s&&(s=null),i=g.next,g=g.parent}}#l(r){for(var n=0;n<r.length;n+=1)za(r[n],this.#n,this.#r)}capture(r,n){n!==vt&&!this.previous.has(r)&&this.previous.set(r,n),(r.f&gr)===0&&(this.current.set(r,r.v),Nt?.set(r,r.v))}activate(){Ke=this,this.apply()}deactivate(){Ke===this&&(Ke=null,Nt=null)}flush(){if(this.activate(),Rt.length>0){if(qa(),Ke!==null&&Ke!==this)return}else this.#e===0&&this.process([]);this.deactivate()}discard(){for(const r of this.#s)r(this);this.#s.clear()}#c(){if(this.#a===0){for(const r of this.#t)r();this.#t.clear()}this.#e===0&&this.#u()}#u(){if(fn.size>1){this.previous.clear();var r=Nt,n=!0;for(const i of fn){if(i===this){n=!1;continue}const s=[];for(const[c,l]of this.current){if(i.current.has(c))if(n&&l!==i.current.get(c))i.current.set(c,l);else continue;s.push(c)}if(s.length===0)continue;const o=[...i.current.keys()].filter(c=>!this.current.has(c));if(o.length>0){var a=Rt;Rt=[];const c=new Set,l=new Map;for(const d of s)Ga(d,o,c,l);if(Rt.length>0){Ke=i,i.apply();for(const d of Rt)i.#o(d,[],[]);i.deactivate()}Rt=a}}Ke=null,Nt=r}this.committed=!0,fn.delete(this)}increment(r){this.#e+=1,r&&(this.#a+=1)}decrement(r){this.#e-=1,r&&(this.#a-=1),this.revive()}revive(){for(const r of this.#n)this.#r.delete(r),lt(r,mt),or(r);for(const r of this.#r)lt(r,Vt),or(r);this.flush()}oncommit(r){this.#t.add(r)}ondiscard(r){this.#s.add(r)}settled(){return(this.#i??=Oa()).promise}static ensure(){if(Ke===null){const r=Ke=new Xt;fn.add(Ke),rn||Xt.enqueue(()=>{Ke===r&&r.flush()})}return Ke}static enqueue(r){Zr(r)}apply(){}}function ms(e){var r=rn;rn=!0;try{for(var n;;){if(xs(),Rt.length===0&&(Ke?.flush(),Rt.length===0))return An=null,n;qa()}}finally{rn=r}}function qa(){var e=Er;Fn=!0;var r=null;try{var n=0;for(Mn(!0);Rt.length>0;){var a=Xt.ensure();if(n++>1e3){var i,s;bs()}a.process(Rt),pr.clear()}}finally{Fn=!1,Mn(e),An=null}}function bs(){try{es()}catch(e){Yr(e,An)}}let Jt=null;function ga(e){var r=e.length;if(r!==0){for(var n=0;n<r;){var a=e[n++];if((a.f&(ar|Pt))===0&&qr(a)&&(Jt=new Set,Fr(a),a.deps===null&&a.first===null&&a.nodes===null&&(a.teardown===null&&a.ac===null?fi(a):a.fn=null),Jt?.size>0)){pr.clear();for(const i of Jt){if((i.f&(ar|Pt))!==0)continue;const s=[i];let o=i.parent;for(;o!==null;)Jt.has(o)&&(Jt.delete(o),s.push(o)),o=o.parent;for(let c=s.length-1;c>=0;c--){const l=s[c];(l.f&(ar|Pt))===0&&Fr(l)}}Jt.clear()}}Jt=null}}function Ga(e,r,n,a){if(!n.has(e)&&(n.add(e),e.reactions!==null))for(const i of e.reactions){const s=i.f;(s&yt)!==0?Ga(i,r,n,a):(s&(ra|lr))!==0&&(s&mt)===0&&Ja(i,r,a)&&(lt(i,mt),or(i))}}function Ja(e,r,n){const a=n.get(e);if(a!==void 0)return a;if(e.deps!==null)for(const i of e.deps){if(r.includes(i))return!0;if((i.f&yt)!==0&&Ja(i,r,n))return n.set(i,!0),!0}return n.set(e,!1),!1}function or(e){for(var r=An=e;r.parent!==null;){r=r.parent;var n=r.f;if(Fn&&r===Be&&(n&lr)!==0&&(n&Wa)===0)return;if((n&(Dr|cr))!==0){if((n&ht)===0)return;r.f^=ht}}Rt.push(r)}function ws(e){let r=0,n=$r(0),a;return()=>{oa()&&(t(n),zr(()=>(r===0&&(a=u(()=>e(()=>nn(n)))),r+=1,()=>{Zr(()=>{r-=1,r===0&&(a?.(),a=void 0,nn(n))})})))}}var Ls=jr|Kr|ea;function Ss(e,r,n){new Ms(e,r,n)}class Ms{parent;is_pending=!1;#t;#s=null;#e;#a;#i;#n=null;#r=null;#o=null;#l=null;#c=null;#u=0;#d=0;#v=!1;#h=new Set;#y=new Set;#f=null;#m=ws(()=>(this.#f=$r(this.#u),()=>{this.#f=null}));constructor(r,n,a){this.#t=r,this.#e=n,this.#a=a,this.parent=Be.b,this.is_pending=!!this.#e.pending,this.#i=la(()=>{Be.b=this;{var i=this.#x();try{this.#n=It(()=>a(i))}catch(s){this.error(s)}this.#d>0?this.#p():this.is_pending=!1}return()=>{this.#c?.remove()}},Ls)}#b(){try{this.#n=It(()=>this.#a(this.#t))}catch(r){this.error(r)}}#w(){const r=this.#e.pending;r&&(this.#r=It(()=>r(this.#t)),Xt.enqueue(()=>{var n=this.#x();this.#n=this.#g(()=>(Xt.ensure(),It(()=>this.#a(n)))),this.#d>0?this.#p():(kr(this.#r,()=>{this.#r=null}),this.is_pending=!1)}))}#x(){var r=this.#t;return this.is_pending&&(this.#c=ir(),this.#t.before(this.#c),r=this.#c),r}defer_effect(r){za(r,this.#h,this.#y)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#e.pending}#g(r){var n=Be,a=Ae,i=Qe;Kt(this.#i),wt(this.#i),Hr(this.#i.ctx);try{return r()}catch(s){return Va(s),null}finally{Kt(n),wt(a),Hr(i)}}#p(){const r=this.#e.pending;this.#n!==null&&(this.#l=document.createDocumentFragment(),this.#l.append(this.#c),yi(this.#n,this.#l)),this.#r===null&&(this.#r=It(()=>r(this.#t)))}#_(r){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(r);return}if(this.#d+=r,this.#d===0){this.is_pending=!1;for(const n of this.#h)lt(n,mt),or(n);for(const n of this.#y)lt(n,Vt),or(n);this.#h.clear(),this.#y.clear(),this.#r&&kr(this.#r,()=>{this.#r=null}),this.#l&&(this.#t.before(this.#l),this.#l=null)}}update_pending_count(r){this.#_(r),this.#u+=r,this.#f&&Br(this.#f,this.#u)}get_effect_pending(){return this.#m(),t(this.#f)}error(r){var n=this.#e.onerror;let a=this.#e.failed;if(this.#v||!n&&!a)throw r;this.#n&&(Lt(this.#n),this.#n=null),this.#r&&(Lt(this.#r),this.#r=null),this.#o&&(Lt(this.#o),this.#o=null);var i=!1,s=!1;const o=()=>{if(i){ys();return}i=!0,s&&is(),Xt.ensure(),this.#u=0,this.#o!==null&&kr(this.#o,()=>{this.#o=null}),this.is_pending=this.has_pending_snippet(),this.#n=this.#g(()=>(this.#v=!1,It(()=>this.#a(this.#t)))),this.#d>0?this.#p():this.is_pending=!1};var c=Ae;try{wt(null),s=!0,n?.(r,o),s=!1}catch(l){Yr(l,this.#i&&this.#i.parent)}finally{wt(c)}a&&Zr(()=>{this.#o=this.#g(()=>{Xt.ensure(),this.#v=!0;try{return It(()=>{a(this.#t,()=>r,()=>o)})}catch(l){return Yr(l,this.#i.parent),null}finally{this.#v=!1}})})}}function ks(e,r,n,a){const i=un()?ia:Ve;if(n.length===0&&e.length===0){a(r.map(i));return}var s=Ke,o=Be,c=Es();function l(){Promise.all(n.map(d=>Ts(d))).then(d=>{c();try{a([...r.map(i),...d])}catch(v){(o.f&ar)===0&&Yr(v,o)}s?.deactivate(),Sn()}).catch(d=>{Yr(d,o)})}e.length>0?Promise.all(e).then(()=>{c();try{return l()}finally{s?.deactivate(),Sn()}}):l()}function Es(){var e=Be,r=Ae,n=Qe,a=Ke;return function(s=!0){Kt(e),wt(r),Hr(n),s&&a?.activate()}}function Sn(){Kt(null),wt(null),Hr(null)}function ia(e){var r=yt|mt,n=Ae!==null&&(Ae.f&yt)!==0?Ae:null;return Be!==null&&(Be.f|=Kr),{ctx:Qe,deps:null,effects:null,equals:Fa,f:r,fn:e,reactions:null,rv:0,v:vt,wv:0,parent:n??Be,ac:null}}function Ts(e,r,n){let a=Be;a===null&&qi();var i=a.b,s=void 0,o=$r(vt),c=!Ae,l=new Map;return Ws(()=>{var d=Oa();s=d.promise;try{Promise.resolve(e()).then(d.resolve,d.reject).then(()=>{v===Ke&&v.committed&&v.deactivate(),Sn()})}catch(y){d.reject(y),Sn()}var v=Ke;if(c){var g=i.is_rendered();i.update_pending_count(1),v.increment(g),l.get(v)?.reject(Rr),l.delete(v),l.set(v,d)}const h=(y,S=void 0)=>{if(v.activate(),S)S!==Rr&&(o.f|=gr,Br(o,S));else{(o.f&gr)!==0&&(o.f^=gr),Br(o,y);for(const[P,m]of l){if(l.delete(P),P===v)break;m.reject(Rr)}}c&&(i.update_pending_count(-1),v.decrement(g))};d.promise.then(h,y=>h(null,y||"unknown"))}),Rn(()=>{for(const d of l.values())d.reject(Rr)}),new Promise(d=>{function v(g){function h(){g===s?d(o):v(s)}g.then(h,h)}v(s)})}function Ve(e){const r=ia(e);return r.equals=Ua,r}function Qa(e){var r=e.effects;if(r!==null){e.effects=null;for(var n=0;n<r.length;n+=1)Lt(r[n])}}function Ps(e){for(var r=e.parent;r!==null;){if((r.f&yt)===0)return(r.f&ar)===0?r:null;r=r.parent}return null}function sa(e){var r,n=Be;Kt(Ps(e));try{e.f&=~Pr,Qa(e),r=_i(e)}finally{Kt(n)}return r}function ei(e){var r=sa(e);if(!e.equals(r)&&(e.wv=pi(),(!Ke?.is_fork||e.deps===null)&&(e.v=r,e.deps===null))){lt(e,ht);return}xr||(Nt!==null?(oa()||Ke?.is_fork)&&Nt.set(e,r):aa(e))}let Xn=new Set;const pr=new Map;let ti=!1;function $r(e,r){var n={f:0,v:e,reactions:null,equals:Fa,rv:0,wv:0};return n}function dr(e,r){const n=$r(e);return Ys(n),n}function $(e,r=!1,n=!0){const a=$r(e);return r||(a.equals=Ua),Vr&&n&&Qe!==null&&Qe.l!==null&&(Qe.l.s??=[]).push(a),a}function b(e,r,n=!1){Ae!==null&&(!Wt||(Ae.f&ya)!==0)&&un()&&(Ae.f&(yt|lr|ra|ya))!==0&&!sr?.includes(e)&&as();let a=n?Ir(r):r;return Br(e,a)}function Br(e,r){if(!e.equals(r)){var n=e.v;xr?pr.set(e,r):pr.set(e,n),e.v=r;var a=Xt.ensure();if(a.capture(e,n),(e.f&yt)!==0){const i=e;(e.f&mt)!==0&&sa(i),aa(i)}e.wv=pi(),ri(e,mt),un()&&Be!==null&&(Be.f&ht)!==0&&(Be.f&(cr|Dr))===0&&(Ct===null?Bs([e]):Ct.push(e)),!a.is_fork&&Xn.size>0&&!ti&&$s()}return r}function $s(){ti=!1;var e=Er;Mn(!0);const r=Array.from(Xn);try{for(const n of r)(n.f&ht)!==0&&lt(n,Vt),qr(n)&&Fr(n)}finally{Mn(e)}Xn.clear()}function nn(e){b(e,e.v+1)}function ri(e,r){var n=e.reactions;if(n!==null)for(var a=un(),i=n.length,s=0;s<i;s++){var o=n[s],c=o.f;if(!(!a&&o===Be)){var l=(c&mt)===0;if(l&&lt(o,r),(c&yt)!==0){var d=o;Nt?.delete(d),(c&Pr)===0&&(c&Ot&&(o.f|=Pr),ri(d,Vt))}else l&&((c&lr)!==0&&Jt!==null&&Jt.add(o),or(o))}}}function Ir(e){if(typeof e!="object"||e===null||Mr in e)return e;const r=Qn(e);if(r!==Ui&&r!==Ki)return e;var n=new Map,a=Jn(e),i=dr(0),s=Tr,o=c=>{if(Tr===s)return c();var l=Ae,d=Tr;wt(null),_a(s);var v=c();return wt(l),_a(d),v};return a&&n.set("length",dr(e.length)),new Proxy(e,{defineProperty(c,l,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&rs();var v=n.get(l);return v===void 0?v=o(()=>{var g=dr(d.value);return n.set(l,g),g}):b(v,d.value,!0),!0},deleteProperty(c,l){var d=n.get(l);if(d===void 0){if(l in c){const v=o(()=>dr(vt));n.set(l,v),nn(i)}}else b(d,vt),nn(i);return!0},get(c,l,d){if(l===Mr)return e;var v=n.get(l),g=l in c;if(v===void 0&&(!g||Sr(c,l)?.writable)&&(v=o(()=>{var y=Ir(g?c[l]:vt),S=dr(y);return S}),n.set(l,v)),v!==void 0){var h=t(v);return h===vt?void 0:h}return Reflect.get(c,l,d)},getOwnPropertyDescriptor(c,l){var d=Reflect.getOwnPropertyDescriptor(c,l);if(d&&"value"in d){var v=n.get(l);v&&(d.value=t(v))}else if(d===void 0){var g=n.get(l),h=g?.v;if(g!==void 0&&h!==vt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return d},has(c,l){if(l===Mr)return!0;var d=n.get(l),v=d!==void 0&&d.v!==vt||Reflect.has(c,l);if(d!==void 0||Be!==null&&(!v||Sr(c,l)?.writable)){d===void 0&&(d=o(()=>{var h=v?Ir(c[l]):vt,y=dr(h);return y}),n.set(l,d));var g=t(d);if(g===vt)return!1}return v},set(c,l,d,v){var g=n.get(l),h=l in c;if(a&&l==="length")for(var y=d;y<g.v;y+=1){var S=n.get(y+"");S!==void 0?b(S,vt):y in c&&(S=o(()=>dr(vt)),n.set(y+"",S))}if(g===void 0)(!h||Sr(c,l)?.writable)&&(g=o(()=>dr(void 0)),b(g,Ir(d)),n.set(l,g));else{h=g.v!==vt;var P=o(()=>Ir(d));b(g,P)}var m=Reflect.getOwnPropertyDescriptor(c,l);if(m?.set&&m.set.call(v,d),!h){if(a&&typeof l=="string"){var L=n.get("length"),M=Number(l);Number.isInteger(M)&&M>=L.v&&b(L,M+1)}nn(i)}return!0},ownKeys(c){t(i);var l=Reflect.ownKeys(c).filter(g=>{var h=n.get(g);return h===void 0||h.v!==vt});for(var[d,v]of n)v.v!==vt&&!(d in c)&&l.push(d);return l},setPrototypeOf(){ns()}})}var Or,ni,ai,ii;function Ds(){if(Or===void 0){Or=window,ni=/Firefox/.test(navigator.userAgent);var e=Element.prototype,r=Node.prototype,n=Text.prototype;ai=Sr(r,"firstChild").get,ii=Sr(r,"nextSibling").get,ha(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),ha(n)&&(n.__t=void 0)}}function ir(e=""){return document.createTextNode(e)}function tr(e){return ai.call(e)}function dn(e){return ii.call(e)}function x(e,r){return tr(e)}function _e(e,r=!1){{var n=tr(e);return n instanceof Comment&&n.data===""?dn(n):n}}function p(e,r=1,n=!1){let a=e;for(;r--;)a=dn(a);return a}function As(e){e.textContent=""}function si(){return!1}let pa=!1;function Cs(){pa||(pa=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const r of e.target.elements)r.__on_r?.()})},{capture:!0}))}function Cn(e){var r=Ae,n=Be;wt(null),Kt(null);try{return e()}finally{wt(r),Kt(n)}}function oi(e,r,n,a=n){e.addEventListener(r,()=>Cn(n));const i=e.__on_r;i?e.__on_r=()=>{i(),a(!0)}:e.__on_r=()=>a(!0),Cs()}function li(e){Be===null&&(Ae===null&&Qi(),Ji()),xr&&Gi()}function Rs(e,r){var n=r.last;n===null?r.last=r.first=e:(n.next=e,e.prev=n,r.last=e)}function Zt(e,r,n){var a=Be;a!==null&&(a.f&Pt)!==0&&(e|=Pt);var i={ctx:Qe,deps:null,nodes:null,f:e|mt|Ot,first:null,fn:r,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,wv:0,ac:null};if(n)try{Fr(i),i.f|=ta}catch(c){throw Lt(i),c}else r!==null&&or(i);var s=i;if(n&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&Kr)===0&&(s=s.first,(e&lr)!==0&&(e&jr)!==0&&s!==null&&(s.f|=jr)),s!==null&&(s.parent=a,a!==null&&Rs(s,a),Ae!==null&&(Ae.f&yt)!==0&&(e&Dr)===0)){var o=Ae;(o.effects??=[]).push(s)}return i}function oa(){return Ae!==null&&!Wt}function Rn(e){const r=Zt(cn,null,!1);return lt(r,ht),r.teardown=e,r}function Un(e){li();var r=Be.f,n=!Ae&&(r&cr)!==0&&(r&ta)===0;if(n){var a=Qe;(a.e??=[]).push(e)}else return ci(e)}function ci(e){return Zt(Ln|ja,e,!1)}function Is(e){return li(),Zt(cn|ja,e,!0)}function Os(e){Xt.ensure();const r=Zt(Dr|Kr,e,!0);return(n={})=>new Promise(a=>{n.outro?kr(r,()=>{Lt(r),a(void 0)}):(Lt(r),a(void 0))})}function Ns(e){return Zt(Ln,e,!1)}function G(e,r){var n=Qe,a={effect:null,ran:!1,deps:e};n.l.$.push(a),a.effect=zr(()=>{e(),!a.ran&&(a.ran=!0,u(r))})}function _r(){var e=Qe;zr(()=>{for(var r of e.l.$){r.deps();var n=r.effect;(n.f&ht)!==0&&n.deps!==null&&lt(n,Vt),qr(n)&&Fr(n),r.ran=!1}})}function Ws(e){return Zt(ra|Kr,e,!0)}function zr(e,r=0){return Zt(cn|r,e,!0)}function I(e,r=[],n=[],a=[]){ks(a,r,n,i=>{Zt(cn,()=>e(...i.map(t)),!0)})}function la(e,r=0){var n=Zt(lr|r,e,!0);return n}function It(e){return Zt(cr|Kr,e,!0)}function ui(e){var r=e.teardown;if(r!==null){const n=xr,a=Ae;xa(!0),wt(null);try{r.call(null)}finally{xa(n),wt(a)}}}function di(e,r=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const i=n.ac;i!==null&&Cn(()=>{i.abort(Rr)});var a=n.next;(n.f&Dr)!==0?n.parent=null:Lt(n,r),n=a}}function js(e){for(var r=e.first;r!==null;){var n=r.next;(r.f&cr)===0&&Lt(r),r=n}}function Lt(e,r=!0){var n=!1;(r||(e.f&Wa)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(Hs(e.nodes.start,e.nodes.end),n=!0),di(e,r&&!n),kn(e,0),lt(e,ar);var a=e.nodes&&e.nodes.t;if(a!==null)for(const s of a)s.stop();ui(e);var i=e.parent;i!==null&&i.first!==null&&fi(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function Hs(e,r){for(;e!==null;){var n=e===r?null:dn(e);e.remove(),e=n}}function fi(e){var r=e.parent,n=e.prev,a=e.next;n!==null&&(n.next=a),a!==null&&(a.prev=n),r!==null&&(r.first===e&&(r.first=a),r.last===e&&(r.last=n))}function kr(e,r,n=!0){var a=[];vi(e,a,!0);var i=()=>{n&&Lt(e),r&&r()},s=a.length;if(s>0){var o=()=>--s||i();for(var c of a)c.out(o)}else i()}function vi(e,r,n){if((e.f&Pt)===0){e.f^=Pt;var a=e.nodes&&e.nodes.t;if(a!==null)for(const c of a)(c.is_global||n)&&r.push(c);for(var i=e.first;i!==null;){var s=i.next,o=(i.f&jr)!==0||(i.f&cr)!==0&&(e.f&lr)!==0;vi(i,r,o?n:!1),i=s}}}function ca(e){hi(e,!0)}function hi(e,r){if((e.f&Pt)!==0){e.f^=Pt,(e.f&ht)===0&&(lt(e,mt),or(e));for(var n=e.first;n!==null;){var a=n.next,i=(n.f&jr)!==0||(n.f&cr)!==0;hi(n,i?r:!1),n=a}var s=e.nodes&&e.nodes.t;if(s!==null)for(const o of s)(o.is_global||r)&&o.in()}}function yi(e,r){if(e.nodes)for(var n=e.nodes.start,a=e.nodes.end;n!==null;){var i=n===a?null:dn(n);r.append(n),n=i}}let Er=!1;function Mn(e){Er=e}let xr=!1;function xa(e){xr=e}let Ae=null,Wt=!1;function wt(e){Ae=e}let Be=null;function Kt(e){Be=e}let sr=null;function Ys(e){Ae!==null&&(sr===null?sr=[e]:sr.push(e))}let _t=null,Et=0,Ct=null;function Bs(e){Ct=e}let gi=1,on=0,Tr=on;function _a(e){Tr=e}function pi(){return++gi}function qr(e){var r=e.f;if((r&mt)!==0)return!0;if(r&yt&&(e.f&=~Pr),(r&Vt)!==0){for(var n=e.deps,a=n.length,i=0;i<a;i++){var s=n[i];if(qr(s)&&ei(s),s.wv>e.wv)return!0}(r&Ot)!==0&&Nt===null&&lt(e,ht)}return!1}function xi(e,r,n=!0){var a=e.reactions;if(a!==null&&!sr?.includes(e))for(var i=0;i<a.length;i++){var s=a[i];(s.f&yt)!==0?xi(s,r,!1):r===s&&(n?lt(s,mt):(s.f&ht)!==0&&lt(s,Vt),or(s))}}function _i(e){var r=_t,n=Et,a=Ct,i=Ae,s=sr,o=Qe,c=Wt,l=Tr,d=e.f;_t=null,Et=0,Ct=null,Ae=(d&(cr|Dr))===0?e:null,sr=null,Hr(e.ctx),Wt=!1,Tr=++on,e.ac!==null&&(Cn(()=>{e.ac.abort(Rr)}),e.ac=null);try{e.f|=Bn;var v=e.fn,g=v(),h=e.deps;if(_t!==null){var y;if(kn(e,Et),h!==null&&Et>0)for(h.length=Et+_t.length,y=0;y<_t.length;y++)h[Et+y]=_t[y];else e.deps=h=_t;if(oa()&&(e.f&Ot)!==0)for(y=Et;y<h.length;y++)(h[y].reactions??=[]).push(e)}else h!==null&&Et<h.length&&(kn(e,Et),h.length=Et);if(un()&&Ct!==null&&!Wt&&h!==null&&(e.f&(yt|Vt|mt))===0)for(y=0;y<Ct.length;y++)xi(Ct[y],e);return i!==null&&i!==e&&(on++,Ct!==null&&(a===null?a=Ct:a.push(...Ct))),(e.f&gr)!==0&&(e.f^=gr),g}catch(S){return Va(S)}finally{e.f^=Bn,_t=r,Et=n,Ct=a,Ae=i,sr=s,Hr(o),Wt=c,Tr=l}}function Fs(e,r){let n=r.reactions;if(n!==null){var a=Xi.call(n,e);if(a!==-1){var i=n.length-1;i===0?n=r.reactions=null:(n[a]=n[i],n.pop())}}if(n===null&&(r.f&yt)!==0&&(_t===null||!_t.includes(r))){var s=r;(s.f&Ot)!==0&&(s.f^=Ot,s.f&=~Pr),aa(s),Qa(s),kn(s,0)}}function kn(e,r){var n=e.deps;if(n!==null)for(var a=r;a<n.length;a++)Fs(e,n[a])}function Fr(e){var r=e.f;if((r&ar)===0){lt(e,ht);var n=Be,a=Er;Be=e,Er=!0;try{(r&(lr|Na))!==0?js(e):di(e),ui(e);var i=_i(e);e.teardown=typeof i=="function"?i:null,e.wv=gi;var s;Yn&&gs&&(e.f&mt)!==0&&e.deps}finally{Er=a,Be=n}}}async function Xs(){await Promise.resolve(),ms()}function t(e){var r=e.f,n=(r&yt)!==0;if(Ae!==null&&!Wt){var a=Be!==null&&(Be.f&ar)!==0;if(!a&&!sr?.includes(e)){var i=Ae.deps;if((Ae.f&Bn)!==0)e.rv<on&&(e.rv=on,_t===null&&i!==null&&i[Et]===e?Et++:_t===null?_t=[e]:_t.includes(e)||_t.push(e));else{(Ae.deps??=[]).push(e);var s=e.reactions;s===null?e.reactions=[Ae]:s.includes(Ae)||s.push(Ae)}}}if(xr&&pr.has(e))return pr.get(e);if(n){var o=e;if(xr){var c=o.v;return((o.f&ht)===0&&o.reactions!==null||bi(o))&&(c=sa(o)),pr.set(o,c),c}var l=(o.f&Ot)===0&&!Wt&&Ae!==null&&(Er||(Ae.f&Ot)!==0),d=o.deps===null;qr(o)&&(l&&(o.f|=Ot),ei(o)),l&&!d&&mi(o)}if(Nt?.has(e))return Nt.get(e);if((e.f&gr)!==0)throw e.v;return e.v}function mi(e){if(e.deps!==null){e.f|=Ot;for(const r of e.deps)(r.reactions??=[]).push(e),(r.f&yt)!==0&&(r.f&Ot)===0&&mi(r)}}function bi(e){if(e.v===vt)return!0;if(e.deps===null)return!1;for(const r of e.deps)if(pr.has(r)||(r.f&yt)!==0&&bi(r))return!0;return!1}function u(e){var r=Wt;try{return Wt=!0,e()}finally{Wt=r}}function R(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Mr in e)Kn(e);else if(!Array.isArray(e))for(let r in e){const n=e[r];typeof n=="object"&&n&&Mr in n&&Kn(n)}}}function Kn(e,r=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!r.has(e)){r.add(e),e instanceof Date&&e.getTime();for(let a in e)try{Kn(e[a],r)}catch{}const n=Qn(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const a=Ia(n);for(let i in a){const s=a[i].get;if(s)try{s.call(e)}catch{}}}}}const Us=["touchstart","touchmove"];function Ks(e){return Us.includes(e)}const Vs=new Set,ma=new Set;function Zs(e,r,n,a={}){function i(s){if(a.capture||Jr.call(r,s),!s.cancelBubble)return Cn(()=>n?.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Zr(()=>{r.addEventListener(e,i,a)}):r.addEventListener(e,i,a),i}function F(e,r,n,a,i){var s={capture:a,passive:i},o=Zs(e,r,n,s);(r===document.body||r===window||r===document||r instanceof HTMLMediaElement)&&Rn(()=>{r.removeEventListener(e,o,s)})}let ba=null;function Jr(e){var r=this,n=r.ownerDocument,a=e.type,i=e.composedPath?.()||[],s=i[0]||e.target;ba=e;var o=0,c=ba===e&&e.__root;if(c){var l=i.indexOf(c);if(l!==-1&&(r===document||r===window)){e.__root=r;return}var d=i.indexOf(r);if(d===-1)return;l<=d&&(o=l)}if(s=i[o]||e.target,s!==r){Ra(e,"currentTarget",{configurable:!0,get(){return s||n}});var v=Ae,g=Be;wt(null),Kt(null);try{for(var h,y=[];s!==null;){var S=s.assignedSlot||s.parentNode||s.host||null;try{var P=s["__"+a];P!=null&&(!s.disabled||e.target===s)&&P.call(s,e)}catch(m){h?y.push(m):h=m}if(e.cancelBubble||S===r||S===null)break;s=S}if(h){for(let m of y)queueMicrotask(()=>{throw m});throw h}}finally{e.__root=r,delete e.currentTarget,wt(v),Kt(g)}}}function wi(e){var r=document.createElement("template");return r.innerHTML=e.replaceAll("<!>","<!---->"),r.content}function Xr(e,r){var n=Be;n.nodes===null&&(n.nodes={start:e,end:r,a:null,t:null})}function se(e,r){var n=(r&Ba)!==0,a=(r&vs)!==0,i,s=!e.startsWith("<!>");return()=>{i===void 0&&(i=wi(s?e:"<!>"+e),n||(i=tr(i)));var o=a||ni?document.importNode(i,!0):i.cloneNode(!0);if(n){var c=tr(o),l=o.lastChild;Xr(c,l)}else Xr(o,o);return o}}function zs(e,r,n="svg"){var a=!e.startsWith("<!>"),i=(r&Ba)!==0,s=`<${n}>${a?e:"<!>"+e}</${n}>`,o;return()=>{if(!o){var c=wi(s),l=tr(c);if(i)for(o=document.createDocumentFragment();tr(l);)o.appendChild(tr(l));else o=tr(l)}var d=o.cloneNode(!0);if(i){var v=tr(d),g=d.lastChild;Xr(v,g)}else Xr(d,d);return d}}function le(e,r){return zs(e,r,"svg")}function Li(e=""){{var r=ir(e+"");return Xr(r,r),r}}function et(){var e=document.createDocumentFragment(),r=document.createComment(""),n=ir();return e.append(r,n),Xr(r,n),e}function w(e,r){e!==null&&e.before(r)}function Ee(e,r){var n=r==null?"":typeof r=="object"?r+"":r;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function qs(e,r){return Gs(e,r)}const Ar=new Map;function Gs(e,{target:r,anchor:n,props:a={},events:i,context:s,intro:o=!0}){Ds();var c=new Set,l=g=>{for(var h=0;h<g.length;h++){var y=g[h];if(!c.has(y)){c.add(y);var S=Ks(y);r.addEventListener(y,Jr,{passive:S});var P=Ar.get(y);P===void 0?(document.addEventListener(y,Jr,{passive:S}),Ar.set(y,1)):Ar.set(y,P+1)}}};l(Dn(Vs)),ma.add(l);var d=void 0,v=Os(()=>{var g=n??r.appendChild(ir());return Ss(g,{pending:()=>{}},h=>{if(s){Ht({});var y=Qe;y.c=s}i&&(a.$$events=i),d=e(h,a)||{},s&&Yt()}),()=>{for(var h of c){r.removeEventListener(h,Jr);var y=Ar.get(h);--y===0?(document.removeEventListener(h,Jr),Ar.delete(h)):Ar.set(h,y)}ma.delete(l),g!==n&&g.parentNode?.removeChild(g)}});return Js.set(d,v),d}let Js=new WeakMap;class Qs{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#i=!0;constructor(r,n=!0){this.anchor=r,this.#i=n}#n=()=>{var r=Ke;if(this.#t.has(r)){var n=this.#t.get(r),a=this.#s.get(n);if(a)ca(a),this.#a.delete(n);else{var i=this.#e.get(n);i&&(this.#s.set(n,i.effect),this.#e.delete(n),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),a=i.effect)}for(const[s,o]of this.#t){if(this.#t.delete(s),s===r)break;const c=this.#e.get(o);c&&(Lt(c.effect),this.#e.delete(o))}for(const[s,o]of this.#s){if(s===n||this.#a.has(s))continue;const c=()=>{if(Array.from(this.#t.values()).includes(s)){var d=document.createDocumentFragment();yi(o,d),d.append(ir()),this.#e.set(s,{effect:o,fragment:d})}else Lt(o);this.#a.delete(s),this.#s.delete(s)};this.#i||!a?(this.#a.add(s),kr(o,c,!1)):c()}}};#r=r=>{this.#t.delete(r);const n=Array.from(this.#t.values());for(const[a,i]of this.#e)n.includes(a)||(Lt(i.effect),this.#e.delete(a))};ensure(r,n){var a=Ke,i=si();if(n&&!this.#s.has(r)&&!this.#e.has(r))if(i){var s=document.createDocumentFragment(),o=ir();s.append(o),this.#e.set(r,{effect:It(()=>n(o)),fragment:s})}else this.#s.set(r,It(()=>n(this.anchor)));if(this.#t.set(a,r),i){for(const[c,l]of this.#s)c===r?a.skipped_effects.delete(l):a.skipped_effects.add(l);for(const[c,l]of this.#e)c===r?a.skipped_effects.delete(l.effect):a.skipped_effects.add(l.effect);a.oncommit(this.#n),a.ondiscard(this.#r)}else this.#n()}}function oe(e,r,n=!1){var a=new Qs(e),i=n?jr:0;function s(o,c){a.ensure(o,c)}la(()=>{var o=!1;r((c,l=!0)=>{o=!0,s(l,c)}),o||s(!1,null)},i)}function Ie(e,r){return r}function eo(e,r,n){for(var a=[],i=r.length,s,o=r.length,c=0;c<i;c++){let g=r[c];kr(g,()=>{if(s){if(s.pending.delete(g),s.done.add(g),s.pending.size===0){var h=e.outrogroups;Vn(Dn(s.done)),h.delete(s),h.size===0&&(e.outrogroups=null)}}else o-=1},!1)}if(o===0){var l=a.length===0&&n!==null;if(l){var d=n,v=d.parentNode;As(v),v.append(d),e.items.clear()}Vn(r,!l)}else s={pending:new Set(r),done:new Set},(e.outrogroups??=new Set).add(s)}function Vn(e,r=!0){for(var n=0;n<e.length;n++)Lt(e[n],r)}var wa;function me(e,r,n,a,i,s=null){var o=e,c=new Map,l=(r&Ya)!==0;if(l){var d=e;o=d.appendChild(ir())}var v=null,g=Ve(()=>{var L=n();return Jn(L)?L:L==null?[]:Dn(L)}),h,y=!0;function S(){m.fallback=v,to(m,h,o,r,a),v!==null&&(h.length===0?(v.f&nr)===0?ca(v):(v.f^=nr,Qr(v,null,o)):kr(v,()=>{v=null}))}var P=la(()=>{h=t(g);for(var L=h.length,M=new Set,z=Ke,q=si(),J=0;J<L;J+=1){var ye=h[J],be=a(ye,J),C=y?null:c.get(be);C?(C.v&&Br(C.v,ye),C.i&&Br(C.i,J),q&&z.skipped_effects.delete(C.e)):(C=ro(c,y?o:wa??=ir(),ye,be,J,i,r,n),y||(C.e.f|=nr),c.set(be,C)),M.add(be)}if(L===0&&s&&!v&&(y?v=It(()=>s(o)):(v=It(()=>s(wa??=ir())),v.f|=nr)),!y)if(q){for(const[de,ee]of c)M.has(de)||z.skipped_effects.add(ee.e);z.oncommit(S),z.ondiscard(()=>{})}else S();t(g)}),m={effect:P,items:c,outrogroups:null,fallback:v};y=!1}function to(e,r,n,a,i){var s=(a&ls)!==0,o=r.length,c=e.items,l=e.effect.first,d,v=null,g,h=[],y=[],S,P,m,L;if(s)for(L=0;L<o;L+=1)S=r[L],P=i(S,L),m=c.get(P).e,(m.f&nr)===0&&(m.nodes?.a?.measure(),(g??=new Set).add(m));for(L=0;L<o;L+=1){if(S=r[L],P=i(S,L),m=c.get(P).e,e.outrogroups!==null)for(const ee of e.outrogroups)ee.pending.delete(m),ee.done.delete(m);if((m.f&nr)!==0)if(m.f^=nr,m===l)Qr(m,null,n);else{var M=v?v.next:l;m===e.effect.last&&(e.effect.last=m.prev),m.prev&&(m.prev.next=m.next),m.next&&(m.next.prev=m.prev),fr(e,v,m),fr(e,m,M),Qr(m,M,n),v=m,h=[],y=[],l=v.next;continue}if((m.f&Pt)!==0&&(ca(m),s&&(m.nodes?.a?.unfix(),(g??=new Set).delete(m))),m!==l){if(d!==void 0&&d.has(m)){if(h.length<y.length){var z=y[0],q;v=z.prev;var J=h[0],ye=h[h.length-1];for(q=0;q<h.length;q+=1)Qr(h[q],z,n);for(q=0;q<y.length;q+=1)d.delete(y[q]);fr(e,J.prev,ye.next),fr(e,v,J),fr(e,ye,z),l=z,v=ye,L-=1,h=[],y=[]}else d.delete(m),Qr(m,l,n),fr(e,m.prev,m.next),fr(e,m,v===null?e.effect.first:v.next),fr(e,v,m),v=m;continue}for(h=[],y=[];l!==null&&l!==m;)(d??=new Set).add(l),y.push(l),l=l.next;if(l===null)continue}(m.f&nr)===0&&h.push(m),v=m,l=m.next}if(e.outrogroups!==null){for(const ee of e.outrogroups)ee.pending.size===0&&(Vn(Dn(ee.done)),e.outrogroups?.delete(ee));e.outrogroups.size===0&&(e.outrogroups=null)}if(l!==null||d!==void 0){var be=[];if(d!==void 0)for(m of d)(m.f&Pt)===0&&be.push(m);for(;l!==null;)(l.f&Pt)===0&&l!==e.fallback&&be.push(l),l=l.next;var C=be.length;if(C>0){var de=(a&Ya)!==0&&o===0?n:null;if(s){for(L=0;L<C;L+=1)be[L].nodes?.a?.measure();for(L=0;L<C;L+=1)be[L].nodes?.a?.fix()}eo(e,be,de)}}s&&Zr(()=>{if(g!==void 0)for(m of g)m.nodes?.a?.apply()})}function ro(e,r,n,a,i,s,o,c){var l=(o&ss)!==0?(o&cs)===0?$(n,!1,!1):$r(n):null,d=(o&os)!==0?$r(i):null;return{v:l,i:d,e:It(()=>(s(r,l??n,d??i,c),()=>{e.delete(a)}))}}function Qr(e,r,n){if(e.nodes)for(var a=e.nodes.start,i=e.nodes.end,s=r&&(r.f&nr)===0?r.nodes.start:n;a!==null;){var o=dn(a);if(s.before(a),a===i)return;a=o}}function fr(e,r,n){r===null?e.effect.first=n:r.next=n,n===null?e.effect.last=r:n.prev=r}function Si(e,r,n,a,i){var s=r.$$slots?.[n],o=!1;s===!0&&(s=r.children,o=!0),s===void 0||s(e,o?()=>a:a)}const La=[...` 	
\r\fÂ \v\uFEFF`];function no(e,r,n){var a=e==null?"":""+e;if(n){for(var i in n)if(n[i])a=a?a+" "+i:i;else if(a.length)for(var s=i.length,o=0;(o=a.indexOf(i,o))>=0;){var c=o+s;(o===0||La.includes(a[o-1]))&&(c===a.length||La.includes(a[c]))?a=(o===0?"":a.substring(0,o))+a.substring(c+1):o=c}}return a===""?null:a}function ao(e,r){return e==null?null:String(e)}function Ut(e,r,n,a,i,s){var o=e.__className;if(o!==n||o===void 0){var c=no(n,a,s);c==null?e.removeAttribute("class"):r?e.className=c:e.setAttribute("class",c),e.__className=n}else if(s&&i!==s)for(var l in s){var d=!!s[l];(i==null||d!==!!i[l])&&e.classList.toggle(l,d)}return s}function io(e,r,n,a){var i=e.__style;if(i!==r){var s=ao(r);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=r}return a}const so=Symbol("is custom element"),oo=Symbol("is html");function lo(e,r){var n=Mi(e);n.value===(n.value=r??void 0)||e.value===r&&(r!==0||e.nodeName!=="PROGRESS")||(e.value=r??"")}function f(e,r,n,a){var i=Mi(e);i[r]!==(i[r]=n)&&(r==="loading"&&(e[zi]=n),n==null?e.removeAttribute(r):typeof n!="string"&&co(e).includes(r)?e[r]=n:e.setAttribute(r,n))}function Mi(e){return e.__attributes??={[so]:e.nodeName.includes("-"),[oo]:e.namespaceURI===hs}}var Sa=new Map;function co(e){var r=e.getAttribute("is")||e.nodeName,n=Sa.get(r);if(n)return n;Sa.set(r,n=[]);for(var a,i=e,s=Element.prototype;s!==i;){a=Ia(i);for(var o in a)a[o].set&&n.push(o);i=Qn(i)}return n}function an(e,r,n=r){var a=new WeakSet;oi(e,"input",async i=>{var s=i?e.defaultValue:e.value;if(s=jn(e)?Hn(s):s,n(s),Ke!==null&&a.add(Ke),await Xs(),s!==(s=r())){var o=e.selectionStart,c=e.selectionEnd,l=e.value.length;if(e.value=s??"",c!==null){var d=e.value.length;o===c&&c===l&&d>l?(e.selectionStart=d,e.selectionEnd=d):(e.selectionStart=o,e.selectionEnd=Math.min(c,d))}}}),u(r)==null&&e.value&&(n(jn(e)?Hn(e.value):e.value),Ke!==null&&a.add(Ke)),zr(()=>{var i=r();if(e===document.activeElement){var s=mn??Ke;if(a.has(s))return}jn(e)&&i===Hn(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function en(e,r,n=r){oi(e,"change",a=>{var i=a?e.defaultChecked:e.checked;n(i)}),u(r)==null&&n(e.checked),zr(()=>{var a=r();e.checked=!!a})}function jn(e){var r=e.type;return r==="number"||r==="range"}function Hn(e){return e===""?null:+e}function uo(e,r,n){var a=Sr(e,r);a&&a.set&&(e[r]=n,Rn(()=>{e[r]=null}))}function Ma(e,r){return e===r||e?.[Mr]===r}function ki(e={},r,n,a){return Ns(()=>{var i,s;return zr(()=>{i=s,s=[],u(()=>{e!==n(...s)&&(r(e,...s),i&&Ma(n(...i),e)&&r(null,...i))})}),()=>{Zr(()=>{s&&Ma(n(...s),e)&&r(null,...s)})}}),e}function ka(e){return function(...r){var n=r[0];return n.stopPropagation(),e?.apply(this,r)}}function zt(e=!1){const r=Qe,n=r.l.u;if(!n)return;let a=()=>R(r.s);if(e){let i=0,s={};const o=ia(()=>{let c=!1;const l=r.s;for(const d in l)l[d]!==s[d]&&(s[d]=l[d],c=!0);return c&&i++,i});a=()=>t(o)}n.b.length&&Is(()=>{Ea(r,a),wn(n.b)}),Un(()=>{const i=u(()=>n.m.map(Vi));return()=>{for(const s of i)typeof s=="function"&&s()}}),n.a.length&&Un(()=>{Ea(r,a),wn(n.a)})}function Ea(e,r){if(e.l.s)for(const n of e.l.s)t(n);r()}function Ta(e,r){var n=e.$$events?.[r.type],a=Jn(n)?n.slice():n==null?[]:[n];for(var i of a)i.call(this,r)}function ua(e,r,n){if(e==null)return r(void 0),n&&n(void 0),yr;const a=u(()=>e.subscribe(r,n));return a.unsubscribe?()=>a.unsubscribe():a}const Cr=[];function fo(e,r){return{subscribe:dt(e,r).subscribe}}function dt(e,r=yr){let n=null;const a=new Set;function i(c){if(Xa(e,c)&&(e=c,n)){const l=!Cr.length;for(const d of a)d[1](),Cr.push(d,e);if(l){for(let d=0;d<Cr.length;d+=2)Cr[d][0](Cr[d+1]);Cr.length=0}}}function s(c){i(c(e))}function o(c,l=yr){const d=[c,l];return a.add(d),a.size===1&&(n=r(i,s)||yr),c(e),()=>{a.delete(d),a.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:o}}function mr(e,r,n){const a=!Array.isArray(e),i=a?[e]:e;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=r.length<2;return fo(n,(o,c)=>{let l=!1;const d=[];let v=0,g=yr;const h=()=>{if(v)return;g();const S=r(a?d[0]:d,o,c);s?o(S):g=typeof S=="function"?S:yr},y=i.map((S,P)=>ua(S,m=>{d[P]=m,v&=~(1<<P),l&&h()},()=>{v|=1<<P}));return l=!0,h(),function(){wn(y),g(),l=!1}})}function En(e){let r;return ua(e,n=>r=n)(),r}let vn=!1,Zn=Symbol();function Je(e,r,n){const a=n[r]??={store:null,source:$(void 0),unsubscribe:yr};if(a.store!==e&&!(Zn in n))if(a.unsubscribe(),a.store=e??null,e==null)a.source.v=void 0,a.unsubscribe=yr;else{var i=!0;a.unsubscribe=ua(e,s=>{i?a.source.v=s:b(a.source,s)}),i=!1}return e&&Zn in n?En(e):t(a.source)}function vo(e,r){return e.set(r),r}function In(){const e={};function r(){Rn(()=>{for(var n in e)e[n].unsubscribe();Ra(e,Zn,{enumerable:!1,value:!0})})}return[e,r]}function ho(e){var r=vn;try{return vn=!1,[e(),vn]}finally{vn=r}}function Se(e,r,n,a){var i=!Vr||(n&us)!==0,s=(n&fs)!==0,o=a,c=!0,l=()=>(c&&(c=!1,o=a),o),d;{var v=Mr in e||Zi in e;d=Sr(e,r)?.set??(v&&r in e?M=>e[r]=M:void 0)}var g,h=!1;[g,h]=ho(()=>e[r]),g===void 0&&a!==void 0&&(g=l(),d&&(i&&ts(),d(g)));var y;if(i?y=()=>{var M=e[r];return M===void 0?l():(c=!0,M)}:y=()=>{var M=e[r];return M!==void 0&&(o=void 0),M===void 0?o:M},i&&(n&ds)===0)return y;if(d){var S=e.$$legacy;return(function(M,z){return arguments.length>0?((!i||!z||S||h)&&d(z?y():M),M):y()})}var P=!1,m=Ve(()=>(P=!1,y()));t(m);var L=Be;return(function(M,z){if(arguments.length>0){const q=z?t(m):i&&s?Ir(M):M;return b(m,q),P=!0,o!==void 0&&(o=q),M}return xr&&P||(L.f&ar)!==0?m.v:t(m)})}function Gr(e){Qe===null&&Ha(),Vr&&Qe.l!==null?yo(Qe).m.push(e):Un(()=>{const r=u(e);if(typeof r=="function")return r})}function Ei(e){Qe===null&&Ha(),Gr(()=>()=>u(e))}function yo(e){var r=e.l;return r.u??={a:[],b:[],m:[]}}const go="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(go);ps();function po(e,r,n,a){const i=Nr(n,a,e),s=Nr(n,a,r),o=Nr(e,r,n),c=Nr(e,r,a);return!!((i>0&&s<0||i<0&&s>0)&&(o>0&&c<0||o<0&&c>0)||i===0&&hn(n,a,e)||s===0&&hn(n,a,r)||o===0&&hn(e,r,n)||c===0&&hn(e,r,a))}function Nr(e,r,n){return(n.x-e.x)*(r.y-e.y)-(r.x-e.x)*(n.y-e.y)}function hn(e,r,n){return Math.min(e.x,r.x)<=n.x&&n.x<=Math.max(e.x,r.x)&&Math.min(e.y,r.y)<=n.y&&n.y<=Math.max(e.y,r.y)}function Pa(e,r,n,a=16){const i=[];for(let s=0;s<a;s++){const o=2*Math.PI*s/a;i.push({x:e+n*Math.cos(o),y:r+n*Math.sin(o)})}return i}function xo(e,r,n,a,i=0,s=16){const o=[],c=2*(n+a),l=i*Math.PI/180,d=Math.cos(l),v=Math.sin(l),g=s/c,h=Math.max(1,Math.round(n*g)),y=Math.max(1,Math.round(a*g)),S=n/2,P=a/2,m=[];for(let L=0;L<h;L++){const M=L/h;m.push({x:-S+n*M,y:-P})}for(let L=0;L<y;L++){const M=L/y;m.push({x:S,y:-P+a*M})}for(let L=0;L<h;L++){const M=L/h;m.push({x:S-n*M,y:P})}for(let L=0;L<y;L++){const M=L/y;m.push({x:-S,y:P-a*M})}for(const L of m)o.push({x:e+L.x*d-L.y*v,y:r+L.x*v+L.y*d});if(o.length>s){const L=[],M=o.length/s;for(let z=0;z<s;z++)L.push(o[Math.floor(z*M)]);return L}return o}function _o(e,r,n,a,i=0,s=16){const o=[],c=i*Math.PI/180,l=Math.cos(c),d=Math.sin(c);for(let v=0;v<s;v++){const g=2*Math.PI*v/s,h=n*Math.cos(g),y=a*Math.sin(g);o.push({x:e+h*l-y*d,y:r+h*d+y*l})}return o}function $a(e,r,n){const a=n.length;for(let i=0;i<a;i++){const s=n[i],o=n[(i+1)%a];if(po(e,r,s,o))return!0}return!1}function Ti(e,r,n){const a=n*Math.PI/180,i=Math.cos(a),s=Math.sin(a),o=e.x-r.x,c=e.y-r.y;return{x:r.x+o*i-c*s,y:r.y+o*s+c*i}}function Pi(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function ln(e){const r=Pi(e),n=e.rotation||0;return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}].map(i=>Ti(i,r,n))}function mo(e){const i=e.x,s=e.y+e.height;return[{x:i,y:s},{x:i,y:s-8},{x:i+.5,y:s-8},{x:i+.5,y:s-.5},{x:i+4,y:s-.5},{x:i+4,y:s}]}function bo(e){const r=mo(e),n=Pi(e),a=e.rotation||0;return r.map(i=>Ti(i,n,a))}function wo(e,r,n,a,i=.01){const s=Math.abs(Nr(e,r,n)),o=Math.abs(Nr(e,r,a)),c=Math.sqrt((r.x-e.x)**2+(r.y-e.y)**2),l=i*c;if(s>l||o>l)return!1;const d=r.x-e.x,v=r.y-e.y,g=Math.sqrt(d*d+v*v);if(g<i)return!1;const h=d/g,y=v/g,S=0,P=g,m=(n.x-e.x)*h+(n.y-e.y)*y,L=(a.x-e.x)*h+(a.y-e.y)*y,M=Math.min(S,P),z=Math.max(S,P),q=Math.min(m,L),J=Math.max(m,L),ye=Math.max(M,q);return Math.min(z,J)-ye>i}function Lo(e,r,n=.1){const a=e.length,i=r.length;for(let s=0;s<a;s++){const o=e[s],c=e[(s+1)%a];for(let l=0;l<i;l++){const d=r[l],v=r[(l+1)%i];if(wo(o,c,d,v,n))return!0}}return!1}function So(e){const r=e.length;if(r===0)return new Map;const n=Array.from({length:r},(c,l)=>l);function a(c){return n[c]!==c&&(n[c]=a(n[c])),n[c]}function i(c,l){const d=a(c),v=a(l);d!==v&&(n[d]=v)}for(let c=0;c<r;c++)for(let l=c+1;l<r;l++)Lo(e[c].vertices,e[l].vertices)&&i(c,l);const s=new Map;e.forEach((c,l)=>s.set(c.id,l));const o=new Map;return e.forEach((c,l)=>{o.set(c.id,a(l))}),o}function Mo(e,r,n){const a=r.get(e);return a===void 0?[e]:n.filter(i=>r.get(i.id)===a).map(i=>i.id)}const yn=16;function zn(e){return e.isRectangle&&e.width!==void 0&&e.height!==void 0?xo(e.x,e.y,e.width,e.height,e.rotation||0,yn):e.radius!==void 0?Pa(e.x,e.y,e.radius,yn):e.rx!==void 0&&e.ry!==void 0?_o(e.x,e.y,e.rx,e.ry,e.rotation||0,yn):Pa(e.x,e.y,.5,yn)}function Da(e,r){const n=zn(e);for(const a of n)if(Aa(a,r))return!0;return!!Aa({x:e.x,y:e.y},r)}function Aa(e,r){const n=r.length;let a=null;for(let i=0;i<n;i++){const s=r[i],o=r[(i+1)%n],c=(o.x-s.x)*(e.y-s.y)-(o.y-s.y)*(e.x-s.x);if(c!==0){const l=c>0;if(a===null)a=l;else if(a!==l)return!1}}return!0}function $i(e,r,n,a){const i=zn(e),s=zn(r),o=So(n),c=new Set;for(const g of n){const h=Da(e,g.vertices),y=Da(r,g.vertices);if(h||y){const S=Mo(g.id,o,n);for(const P of S)c.add(P)}}const l=[];let d=!1,v=null;for(const g of i)for(const h of s){const y={from:g,to:h,blocked:!1,blockedBy:null};let S=!1;for(const m of n)if(!c.has(m.id)&&$a(g,h,m.vertices)){y.blocked=!0,y.blockedBy="terrain",S=!0;break}if(S){l.push(y);continue}let P=!1;for(const m of a)if($a(g,h,m)){y.blocked=!0,y.blockedBy="wall",P=!0;break}P||(y.blocked=!1,d||(v=y),d=!0),l.push(y)}return{canSee:d,rays:l,firstClearRay:v,terrainsIgnored:Array.from(c)}}const fe={width:60,height:44},Di=dt([{id:"terrain1",x:20,y:16,width:6,height:12,rotation:0},{id:"terrain2",x:34,y:10,width:6,height:12,rotation:45},{id:"terrain3",x:44,y:20,width:6,height:12,rotation:-30}]);mr(Di,e=>e.map(r=>bo(r)));mr(Di,e=>e.map(r=>({id:r.id,vertices:ln(r)})));const Ca=dt(!1);var ko=le('<line stroke="#3a4a3a" stroke-width="0.05"></line>'),Eo=le('<line stroke="#3a4a3a" stroke-width="0.05"></line>'),To=le('<line stroke="#5a6a5a" stroke-width="0.08"></line>'),Po=le('<line stroke="#5a6a5a" stroke-width="0.08"></line>'),$o=le('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),Do=le('<line stroke="#666"></line><!>',1),Ao=le('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),Co=le('<line stroke="#666"></line><!>',1),Ro=le('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),Io=le('<line stroke="#666"></line><!>',1),Oo=le('<text text-anchor="middle" class="ruler-text svelte-n43bnt"> </text>'),No=le('<line stroke="#666"></line><!>',1),Wo=le('<svg preserveAspectRatio="xMidYMid meet"><rect x="0" y="0" fill="#1a1a1a"></rect><rect fill="#4a5a4a"></rect><!><!><!><!><!><!><!><!><g><!></g></svg>');function On(e,r){Ht(r,!1);const n=$(),a=$(),i=$(),s=$(),o=$(),c=$(),l=$();let d=$();const v=2,g=fe.width+v*2,h=fe.height+v*2;let y=$(1),S=$(0),P=$(0),m=$(!1),L={x:0,y:0},M=$(!1);const z=.5,q=4;function J(Q,U){if(!t(d))return{x:0,y:0};const pe=t(d).createSVGPoint();pe.x=Q,pe.y=U;const B=pe.matrixTransform(t(d).getScreenCTM().inverse());return{x:B.x-v,y:B.y-v}}function ye(Q){Q.preventDefault();const U=t(d).getBoundingClientRect(),pe=Q.clientX-U.left,B=Q.clientY-U.top,st=t(i)+pe/U.width*t(n),at=t(s)+B/U.height*t(a),Ze=Q.deltaY>0?.9:1.1,Re=Math.max(z,Math.min(q,t(y)*Ze)),ae=g/Re,k=h/Re,O=st-pe/U.width*ae,ie=at-B/U.height*k;b(y,Re),b(S,O),b(P,ie)}function be(Q){(Q.button===1||Q.button===0&&t(M))&&(Q.preventDefault(),b(m,!0),L={x:Q.clientX,y:Q.clientY})}function C(Q){if(!t(m))return;const U=t(d).getBoundingClientRect(),pe=(Q.clientX-L.x)/U.width*t(n),B=(Q.clientY-L.y)/U.height*t(a);b(S,t(S)-pe),b(P,t(P)-B),L={x:Q.clientX,y:Q.clientY}}function de(){b(m,!1)}function ee(Q){Q.code==="Space"&&!Q.repeat&&Q.target.tagName!=="INPUT"&&(Q.preventDefault(),b(M,!0))}function Te(Q){Q.code==="Space"&&b(M,!1)}function Oe(){b(y,1),b(S,0),b(P,0)}G(()=>t(y),()=>{b(n,g/t(y))}),G(()=>t(y),()=>{b(a,h/t(y))}),G(()=>t(S),()=>{b(i,t(S))}),G(()=>t(P),()=>{b(s,t(P))}),G(()=>(t(i),t(s),t(n),t(a)),()=>{b(o,`${t(i)} ${t(s)} ${t(n)} ${t(a)}`)}),G(()=>fe,()=>{b(c,Array.from({length:fe.width+1},(Q,U)=>U))}),G(()=>fe,()=>{b(l,Array.from({length:fe.height+1},(Q,U)=>U))}),_r();var Pe={screenToSvg:J};zt();var ve=Wo();F("keydown",Or,ee),F("keyup",Or,Te),F("mouseup",Or,de),F("mousemove",Or,C);let ue;var te=x(ve),we=p(te);f(we,"x",v),f(we,"y",v);var Z=p(we);me(Z,1,()=>(R(fe),u(()=>Array(fe.width+1))),Ie,(Q,U,pe)=>{var B=ko();f(B,"x1",v+pe),f(B,"y1",v),f(B,"x2",v+pe),I(()=>f(B,"y2",(R(fe),u(()=>v+fe.height)))),w(Q,B)});var he=p(Z);me(he,1,()=>(R(fe),u(()=>Array(fe.height+1))),Ie,(Q,U,pe)=>{var B=Eo();f(B,"x1",v),f(B,"y1",v+pe),f(B,"y2",v+pe),I(()=>f(B,"x2",(R(fe),u(()=>v+fe.width)))),w(Q,B)});var K=p(he);me(K,1,()=>(R(fe),u(()=>Array(Math.floor(fe.width/6)+1))),Ie,(Q,U,pe)=>{var B=To();f(B,"x1",v+pe*6),f(B,"y1",v),f(B,"x2",v+pe*6),I(()=>f(B,"y2",(R(fe),u(()=>v+fe.height)))),w(Q,B)});var re=p(K);me(re,1,()=>(R(fe),u(()=>Array(Math.floor(fe.height/6)+1))),Ie,(Q,U,pe)=>{var B=Po();f(B,"x1",v),f(B,"y1",v+pe*6),f(B,"y2",v+pe*6),I(()=>f(B,"x2",(R(fe),u(()=>v+fe.width)))),w(Q,B)});var ge=p(re);me(ge,1,()=>t(c),Ie,(Q,U)=>{var pe=Do(),B=_e(pe);f(B,"y2",v);var st=p(B);{var at=Ze=>{var Re=$o();f(Re,"y",1.2);var ae=x(Re);I(()=>{f(Re,"x",v+t(U)),Ee(ae,`${t(U)??""}"`)}),w(Ze,Re)};oe(st,Ze=>{t(U)%6===0&&Ze(at)})}I(()=>{f(B,"x1",v+t(U)),f(B,"y1",t(U)%6===0?.5:v-.8),f(B,"x2",v+t(U)),f(B,"stroke-width",t(U)%6===0?.08:.04)}),w(Q,pe)});var ne=p(ge);me(ne,1,()=>t(c),Ie,(Q,U)=>{var pe=Co(),B=_e(pe),st=p(B);{var at=Ze=>{var Re=Ao(),ae=x(Re);I(()=>{f(Re,"x",v+t(U)),f(Re,"y",(R(fe),u(()=>v+fe.height+1.8))),Ee(ae,`${t(U)??""}"`)}),w(Ze,Re)};oe(st,Ze=>{t(U)%6===0&&Ze(at)})}I(()=>{f(B,"x1",v+t(U)),f(B,"y1",(R(fe),u(()=>v+fe.height))),f(B,"x2",v+t(U)),f(B,"y2",(R(fe),t(U),u(()=>v+fe.height+(t(U)%6===0?1.5:.8)))),f(B,"stroke-width",t(U)%6===0?.08:.04)}),w(Q,pe)});var Me=p(ne);me(Me,1,()=>t(l),Ie,(Q,U)=>{var pe=Io(),B=_e(pe);f(B,"x2",v);var st=p(B);{var at=Ze=>{var Re=Ro();f(Re,"x",1);var ae=x(Re);I(()=>{f(Re,"y",v+t(U)+.35),Ee(ae,`${t(U)??""}"`)}),w(Ze,Re)};oe(st,Ze=>{t(U)%6===0&&Ze(at)})}I(()=>{f(B,"x1",t(U)%6===0?.5:v-.8),f(B,"y1",v+t(U)),f(B,"y2",v+t(U)),f(B,"stroke-width",t(U)%6===0?.08:.04)}),w(Q,pe)});var ke=p(Me);me(ke,1,()=>t(l),Ie,(Q,U)=>{var pe=No(),B=_e(pe),st=p(B);{var at=Ze=>{var Re=Oo(),ae=x(Re);I(()=>{f(Re,"x",(R(fe),u(()=>v+fe.width+1))),f(Re,"y",v+t(U)+.35),Ee(ae,`${t(U)??""}"`)}),w(Ze,Re)};oe(st,Ze=>{t(U)%6===0&&Ze(at)})}I(()=>{f(B,"x1",(R(fe),u(()=>v+fe.width))),f(B,"y1",v+t(U)),f(B,"x2",(R(fe),t(U),u(()=>v+fe.width+(t(U)%6===0?1.5:.8)))),f(B,"y2",v+t(U)),f(B,"stroke-width",t(U)%6===0?.08:.04)}),w(Q,pe)});var Ce=p(ke);f(Ce,"transform","translate(2, 2)");var tt=x(Ce);return Si(tt,r,"default",{screenToSvg:J}),ki(ve,Q=>b(d,Q),()=>t(d)),I(()=>{f(ve,"viewBox",t(o)),ue=Ut(ve,0,"battlefield svelte-n43bnt",null,ue,{panning:t(m)||t(M)}),f(te,"width",(R(fe),u(()=>fe.width+v*2))),f(te,"height",(R(fe),u(()=>fe.height+v*2))),f(we,"width",(R(fe),u(()=>fe.width))),f(we,"height",(R(fe),u(()=>fe.height)))}),F("wheel",ve,ye),F("mousedown",ve,be),F("dblclick",ve,Oe),w(e,ve),uo(r,"screenToSvg",J),Yt(Pe)}var jo=le('<line stroke="#3b82f6" stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-trljjm"></circle>',1),Ho=le('<g><g><rect role="button" tabindex="0" class="svelte-trljjm"></rect></g><!></g>');function Ai(e,r){Ht(r,!1);const n=$(),a=$(),i=$(),s=$(),o=$();let c=Se(r,"id",8),l=Se(r,"x",8),d=Se(r,"y",8),v=Se(r,"width",8),g=Se(r,"height",8),h=Se(r,"rotation",8,0),y=Se(r,"selected",8,!1),S=Se(r,"screenToSvg",8),P=Se(r,"onSelect",8,()=>{}),m=Se(r,"onDrag",8,()=>{}),L=Se(r,"onRotate",8,()=>{}),M=$(!1),z=!1,q={x:0,y:0};function J(Z){Z.stopPropagation(),P()(c())}function ye(Z){if(Z.button!==0)return;Z.preventDefault(),Z.stopPropagation(),P()(c()),b(M,!0);const he=S()(Z.clientX,Z.clientY);q={x:he.x-l(),y:he.y-d()},window.addEventListener("mousemove",be),window.addEventListener("mouseup",C)}function be(Z){if(!t(M))return;const he=S()(Z.clientX,Z.clientY);let K=he.x-q.x,re=he.y-q.y;Z.shiftKey||(K=Math.round(K),re=Math.round(re));const ge=Math.max(v(),g())/2;K=Math.max(-ge,Math.min(fe.width-v()+ge,K)),re=Math.max(-ge,Math.min(fe.height-g()+ge,re)),m()(c(),K,re)}function C(){b(M,!1),window.removeEventListener("mousemove",be),window.removeEventListener("mouseup",C)}function de(Z){Z.preventDefault(),Z.stopPropagation(),z=!0,window.addEventListener("mousemove",ee),window.addEventListener("mouseup",Te)}function ee(Z){if(!z)return;const he=S()(Z.clientX,Z.clientY),K=he.x-t(n),re=he.y-t(a);let ge=Math.atan2(re,K)*180/Math.PI+45;Z.shiftKey||(ge=Math.round(ge/15)*15),L()(c(),ge)}function Te(){z=!1,window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",Te)}G(()=>(R(l()),R(v())),()=>{b(n,l()+v()/2)}),G(()=>(R(d()),R(g())),()=>{b(a,d()+g()/2)}),G(()=>(R(v()),R(g())),()=>{b(i,Math.max(v(),g())/2+1.5)}),G(()=>(t(n),t(i),R(h())),()=>{b(s,t(n)+t(i)*Math.cos((h()-45)*Math.PI/180))}),G(()=>(t(a),t(i),R(h())),()=>{b(o,t(a)+t(i)*Math.sin((h()-45)*Math.PI/180))}),_r(),zt();var Oe=Ho();let Pe;var ve=x(Oe),ue=x(ve),te=p(ve);{var we=Z=>{var he=jo(),K=_e(he),re=p(K);I(()=>{f(K,"x1",t(n)),f(K,"y1",t(a)),f(K,"x2",t(s)),f(K,"y2",t(o)),f(re,"cx",t(s)),f(re,"cy",t(o))}),F("mousedown",re,de),w(Z,he)};oe(te,Z=>{y()&&Z(we)})}I(()=>{Pe=Ut(Oe,0,"terrain-rect svelte-trljjm",null,Pe,{selected:y(),dragging:t(M)}),f(ve,"transform",`rotate(${h()??""}, ${t(n)??""}, ${t(a)??""})`),f(ue,"x",l()),f(ue,"y",d()),f(ue,"width",v()),f(ue,"height",g()),f(ue,"fill",y()?"rgba(59, 130, 246, 0.3)":"rgba(139, 90, 43, 0.3)"),f(ue,"stroke",y()?"#3b82f6":"#8b5a2b"),f(ue,"stroke-width",y()?.15:.1)}),F("click",ue,J),F("mousedown",ue,ye),w(e,Oe),Yt()}const Ci="warhammer-deployment-layouts",Ri=[{label:'6" x 12"',width:6,height:12},{label:'5" x 10"',width:5,height:10},{label:'4" x 6"',width:4,height:6}],qn=[{label:"L 4x8",shape:"L-4x8"},{label:"L 4x8 â",shape:"L-4x8-mirror"},{label:"C 4-8-4",shape:"C-4-8-4"},{label:"L 5x6",shape:"L-5x6"},{label:"L 5x6 â",shape:"L-5x6-mirror"},{label:"L 4x6",shape:"L-4x6"},{label:"L 4x6 â",shape:"L-4x6-mirror"}],Ii=[{name:"Layout 1",terrains:[{id:"a",x:28,y:0,width:4,height:6,rotation:0},{id:"b",x:28,y:38,width:4,height:6,rotation:0},{id:"c",x:6,y:5,width:6,height:12,rotation:0},{id:"d",x:48,y:27,width:6,height:12,rotation:0},{id:"e",x:16,y:28,width:6,height:12,rotation:0},{id:"f",x:7,y:19,width:6,height:12,rotation:90},{id:"g",x:38,y:4,width:6,height:12,rotation:0},{id:"h",x:47,y:13,width:6,height:12,rotation:90},{id:"i",x:32.74,y:23.59,width:5,height:10,rotation:135},{id:"j",x:35.06,y:19.5,width:4,height:6,rotation:45},{id:"k",x:22.07,y:10.17,width:5,height:10,rotation:-45},{id:"l",x:20.72,y:18.23,width:4,height:6,rotation:45}],walls:[{id:"wa",x:38,y:6,shape:"C-4-8-4",rotation:0},{id:"wb",x:18,y:30,shape:"C-4-8-4",rotation:180},{id:"wc",x:13.33,y:20.15,shape:"L-4x8-mirror",rotation:-90},{id:"wd",x:49.67,y:15.93,shape:"L-4x8-mirror",rotation:90},{id:"we",x:48.2,y:30.88,shape:"L-4x8",rotation:0},{id:"wf",x:7.84,y:5.01,shape:"L-4x8",rotation:180},{id:"wg",x:27.06,y:11.52,shape:"L-4x8-mirror",rotation:-45},{id:"wh",x:35.81,y:24.24,shape:"L-4x8-mirror",rotation:135}]},{name:"Layout 2",terrains:[{id:"a",x:31,y:7,width:4,height:6,rotation:-90},{id:"b",x:25,y:30,width:4,height:6,rotation:90},{id:"c",x:5,y:4,width:6,height:12,rotation:0},{id:"d",x:49,y:28,width:6,height:12,rotation:0},{id:"e",x:46,y:4,width:6,height:12,rotation:0},{id:"f",x:16.32,y:16.13,width:6,height:12,rotation:135},{id:"g",x:53,y:15,width:4,height:6,rotation:90},{id:"h",x:8,y:28,width:6,height:12,rotation:0},{id:"i",x:3,y:23,width:4,height:6,rotation:90},{id:"j",x:32.62,y:32.55,width:5,height:10,rotation:-90},{id:"k",x:22.48,y:.51,width:5,height:10,rotation:-90},{id:"l",x:37,y:16,width:6,height:12,rotation:135}],walls:[{id:"wa",x:49,y:32,shape:"L-4x8",rotation:0},{id:"wb",x:7,y:4,shape:"L-4x8",rotation:180},{id:"wc",x:46,y:8,shape:"L-4x8",rotation:0},{id:"wd",x:10,y:28,shape:"L-4x8",rotation:180},{id:"we",x:35.07,y:34.56,shape:"L-5x6-mirror",rotation:-90},{id:"wf",x:29.09,y:2.47,shape:"L-5x6-mirror",rotation:90},{id:"wg",x:17.86,y:17.53,shape:"C-4-8-4",rotation:135},{id:"wh",x:37.24,y:18.38,shape:"C-4-8-4",rotation:-45}]},{name:"Layout 3",terrains:[{id:"a",x:11,y:3,width:4,height:6,rotation:90},{id:"b",x:45,y:35,width:4,height:6,rotation:90},{id:"c",x:25,y:1,width:6,height:12,rotation:90},{id:"d",x:29,y:31,width:6,height:12,rotation:90},{id:"e",x:7.74,y:26.05,width:6,height:12,rotation:125.31},{id:"f",x:46.34,y:5.51,width:6,height:12,rotation:121.72},{id:"g",x:5.14,y:10.46,width:6,height:12,rotation:41.51},{id:"h",x:48.67,y:21.52,width:6,height:12,rotation:41.51},{id:"i",x:19.59,y:14.36,width:5,height:10,rotation:-38.13},{id:"j",x:20.69,y:24.37,width:4,height:6,rotation:-39.33},{id:"k",x:35.34,y:19.61,width:5,height:10,rotation:-38.13},{id:"l",x:35.31,y:13.5,width:4,height:6,rotation:-39.33}],walls:[{id:"aa",x:30,y:32,shape:"C-4-8-4",rotation:90},{id:"ab",x:26,y:4,shape:"C-4-8-4",rotation:-90},{id:"ac",x:8.19,y:11.64,shape:"L-4x8",rotation:222.46},{id:"ad",x:47.79,y:24.3,shape:"L-4x8",rotation:41.26},{id:"ae",x:38.64,y:20.09,shape:"L-5x6-mirror",rotation:141.31},{id:"af",x:25.26,y:17.9,shape:"L-5x6-mirror",rotation:-37.61},{id:"ag",x:14.37,y:28.38,shape:"L-4x8-mirror",rotation:-54.26},{id:"ah",x:48.75,y:7.3,shape:"L-4x8-mirror",rotation:122.02}]},{name:"Layout 4",terrains:[{id:"a",x:15,y:1,width:6,height:12,rotation:90},{id:"b",x:8,y:10,width:4,height:6,rotation:0},{id:"c",x:4,y:19,width:4,height:6,rotation:0},{id:"d",x:7.5,y:27.68,width:6,height:12,rotation:-48.57},{id:"e",x:46.53,y:4.24,width:6,height:12,rotation:-48.57},{id:"f",x:53,y:19,width:4,height:6,rotation:0},{id:"g",x:48,y:28,width:4,height:6,rotation:0},{id:"h",x:39,y:31,width:6,height:12,rotation:90},{id:"i",x:33.03,y:2.97,width:6,height:12,rotation:-37.25},{id:"j",x:20.96,y:28.96,width:6,height:12,rotation:-37.25},{id:"k",x:16.93,y:16.51,width:5,height:10,rotation:-41.85},{id:"l",x:37.96,y:17.43,width:5,height:10,rotation:-41.85}],walls:[{id:"aa",x:18,y:4,shape:"L-4x8",rotation:-90},{id:"ab",x:9.04,y:29.01,shape:"C-4-8-4",rotation:131.97},{id:"ac",x:47,y:7,shape:"C-4-8-4",rotation:-48.54},{id:"ad",x:38,y:32,shape:"L-4x8",rotation:90},{id:"ae",x:34.42,y:7.12,shape:"L-4x8",rotation:-37.53},{id:"af",x:21.57,y:28.8,shape:"L-4x8",rotation:142.46},{id:"ag",x:15.7,y:17.01,shape:"L-5x6",rotation:137.87},{id:"ah",x:39.17,y:20.85,shape:"L-5x6",rotation:-40.92}]},{name:"Layout 5",terrains:[{id:"aa",x:27,y:1,width:6,height:12,rotation:90},{id:"ab",x:36.53,y:12.48,width:5,height:10,rotation:-90},{id:"ac",x:13,y:3,width:4,height:6,rotation:90},{id:"ad",x:43,y:35,width:4,height:6,rotation:90},{id:"ae",x:27,y:31,width:6,height:12,rotation:90},{id:"af",x:18.43,y:21.49,width:5,height:10,rotation:-90},{id:"ag",x:1,y:23,width:4,height:6,rotation:90},{id:"ah",x:55,y:15,width:4,height:6,rotation:90},{id:"ai",x:7.83,y:30.22,width:6,height:12,rotation:-60},{id:"aj",x:46.32,y:1.58,width:6,height:12,rotation:-60},{id:"ak",x:8.74,y:10.19,width:6,height:12,rotation:65.22},{id:"al",x:45.22,y:21.75,width:6,height:12,rotation:65.22}],walls:[{id:"a1",x:28,y:32,shape:"C-4-8-4",rotation:90},{id:"a2",x:28,y:4,shape:"C-4-8-4",rotation:-90},{id:"a3",x:11.88,y:12.29,shape:"L-4x8",rotation:-114.74},{id:"a4",x:43.97,y:23.59,shape:"L-4x8",rotation:64.22},{id:"a5",x:24.91,y:23.52,shape:"L-5x6-mirror",rotation:-90.37},{id:"a6",x:39,y:14.51,shape:"L-5x6-mirror",rotation:89.9},{id:"a7",x:7.58,y:30.57,shape:"L-4x8",rotation:120.93},{id:"a8",x:48.51,y:5.28,shape:"L-4x8",rotation:-59.06}]},{name:"Layout 6",terrains:[{id:"aa",x:13,y:1,width:6,height:12,rotation:90},{id:"ab",x:6,y:10,width:4,height:6,rotation:0},{id:"ac",x:25,y:11,width:4,height:6,rotation:90},{id:"ad",x:7.34,y:27.57,width:6,height:12,rotation:-40.32},{id:"ae",x:46.69,y:4.57,width:6,height:12,rotation:-41.9},{id:"af",x:31,y:27,width:4,height:6,rotation:-90},{id:"ag",x:50,y:28,width:4,height:6,rotation:0},{id:"ah",x:41,y:31,width:6,height:12,rotation:90},{id:"ai",x:34,y:4,width:6,height:12,rotation:0},{id:"aj",x:20,y:28,width:6,height:12,rotation:0},{id:"ak",x:15.7,y:15.03,width:5,height:10,rotation:-41.85},{id:"al",x:39.43,y:19.24,width:5,height:10,rotation:-39.95}],walls:[{id:"a1",x:16,y:4,shape:"L-4x8",rotation:-90},{id:"a2",x:9.04,y:29.01,shape:"C-4-8-4",rotation:140.05},{id:"a3",x:47,y:7.16,shape:"C-4-8-4",rotation:-41.53},{id:"a4",x:40,y:32,shape:"L-4x8",rotation:90},{id:"a5",x:34.15,y:7.88,shape:"L-4x8",rotation:0},{id:"a6",x:22,y:28,shape:"L-4x8",rotation:180},{id:"a7",x:14.47,y:15.47,shape:"L-5x6",rotation:137.87},{id:"a8",x:40.53,y:22.78,shape:"L-5x6",rotation:-40.92}]},{name:"Layout 7",terrains:[{id:"aa",x:8,y:8,width:6,height:12,rotation:0},{id:"ab",x:6,y:28,width:6,height:12,rotation:0},{id:"ac",x:7,y:39,width:4,height:6,rotation:90},{id:"ad",x:18,y:26,width:5,height:10,rotation:0},{id:"ae",x:19,y:20,width:4,height:6,rotation:0},{id:"af",x:23,y:3,width:6,height:12,rotation:0},{id:"ag",x:31,y:29,width:6,height:12,rotation:0},{id:"ah",x:37,y:18,width:4,height:6,rotation:0},{id:"ai",x:37,y:8,width:5,height:10,rotation:0},{id:"aj",x:46,y:24,width:6,height:12,rotation:0},{id:"ak",x:48,y:4,width:6,height:12,rotation:0},{id:"al",x:49,y:-1,width:4,height:6,rotation:90}],walls:[{id:"a1",x:9,y:10,shape:"L-5x6",rotation:180},{id:"a2",x:11.44,y:31.97,shape:"L-4x8-mirror",rotation:0},{id:"a3",x:19,y:20,shape:"L-4x6",rotation:180},{id:"a4",x:22.53,y:30.02,shape:"L-5x6-mirror",rotation:0},{id:"a5",x:25,y:5,shape:"C-4-8-4",rotation:180},{id:"a6",x:31,y:31,shape:"C-4-8-4",rotation:0},{id:"a7",x:37,y:18,shape:"L-4x6",rotation:0},{id:"a8",x:41.51,y:8.09,shape:"L-5x6-mirror",rotation:180},{id:"a9",x:46,y:28,shape:"L-5x6",rotation:0},{id:"a10",x:51.51,y:4.01,shape:"L-4x8-mirror",rotation:180}]},{name:"Layout 8",terrains:[{id:"aa",x:23,y:22,width:4,height:6,rotation:0},{id:"ab",x:23,y:28,width:4,height:6,rotation:0},{id:"ac",x:33,y:16,width:4,height:6,rotation:0},{id:"ad",x:33,y:10,width:4,height:6,rotation:0},{id:"ae",x:41,y:19,width:6,height:12,rotation:0},{id:"af",x:13,y:13,width:6,height:12,rotation:0},{id:"ag",x:32,y:32,width:6,height:12,rotation:0},{id:"ah",x:22,y:0,width:6,height:12,rotation:0},{id:"ai",x:9.5,y:27.68,width:6,height:12,rotation:-48.69},{id:"aj",x:44.51,y:4.35,width:6,height:12,rotation:-48.69},{id:"ak",x:6.95,y:4,width:5,height:10,rotation:53.9},{id:"al",x:48,y:30,width:5,height:10,rotation:53.9}],walls:[{id:"a1",x:32,y:34,shape:"C-4-8-4",rotation:0},{id:"a2",x:24,y:2,shape:"C-4-8-4",rotation:180},{id:"a3",x:44.68,y:19.06,shape:"L-4x8-mirror",rotation:180},{id:"a4",x:18.43,y:16.91,shape:"L-4x8-mirror",rotation:0},{id:"a5",x:46.38,y:33.13,shape:"L-5x6",rotation:52.87},{id:"a6",x:8.55,y:4.89,shape:"L-5x6",rotation:-127.66},{id:"a7",x:16,y:30.28,shape:"L-4x8-mirror",rotation:-48.62},{id:"a8",x:46.91,y:5.85,shape:"L-4x8-mirror",rotation:132.19}]}];function Yo(){return"terrain-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function rr(){const e=localStorage.getItem(Ci);if(e)try{return JSON.parse(e)}catch(r){return console.error("Failed to parse saved layouts:",r),{}}return{}}function Tn(e){localStorage.setItem(Ci,JSON.stringify(e))}function Oi(){const{subscribe:e,set:r,update:n}=dt([]);return{subscribe:e,set:r,update:n,add(a,i){n(s=>[...s,{id:Yo(),x:30-a/2,y:22-i/2,width:a,height:i,rotation:0}])},updateTerrain(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])},save(a){const i=En({subscribe:e}),s=rr();s[a]={terrains:i,savedAt:Date.now()},Tn(s)},load(a){const i=rr();return i[a]?(r(i[a].terrains),!0):!1},deleteLayout(a){const i=rr();delete i[a],Tn(i)},getSavedLayoutNames(){const a=rr();return Object.keys(a).map(i=>({name:i,savedAt:a[i].savedAt,terrainCount:a[i].terrains.length})).sort((i,s)=>s.savedAt-i.savedAt)},hasSaved(){const a=rr();return Object.keys(a).length>0}}}const At=Oi();function Ni(){const{subscribe:e,set:r,update:n}=dt([]);return{subscribe:e,set:r,update:n,add(a){n(i=>[...i,{id:"wall-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),x:30,y:22,shape:a,rotation:0}])},updateWall(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])}}}const Tt=Ni(),gn=Oi(),pn=Ni(),xn=dt(null),_n=dt(null);function Ur(e){switch(e){case"L-4x8":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];case"L-4x8-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:8},{x:-4+.5,y:8},{x:-4+.5,y:8-.5},{x:0,y:8-.5}];case"C-4-8-4":return[{x:0,y:0},{x:4,y:0},{x:4,y:.5},{x:.5,y:.5},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];case"L-5x6":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:5,y:6-.5},{x:5,y:6},{x:0,y:6}];case"L-5x6-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-5+.5,y:6},{x:-5+.5,y:6-.5},{x:0,y:6-.5}];case"L-4x6":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:4,y:6-.5},{x:4,y:6},{x:0,y:6}];case"L-4x6-mirror":return[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-4+.5,y:6},{x:-4+.5,y:6-.5},{x:0,y:6-.5}];default:return[]}}function da(e,r,n,a){if(e.length===0)return[];const i=e.map(L=>L.x),s=e.map(L=>L.y),o=Math.min(...i),c=Math.max(...i),l=Math.min(...s),d=Math.max(...s),v=c-o,g=d-l,h=r+o+v/2,y=n+l+g/2,S=a*Math.PI/180,P=Math.cos(S),m=Math.sin(S);return e.map(L=>{const M=r+L.x,z=n+L.y,q=M-h,J=z-y;return{x:h+q*P-J*m,y:y+q*m+J*P}})}mr(Tt,e=>e.map(r=>da(Ur(r.shape),r.x,r.y,r.rotation)));const Bt=dt(null),Ft=dt(null),fa=dt([]);function Bo(e,r=[]){const n=En(At),a=En(Tt),i=rr();i[e]={terrains:n,walls:a,models:r,savedAt:Date.now()},Tn(i)}function Fo(e){const r=rr();return r[e]?(At.set(r[e].terrains||[]),Tt.set(r[e].walls||[]),{terrains:r[e].terrains||[],walls:r[e].walls||[],models:r[e].models||[]}):null}function Xo(e){const r=rr();delete r[e],Tn(r)}function Uo(){const e=rr();return Object.keys(e).map(r=>({name:r,savedAt:e[r].savedAt,terrainCount:(e[r].terrains||[]).length,wallCount:(e[r].walls||[]).length,modelCount:(e[r].models||[]).length})).sort((r,n)=>n.savedAt-r.savedAt)}function tn(){fa.set(Uo())}var Ko=le('<line stroke="#3b82f6" stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" fill="#3b82f6" stroke="#1d4ed8" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-1tez9jd"></circle>',1),Vo=le('<g><g><path role="button" tabindex="0" class="svelte-1tez9jd"></path></g><!></g>');function va(e,r){Ht(r,!1);const n=$(),a=$(),i=$(),s=$(),o=$(),c=$(),l=$(),d=$(),v=$(),g=$();let h=Se(r,"id",8),y=Se(r,"x",8),S=Se(r,"y",8),P=Se(r,"shape",8),m=Se(r,"rotation",8,0),L=Se(r,"selected",8,!1),M=Se(r,"screenToSvg",8),z=Se(r,"onSelect",8,()=>{}),q=Se(r,"onDrag",8,()=>{}),J=Se(r,"onRotate",8,()=>{});function ye(ne){const Me=ne.map(Ce=>Ce.x),ke=ne.map(Ce=>Ce.y);return{minX:Math.min(...Me),maxX:Math.max(...Me),minY:Math.min(...ke),maxY:Math.max(...ke)}}let be=$(!1),C=!1,de={x:0,y:0};function ee(ne){ne.stopPropagation(),z()(h())}function Te(ne){if(ne.button!==0)return;ne.preventDefault(),ne.stopPropagation(),z()(h()),b(be,!0);const Me=M()(ne.clientX,ne.clientY);de={x:Me.x-y(),y:Me.y-S()},window.addEventListener("mousemove",Oe),window.addEventListener("mouseup",Pe)}function Oe(ne){if(!t(be))return;const Me=M()(ne.clientX,ne.clientY);let ke=Me.x-de.x,Ce=Me.y-de.y;ne.shiftKey||(ke=Math.round(ke),Ce=Math.round(Ce));const tt=Math.max(t(i),t(s));ke=Math.max(-tt,Math.min(fe.width+tt-t(i),ke)),Ce=Math.max(-tt,Math.min(fe.height+tt-t(s),Ce)),q()(h(),ke,Ce)}function Pe(){b(be,!1),window.removeEventListener("mousemove",Oe),window.removeEventListener("mouseup",Pe)}function ve(ne){ne.preventDefault(),ne.stopPropagation(),C=!0,window.addEventListener("mousemove",ue),window.addEventListener("mouseup",te)}function ue(ne){if(!C)return;const Me=M()(ne.clientX,ne.clientY),ke=Me.x-t(o),Ce=Me.y-t(c);let tt=Math.atan2(Ce,ke)*180/Math.PI+45;ne.shiftKey||(tt=Math.round(tt/15)*15),J()(h(),tt)}function te(){C=!1,window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",te)}G(()=>R(P()),()=>{b(n,Ur(P()))}),G(()=>t(n),()=>{b(a,ye(t(n)))}),G(()=>t(a),()=>{b(i,t(a).maxX-t(a).minX)}),G(()=>t(a),()=>{b(s,t(a).maxY-t(a).minY)}),G(()=>(R(y()),t(a),t(i)),()=>{b(o,y()+t(a).minX+t(i)/2)}),G(()=>(R(S()),t(a),t(s)),()=>{b(c,S()+t(a).minY+t(s)/2)}),G(()=>(t(n),R(y()),R(S())),()=>{b(l,t(n).length>0?`M ${t(n).map(ne=>`${y()+ne.x},${S()+ne.y}`).join(" L ")} Z`:"")}),G(()=>(t(i),t(s)),()=>{b(d,Math.max(t(i),t(s))/2+1.5)}),G(()=>(t(o),t(d),R(m())),()=>{b(v,t(o)+t(d)*Math.cos((m()-45)*Math.PI/180))}),G(()=>(t(c),t(d),R(m())),()=>{b(g,t(c)+t(d)*Math.sin((m()-45)*Math.PI/180))}),_r(),zt();var we=Vo();let Z;var he=x(we),K=x(he),re=p(he);{var ge=ne=>{var Me=Ko(),ke=_e(Me),Ce=p(ke);I(()=>{f(ke,"x1",t(o)),f(ke,"y1",t(c)),f(ke,"x2",t(v)),f(ke,"y2",t(g)),f(Ce,"cx",t(v)),f(Ce,"cy",t(g))}),F("mousedown",Ce,ve),w(ne,Me)};oe(re,ne=>{L()&&ne(ge)})}I(()=>{Z=Ut(we,0,"wall-piece svelte-1tez9jd",null,Z,{selected:L(),dragging:t(be)}),f(he,"transform",`rotate(${m()??""}, ${t(o)??""}, ${t(c)??""})`),f(K,"d",t(l)),f(K,"fill",L()?"rgba(139, 69, 19, 0.6)":"rgba(139, 69, 19, 0.8)"),f(K,"stroke",L()?"#3b82f6":"#5c3317"),f(K,"stroke-width",L()?.15:.1)}),F("click",K,ee),F("mousedown",K,Te),w(e,we),Yt()}var Zo=se('<div class="section-content svelte-7o4pd4"><!></div>'),zo=se('<section><div class="section-header svelte-7o4pd4" role="button" tabindex="0"><h3 class="svelte-7o4pd4"> </h3> <span class="toggle-icon svelte-7o4pd4"> </span></div> <!></section>');function pt(e,r){let n=Se(r,"title",8),a=Se(r,"defaultOpen",8,!0),i=$(a());function s(){b(i,!t(i))}var o=zo();let c;var l=x(o),d=x(l),v=x(d),g=p(d,2),h=x(g),y=p(l,2);{var S=P=>{var m=Zo(),L=x(m);Si(L,r,"default",{}),w(P,m)};oe(y,P=>{t(i)&&P(S)})}I(()=>{c=Ut(o,1,"collapsible-section svelte-7o4pd4",null,c,{collapsed:!t(i)}),Ee(v,n()),Ee(h,t(i)?"â¼":"â¶")}),F("click",l,s),w(e,o)}var qo=se('<button class="svelte-10mgcx0"> </button>'),Go=se('<div class="button-group svelte-10mgcx0"></div>'),Jo=se('<button class="svelte-10mgcx0"> </button>'),Qo=se('<div class="button-group svelte-10mgcx0"></div>'),el=se('<div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Size</span> <span class="value svelte-10mgcx0"> </span></div> <div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Rotation</span> <span class="value svelte-10mgcx0"> </span></div>',1),tl=se('<div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Shape</span> <span class="value svelte-10mgcx0"> </span></div> <div class="field svelte-10mgcx0"><span class="label-text svelte-10mgcx0">Rotation</span> <span class="value svelte-10mgcx0"> </span></div>',1),rl=se('<div class="edit-form svelte-10mgcx0"><div class="field svelte-10mgcx0"><label for="edit-x" class="svelte-10mgcx0">X (inches)</label> <input id="edit-x" type="number" step="0.1" class="svelte-10mgcx0"/></div> <div class="field svelte-10mgcx0"><label for="edit-y" class="svelte-10mgcx0">Y (inches)</label> <input id="edit-y" type="number" step="0.1" class="svelte-10mgcx0"/></div> <!> <button class="danger svelte-10mgcx0">Remove</button></div>'),nl=se('<p class="hint svelte-10mgcx0">Click a piece to select it</p>'),al=se('<div class="button-group vertical svelte-10mgcx0"><button class="svelte-10mgcx0">Save Layout</button> <button class="svelte-10mgcx0">Load Layout</button> <div class="button-row svelte-10mgcx0"><button class="secondary small svelte-10mgcx0">Export</button> <button class="secondary small svelte-10mgcx0">Import</button></div> <button class="secondary svelte-10mgcx0">Clear All</button></div>'),il=se("<!> <!>",1),sl=se('<div class="modal-overlay svelte-10mgcx0" role="presentation"><div class="modal svelte-10mgcx0" role="dialog"><h2 class="svelte-10mgcx0">Save Layout</h2> <div class="modal-field svelte-10mgcx0"><label for="layout-name" class="svelte-10mgcx0">Layout Name</label> <input id="layout-name" type="text" placeholder="Enter a name..." class="svelte-10mgcx0"/></div> <div class="modal-actions svelte-10mgcx0"><button class="secondary svelte-10mgcx0">Cancel</button> <button class="svelte-10mgcx0">Save</button></div></div></div>'),ol=se('<p class="hint svelte-10mgcx0">No saved layouts yet</p>'),ll=se('<div class="layout-item svelte-10mgcx0" role="button" tabindex="0"><div class="layout-info svelte-10mgcx0"><span class="layout-name svelte-10mgcx0"> </span> <span class="layout-meta svelte-10mgcx0"> </span></div> <button class="delete-btn svelte-10mgcx0" title="Delete">Ã</button></div>'),cl=se('<div class="layout-list svelte-10mgcx0"></div>'),ul=se('<div class="modal-overlay svelte-10mgcx0" role="presentation"><div class="modal svelte-10mgcx0" role="dialog"><h2 class="svelte-10mgcx0">Load Layout</h2> <!> <div class="modal-actions svelte-10mgcx0"><button class="secondary svelte-10mgcx0">Cancel</button></div></div></div>'),dl=se('<main class="svelte-10mgcx0"><div class="header svelte-10mgcx0"><h1 class="svelte-10mgcx0">Layout Builder</h1> <nav class="nav-links svelte-10mgcx0"><a href="#/setup" class="svelte-10mgcx0">Battlefield Setup</a> <a href="#/deployment" class="svelte-10mgcx0">Deployment</a> <a href="#/" class="active svelte-10mgcx0">Layout Builder</a> <a href="#/debug" class="svelte-10mgcx0">Debug Mode</a></nav></div> <div class="layout svelte-10mgcx0"><div class="sidebar svelte-10mgcx0"><!> <!> <!> <!> <input type="file" accept=".json" style="display: none;"/></div> <div class="battlefield-area svelte-10mgcx0"><div class="battlefield-container svelte-10mgcx0" role="presentation"><!></div> <div class="info svelte-10mgcx0"><p class="svelte-10mgcx0"> </p> <p class="hint svelte-10mgcx0">Scroll to zoom | Space+drag or middle-click to pan | Double-click to reset view</p></div></div></div></main> <!> <!>',1);function fl(e,r){Ht(r,!1);const n=()=>Je(Bt,"$selectedTerrainId",c),a=()=>Je(Ft,"$selectedWallId",c),i=()=>Je(At,"$layoutTerrains",c),s=()=>Je(Tt,"$layoutWalls",c),o=()=>Je(fa,"$savedLayoutsList",c),[c,l]=In(),d=$(),v=$();let g=$(!1),h=$(!1),y=$(""),S=null;Gr(()=>{tn(),window.addEventListener("keydown",P)}),Ei(()=>{window.removeEventListener("keydown",P)});function P(D){if(D.target.tagName==="INPUT"||t(g)||t(h))return;const _=n()||a();if((D.key==="Delete"||D.key==="Backspace")&&_){D.preventDefault(),Te();return}if(_&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(D.key)){D.preventDefault();const T=D.shiftKey?.1:1;let A=0,N=0;switch(D.key){case"ArrowUp":N=-T;break;case"ArrowDown":N=T;break;case"ArrowLeft":A=-T;break;case"ArrowRight":A=T;break}if(n()){const X=i().find(V=>V.id===n());X&&At.updateTerrain(n(),{x:X.x+A,y:X.y+N})}else if(a()){const X=s().find(V=>V.id===a());X&&Tt.updateWall(a(),{x:X.x+A,y:X.y+N})}return}if(D.key==="c"&&(D.ctrlKey||D.metaKey)&&_){if(D.preventDefault(),n()){const T=i().find(A=>A.id===n());T&&(S={type:"terrain",data:{...T}})}else if(a()){const T=s().find(A=>A.id===a());T&&(S={type:"wall",data:{...T}})}return}if(D.key==="v"&&(D.ctrlKey||D.metaKey)&&S){if(D.preventDefault(),S.type==="terrain"){const T="terrain-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),A={...S.data,id:T,x:S.data.x+2,y:S.data.y+2};At.update(N=>[...N,A]),Bt.set(T),Ft.set(null),S.data.x+=2,S.data.y+=2}else if(S.type==="wall"){const T="wall-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),A={...S.data,id:T,x:S.data.x+2,y:S.data.y+2};Tt.update(N=>[...N,A]),Ft.set(T),Bt.set(null),S.data.x+=2,S.data.y+=2}return}if(D.key==="Escape"){ye();return}}let m=$(""),L=$("");function M(D,_){At.add(D,_)}function z(D){Tt.add(D)}function q(D){Bt.set(D),Ft.set(null)}function J(D){Ft.set(D),Bt.set(null)}function ye(){Bt.set(null),Ft.set(null)}function be(D,_,T){At.updateTerrain(D,{x:_,y:T})}function C(D,_,T){Tt.updateWall(D,{x:_,y:T})}function de(D,_){At.updateTerrain(D,{rotation:_})}function ee(D,_){Tt.updateWall(D,{rotation:_})}function Te(){n()?(At.remove(n()),Bt.set(null)):a()&&(Tt.remove(a()),Ft.set(null))}function Oe(){const D=parseFloat(t(m)),_=parseFloat(t(L));!isNaN(D)&&!isNaN(_)&&(n()?At.updateTerrain(n(),{x:D,y:_}):a()&&Tt.updateWall(a(),{x:D,y:_}))}function Pe(){b(y,""),b(g,!0)}function ve(){t(y).trim()&&(Bo(t(y).trim()),tn(),b(g,!1),b(y,""))}function ue(){tn(),b(h,!0)}function te(D){Fo(D),Bt.set(null),Ft.set(null),b(h,!1)}function we(D,_){_.stopPropagation(),confirm(`Delete layout "${D}"?`)&&(Xo(D),tn())}function Z(){confirm("Clear all terrain and walls?")&&(At.clear(),Tt.clear(),Bt.set(null),Ft.set(null))}function he(D){return new Date(D).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function K(D){const _=qn.find(T=>T.shape===D);return _?_.label:D}function re(){const D=i(),_=s(),T={version:1,exportedAt:Date.now(),terrains:D,walls:_},A=JSON.stringify(T,null,2),N=new Blob([A],{type:"application/json"}),X=URL.createObjectURL(N),V=document.createElement("a");V.href=X,V.download=`layout-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(X)}let ge=$();function ne(){t(ge).click()}function Me(D){const _=D.target.files[0];if(!_)return;const T=new FileReader;T.onload=A=>{try{const N=JSON.parse(A.target.result);N.terrains&&Array.isArray(N.terrains)&&At.set(N.terrains),N.walls&&Array.isArray(N.walls)&&Tt.set(N.walls),Bt.set(null),Ft.set(null)}catch(N){alert("Failed to import layout: Invalid file format"),console.error("Import error:",N)}},T.readAsText(_),D.target.value=""}G(()=>(i(),n()),()=>{b(d,i().find(D=>D.id===n()))}),G(()=>(s(),a()),()=>{b(v,s().find(D=>D.id===a()))}),G(()=>(t(d),t(v)),()=>{t(d)?(b(m,t(d).x.toFixed(1)),b(L,t(d).y.toFixed(1))):t(v)&&(b(m,t(v).x.toFixed(1)),b(L,t(v).y.toFixed(1)))}),_r(),zt();var ke=dl(),Ce=_e(ke),tt=p(x(Ce),2),Q=x(tt),U=x(Q);pt(U,{title:"Add Terrain",children:(D,_)=>{var T=Go();me(T,5,()=>Ri,Ie,(A,N)=>{var X=qo(),V=x(X);I(()=>Ee(V,(t(N),u(()=>t(N).label)))),F("click",X,()=>M(t(N).width,t(N).height)),w(A,X)}),w(D,T)},$$slots:{default:!0}});var pe=p(U,2);pt(pe,{title:"Add Wall",children:(D,_)=>{var T=Qo();me(T,5,()=>qn,Ie,(A,N)=>{var X=Jo(),V=x(X);I(()=>Ee(V,(t(N),u(()=>t(N).label)))),F("click",X,()=>z(t(N).shape)),w(A,X)}),w(D,T)},$$slots:{default:!0}});var B=p(pe,2);{let D=Ve(()=>t(d)?"Terrain":t(v)?"Wall":"Item");pt(B,{get title(){return`Selected ${t(D)??""}`},children:(_,T)=>{var A=et(),N=_e(A);{var X=Y=>{var W=rl(),H=x(W),ze=p(x(H),2),je=p(H,2),Ye=p(x(je),2),ct=p(je,2);{var ut=He=>{var Ge=el(),$t=_e(Ge),ur=p(x($t),2),qt=x(ur),xe=p($t,2),j=p(x(xe),2),qe=x(j);I(Fe=>{Ee(qt,`${t(d),u(()=>t(d).width)??""}" x ${t(d),u(()=>t(d).height)??""}"`),Ee(qe,`${Fe??""}Â°`)},[()=>(t(d),u(()=>Math.round(t(d).rotation)))]),w(He,Ge)},gt=He=>{var Ge=et(),$t=_e(Ge);{var ur=qt=>{var xe=tl(),j=_e(xe),qe=p(x(j),2),Fe=x(qe),E=p(j,2),ce=p(x(E),2),ot=x(ce);I((xt,Le)=>{Ee(Fe,xt),Ee(ot,`${Le??""}Â°`)},[()=>(t(v),u(()=>K(t(v).shape))),()=>(t(v),u(()=>Math.round(t(v).rotation)))]),w(qt,xe)};oe($t,qt=>{t(v)&&qt(ur)},!0)}w(He,Ge)};oe(ct,He=>{t(d)?He(ut):He(gt,!1)})}var rt=p(ct,2);an(ze,()=>t(m),He=>b(m,He)),F("change",ze,Oe),an(Ye,()=>t(L),He=>b(L,He)),F("change",Ye,Oe),F("click",rt,Te),w(Y,W)},V=Y=>{var W=nl();w(Y,W)};oe(N,Y=>{t(d)||t(v)?Y(X):Y(V,!1)})}w(_,A)},$$slots:{default:!0}})}var st=p(B,2);pt(st,{title:"Layout",children:(D,_)=>{var T=al(),A=x(T),N=p(A,2),X=p(N,2),V=x(X),Y=p(V,2),W=p(X,2);I(()=>N.disabled=(o(),u(()=>o().length===0))),F("click",A,Pe),F("click",N,ue),F("click",V,re),F("click",Y,ne),F("click",W,Z),w(D,T)},$$slots:{default:!0}});var at=p(st,2);ki(at,D=>b(ge,D),()=>t(ge));var Ze=p(Q,2),Re=x(Ze),ae=x(Re);On(ae,{children:na,$$slots:{default:(D,_)=>{const T=Ve(()=>_.screenToSvg);var A=il(),N=_e(A);me(N,1,i,V=>V.id,(V,Y)=>{{let W=Ve(()=>(t(Y),n(),u(()=>t(Y).id===n())));Ai(V,{get id(){return t(Y),u(()=>t(Y).id)},get x(){return t(Y),u(()=>t(Y).x)},get y(){return t(Y),u(()=>t(Y).y)},get width(){return t(Y),u(()=>t(Y).width)},get height(){return t(Y),u(()=>t(Y).height)},get rotation(){return t(Y),u(()=>t(Y).rotation)},get selected(){return t(W)},get screenToSvg(){return t(T)},onSelect:q,onDrag:be,onRotate:de})}});var X=p(N,2);me(X,1,s,V=>V.id,(V,Y)=>{{let W=Ve(()=>(t(Y),a(),u(()=>t(Y).id===a())));va(V,{get id(){return t(Y),u(()=>t(Y).id)},get x(){return t(Y),u(()=>t(Y).x)},get y(){return t(Y),u(()=>t(Y).y)},get shape(){return t(Y),u(()=>t(Y).shape)},get rotation(){return t(Y),u(()=>t(Y).rotation)},get selected(){return t(W)},get screenToSvg(){return t(T)},onSelect:J,onDrag:C,onRotate:ee})}}),w(D,A)}}});var k=p(Re,2),O=x(k),ie=x(O),We=p(Ce,2);{var Ne=D=>{var _=sl(),T=x(_),A=p(x(T),2),N=p(x(A),2),X=p(A,2),V=x(X),Y=p(V,2);I(W=>Y.disabled=W,[()=>(t(y),u(()=>!t(y).trim()))]),an(N,()=>t(y),W=>b(y,W)),F("keydown",N,W=>W.key==="Enter"&&ve()),F("click",V,()=>b(g,!1)),F("click",Y,ve),F("click",T,ka(function(W){Ta.call(this,r,W)})),F("click",_,()=>b(g,!1)),w(D,_)};oe(We,D=>{t(g)&&D(Ne)})}var $e=p(We,2);{var Ue=D=>{var _=ul(),T=x(_),A=p(x(T),2);{var N=W=>{var H=ol();w(W,H)},X=W=>{var H=cl();me(H,5,o,Ie,(ze,je)=>{var Ye=ll(),ct=x(Ye),ut=x(ct),gt=x(ut),rt=p(ut,2),He=x(rt),Ge=p(ct,2);I($t=>{Ee(gt,(t(je),u(()=>t(je).name))),Ee(He,`${t(je),u(()=>t(je).terrainCount)??""} terrain${t(je),u(()=>t(je).terrainCount!==1?"s":"")??""}, ${t(je),u(()=>t(je).wallCount||0)??""} wall${t(je),u(()=>(t(je).wallCount||0)!==1?"s":"")??""} Â· ${$t??""}`)},[()=>(t(je),u(()=>he(t(je).savedAt)))]),F("click",Ge,$t=>we(t(je).name,$t)),F("click",Ye,()=>te(t(je).name)),w(ze,Ye)}),w(W,H)};oe(A,W=>{o(),u(()=>o().length===0)?W(N):W(X,!1)})}var V=p(A,2),Y=x(V);F("click",Y,()=>b(h,!1)),F("click",T,ka(function(W){Ta.call(this,r,W)})),F("click",_,()=>b(h,!1)),w(D,_)};oe($e,D=>{t(h)&&D(Ue)})}I(()=>Ee(ie,`Battlefield: 60" x 44" | ${i(),u(()=>i().length)??""} terrain${i(),u(()=>i().length!==1?"s":"")??""} | ${s(),u(()=>s().length)??""} wall${s(),u(()=>s().length!==1?"s":"")??""}`)),F("change",at,Me),F("click",Re,ye),w(e,ke),Yt(),l()}const Wi=1/25.4,ji=40*Wi/2,Hi=3+20*Wi;function Yi(e="item"){return e+"-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function vl(){const{subscribe:e,set:r,update:n}=dt([]);return{subscribe:e,set:r,update:n,add(a){const i=Yi("zone");return n(s=>[...s,{id:i,...a}]),i},updateZone(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])}}}function hl(){const{subscribe:e,set:r,update:n}=dt([]);return{subscribe:e,set:r,update:n,add(a,i,s=!1){const o=Yi("obj"),c=Math.round(a),l=Math.round(i);return n(d=>[...d,{id:o,x:c,y:l,isPrimary:s}]),o},updateObjective(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},clear(){r([])}}}vl();hl();const yl=[{name:"Dawn of War",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:32},{type:"L",x:60,y:32},{type:"L",x:60,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:0,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:12},{type:"L",x:0,y:12},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:10,y:22,isPrimary:!1},{x:50,y:22,isPrimary:!1},{x:30,y:6,isPrimary:!1},{x:30,y:38,isPrimary:!1}]},{name:"Hammer and Anvil",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:18,y:0},{type:"L",x:18,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:42,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:44},{type:"L",x:42,y:44},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:30,y:6,isPrimary:!1},{x:30,y:38,isPrimary:!1},{x:10,y:22,isPrimary:!1},{x:50,y:22,isPrimary:!1}]},{name:"Tipping Point",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:12,y:0},{type:"L",x:12,y:22},{type:"L",x:20,y:22},{type:"L",x:20,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:40,y:0},{type:"L",x:60,y:0},{type:"L",x:60,y:44},{type:"L",x:48,y:44},{type:"L",x:48,y:22},{type:"L",x:40,y:22},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:14,y:34,isPrimary:!1},{x:22,y:8,isPrimary:!1},{x:38,y:36,isPrimary:!1},{x:46,y:10,isPrimary:!1}]},{name:"Search and Destroy",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:22},{type:"L",x:21,y:22},{type:"A",rx:9,ry:9,rotation:0,largeArc:0,sweep:0,x:30,y:31},{type:"L",x:30,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:30,y:0},{type:"L",x:30,y:13},{type:"A",rx:9,ry:9,rotation:0,largeArc:0,sweep:1,x:39,y:22},{type:"L",x:60,y:22},{type:"L",x:60,y:0},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:14,y:10,isPrimary:!1},{x:46,y:34,isPrimary:!1},{x:14,y:34,isPrimary:!1},{x:46,y:10,isPrimary:!1}]},{name:"Sweeping Engagement",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:0,y:8},{type:"L",x:30,y:8},{type:"L",x:30,y:14},{type:"L",x:60,y:14},{type:"L",x:60,y:0},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:0,y:44},{type:"L",x:60,y:44},{type:"L",x:60,y:36},{type:"L",x:30,y:36},{type:"L",x:30,y:30},{type:"L",x:0,y:30},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:10,y:18,isPrimary:!1},{x:50,y:26,isPrimary:!1},{x:18,y:38,isPrimary:!1},{x:42,y:6,isPrimary:!1}]},{name:"Crucible of Battle",zones:[{name:"Player 1",color:"rgba(59, 130, 246, 0.1)",borderColor:"#3b82f6",path:[{type:"M",x:0,y:0},{type:"L",x:30,y:44},{type:"L",x:0,y:44},{type:"Z"}]},{name:"Player 2",color:"rgba(239, 68, 68, 0.1)",borderColor:"#ef4444",path:[{type:"M",x:60,y:44},{type:"L",x:30,y:0},{type:"L",x:60,y:0},{type:"Z"}]}],objectives:[{x:30,y:22,isPrimary:!0},{x:20,y:8,isPrimary:!1},{x:40,y:36,isPrimary:!1},{x:14,y:34,isPrimary:!1},{x:46,y:10,isPrimary:!1}]}];function Gn(e){return e.map(r=>{switch(r.type){case"M":return`M ${r.x} ${r.y}`;case"L":return`L ${r.x} ${r.y}`;case"A":return`A ${r.rx} ${r.ry} ${r.rotation} ${r.largeArc} ${r.sweep} ${r.x} ${r.y}`;case"Z":return"Z";default:return""}}).join(" ")}const bn=dt(null),Wr=dt(null),sn=dt(null),Bi=mr([Wr,sn],([e,r])=>{if(!e)return{terrains:[],walls:[]};if(r==="preset"){const n=Ii.find(a=>a.name===e);return n?{terrains:n.terrains||[],walls:n.walls||[]}:{terrains:[],walls:[]}}else if(r==="saved"){const n=localStorage.getItem("warhammer-deployment-layouts");if(n)try{const a=JSON.parse(n);if(a[e])return{terrains:a[e].terrains||[],walls:a[e].walls||[]}}catch(a){console.error("Failed to load layout:",a)}}return{terrains:[],walls:[]}});var gl=se('<div class="selected-item svelte-1jotvmi"><span class="selected-name svelte-1jotvmi"> </span> <button class="small secondary svelte-1jotvmi">Change</button></div>'),pl=se('<button class="svelte-1jotvmi"> </button>'),xl=se('<div class="button-group svelte-1jotvmi"></div>'),_l=se('<div class="selected-item svelte-1jotvmi"><span class="selected-name svelte-1jotvmi"> </span> <button class="small secondary svelte-1jotvmi">Change</button></div>'),ml=se('<button class="svelte-1jotvmi"> </button>'),bl=se('<button class="svelte-1jotvmi"> </button>'),wl=se('<div class="layout-group svelte-1jotvmi"><h4 class="svelte-1jotvmi">Saved</h4> <div class="button-group svelte-1jotvmi"></div></div>'),Ll=se('<div class="layout-sections svelte-1jotvmi"><div class="layout-group svelte-1jotvmi"><h4 class="svelte-1jotvmi">Presets</h4> <div class="button-group svelte-1jotvmi"></div></div> <!></div>'),Sl=se('<div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Objectives:</span> <span class="value svelte-1jotvmi"> </span></div>'),Ml=se('<div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Pieces:</span> <span class="value svelte-1jotvmi"> </span></div>'),kl=se('<div class="summary svelte-1jotvmi"><div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Deployment:</span> <span class="value svelte-1jotvmi"> </span></div> <div class="summary-row svelte-1jotvmi"><span class="label svelte-1jotvmi">Terrain:</span> <span class="value svelte-1jotvmi"> </span></div> <!> <!></div>'),El=le('<path stroke-width="0.10" stroke-dasharray="0.5,0.25"></path>'),Tl=le('<circle stroke-width="0.05" stroke-dasharray="0.3,0.15"></circle><circle stroke="#000" stroke-width="0.06"></circle><circle r="0.15" fill="#000"></circle>',1),Pl=le("<!><!>",1),$l=le('<g><rect fill="rgba(139, 90, 43, 0.6)" stroke="#8b5a2b" stroke-width="0.1"></rect></g>'),Dl=le('<g><path fill="rgba(139, 69, 19, 0.8)" stroke="#5c3317" stroke-width="0.1"></path></g>'),Al=le("<!><!><!>",1),Cl=se('<main class="svelte-1jotvmi"><div class="header svelte-1jotvmi"><h1 class="svelte-1jotvmi">Battlefield Setup</h1> <nav class="nav-links svelte-1jotvmi"><a href="#/setup" class="active svelte-1jotvmi">Battlefield Setup</a> <a href="#/deployment" class="svelte-1jotvmi">Deployment</a> <a href="#/" class="svelte-1jotvmi">Layout Builder</a> <a href="#/debug" class="svelte-1jotvmi">Debug Mode</a></nav></div> <div class="layout svelte-1jotvmi"><div class="sidebar svelte-1jotvmi"><!> <!> <!></div> <div class="battlefield-area svelte-1jotvmi"><div class="battlefield-container svelte-1jotvmi"><!></div> <div class="info svelte-1jotvmi"><p class="svelte-1jotvmi">Battlefield: 60" x 44"</p> <p class="hint svelte-1jotvmi">Scroll to zoom | Space+drag to pan | Double-click to reset view</p></div></div></div></main>');function Rl(e,r){Ht(r,!1);const n=()=>Je(bn,"$selectedDeployment",o),a=()=>Je(Wr,"$selectedLayoutName",o),i=()=>Je(fa,"$savedLayoutsList",o),s=()=>Je(Bi,"$loadedTerrain",o),[o,c]=In();Gr(()=>{tn()});function l(C){bn.set(C)}function d(C){Wr.set(C.name),sn.set("preset")}function v(C){Wr.set(C),sn.set("saved")}function g(){Wr.set(null),sn.set(null)}function h(){bn.set(null)}function y(C){let ee=[];switch(C.shape){case"L-4x8":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];break;case"L-4x8-mirror":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:8},{x:-4+.5,y:8},{x:-4+.5,y:8-.5},{x:0,y:8-.5}];break;case"C-4-8-4":ee=[{x:0,y:0},{x:4,y:0},{x:4,y:.5},{x:.5,y:.5},{x:.5,y:8-.5},{x:4,y:8-.5},{x:4,y:8},{x:0,y:8}];break;case"L-5x6":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:5,y:6-.5},{x:5,y:6},{x:0,y:6}];break;case"L-5x6-mirror":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-5+.5,y:6},{x:-5+.5,y:6-.5},{x:0,y:6-.5}];break;case"L-4x6":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6-.5},{x:4,y:6-.5},{x:4,y:6},{x:0,y:6}];break;case"L-4x6-mirror":ee=[{x:0,y:0},{x:.5,y:0},{x:.5,y:6},{x:-4+.5,y:6},{x:-4+.5,y:6-.5},{x:0,y:6-.5}];break;default:return""}return`M ${ee.map(Te=>`${C.x+Te.x},${C.y+Te.y}`).join(" L ")} Z`}function S(C){switch(C.shape){case"L-4x8":return{x:C.x+2,y:C.y+4};case"L-4x8-mirror":return{x:C.x-2+.5,y:C.y+4};case"C-4-8-4":return{x:C.x+2,y:C.y+4};case"L-5x6":return{x:C.x+2.5,y:C.y+3};case"L-5x6-mirror":return{x:C.x-2.5+.5,y:C.y+3};case"L-4x6":return{x:C.x+2,y:C.y+3};case"L-4x6-mirror":return{x:C.x-2+.5,y:C.y+3};default:return{x:C.x,y:C.y}}}zt();var P=Cl(),m=p(x(P),2),L=x(m),M=x(L);pt(M,{title:"Deployment",children:(C,de)=>{var ee=et(),Te=_e(ee);{var Oe=ve=>{var ue=gl(),te=x(ue),we=x(te),Z=p(te,2);I(()=>Ee(we,n().name)),F("click",Z,h),w(ve,ue)},Pe=ve=>{var ue=xl();me(ue,5,()=>yl,Ie,(te,we)=>{var Z=pl(),he=x(Z);I(()=>Ee(he,t(we).name)),F("click",Z,()=>l(t(we))),w(te,Z)}),w(ve,ue)};oe(Te,ve=>{n()?ve(Oe):ve(Pe,!1)})}w(C,ee)},$$slots:{default:!0}});var z=p(M,2);pt(z,{title:"Terrain Layout",children:(C,de)=>{var ee=et(),Te=_e(ee);{var Oe=ve=>{var ue=_l(),te=x(ue),we=x(te),Z=p(te,2);I(()=>Ee(we,a())),F("click",Z,g),w(ve,ue)},Pe=ve=>{var ue=Ll(),te=x(ue),we=p(x(te),2);me(we,5,()=>Ii,Ie,(K,re)=>{var ge=ml(),ne=x(ge);I(()=>Ee(ne,t(re).name)),F("click",ge,()=>d(t(re))),w(K,ge)});var Z=p(te,2);{var he=K=>{var re=wl(),ge=p(x(re),2);me(ge,5,i,Ie,(ne,Me)=>{var ke=bl(),Ce=x(ke);I(()=>Ee(Ce,t(Me).name)),F("click",ke,()=>v(t(Me).name)),w(ne,ke)}),w(K,re)};oe(Z,K=>{i().length>0&&K(he)})}w(ve,ue)};oe(Te,ve=>{a()?ve(Oe):ve(Pe,!1)})}w(C,ee)},$$slots:{default:!0}});var q=p(z,2);pt(q,{title:"Summary",children:(C,de)=>{var ee=kl(),Te=x(ee),Oe=p(x(Te),2),Pe=x(Oe),ve=p(Te,2),ue=p(x(ve),2),te=x(ue),we=p(ve,2);{var Z=re=>{var ge=Sl(),ne=p(x(ge),2),Me=x(ne);I(()=>Ee(Me,n().objectives.length)),w(re,ge)};oe(we,re=>{n()&&re(Z)})}var he=p(we,2);{var K=re=>{var ge=Ml(),ne=p(x(ge),2),Me=x(ne);I(()=>Ee(Me,`${s().terrains.length??""} terrain, ${s().walls.length??""} walls`)),w(re,ge)};oe(he,re=>{(s().terrains.length>0||s().walls.length>0)&&re(K)})}I(()=>{Ee(Pe,n()?.name||"None"),Ee(te,a()||"None")}),w(C,ee)},$$slots:{default:!0}});var J=p(L,2),ye=x(J),be=x(ye);On(be,{children:(C,de)=>{var ee=Al(),Te=_e(ee);{var Oe=ue=>{var te=Pl(),we=_e(te);me(we,1,()=>n().zones,Ie,(he,K)=>{var re=El();I(ge=>{f(re,"d",ge),f(re,"fill",t(K).color),f(re,"stroke",t(K).borderColor)},[()=>Gn(t(K).path)]),w(he,re)});var Z=p(we);me(Z,1,()=>n().objectives,Ie,(he,K)=>{const re=Ve(()=>t(K).isPrimary?"#fbbf24":"#9ca3af"),ge=Ve(()=>t(K).isPrimary?"rgba(251, 191, 36, 0.15)":"rgba(156, 163, 175, 0.15)");var ne=Tl(),Me=_e(ne),ke=p(Me),Ce=p(ke);I(()=>{f(Me,"cx",t(K).x),f(Me,"cy",t(K).y),f(Me,"r",Hi),f(Me,"fill",t(ge)),f(Me,"stroke",t(re)),f(ke,"cx",t(K).x),f(ke,"cy",t(K).y),f(ke,"r",ji),f(ke,"fill",t(re)),f(Ce,"cx",t(K).x),f(Ce,"cy",t(K).y)}),w(he,ne)}),w(ue,te)};oe(Te,ue=>{n()&&ue(Oe)})}var Pe=p(Te);me(Pe,1,()=>s().terrains,Ie,(ue,te)=>{const we=Ve(()=>t(te).x+t(te).width/2),Z=Ve(()=>t(te).y+t(te).height/2);var he=$l(),K=x(he);I(()=>{f(he,"transform",`rotate(${t(te).rotation??""}, ${t(we)??""}, ${t(Z)??""})`),f(K,"x",t(te).x),f(K,"y",t(te).y),f(K,"width",t(te).width),f(K,"height",t(te).height)}),w(ue,he)});var ve=p(Pe);me(ve,1,()=>s().walls,Ie,(ue,te)=>{const we=Ve(()=>S(t(te)));var Z=Dl(),he=x(Z);I(K=>{f(Z,"transform",`rotate(${t(te).rotation??""}, ${t(we).x??""}, ${t(we).y??""})`),f(he,"d",K)},[()=>y(t(te))]),w(ue,Z)}),w(C,ee)},$$slots:{default:!0}}),w(e,P),Yt(),c()}const it=1/25.4,jt={circles:[{type:"25mm",radius:25*it/2,label:"25mm"},{type:"28.5mm",radius:28.5*it/2,label:"28mm.5"},{type:"32mm",radius:32*it/2,label:"32mm"},{type:"40mm",radius:40*it/2,label:"40mm"},{type:"50mm",radius:50*it/2,label:"50mm"},{type:"60mm",radius:60*it/2,label:"60mm"},{type:"80mm",radius:80*it/2,label:"80mm"},{type:"90mm",radius:90*it/2,label:"90mm"},{type:"100mm",radius:100*it/2,label:"100mm"},{type:"130mm",radius:130*it/2,label:"130mm"}],ovals:[{type:"60x35.5mm",width:60*it,height:35.5*it,label:"60Ã35.5mm"},{type:"75x42mm",width:75*it,height:42*it,label:"75Ã42mm"},{type:"90x52.5mm",width:90*it,height:52.5*it,label:"90Ã52.5mm"},{type:"105x70mm",width:105*it,height:70*it,label:"105Ã70mm"},{type:"120x90mm",width:120*it,height:90*it,label:"120Ã90mm"}]};function Qt(e,r=null){const n=jt.circles.find(i=>i.type===e);if(n)return n;const a=jt.ovals.find(i=>i.type===e);return a||(wr(e)&&r?{type:e,width:r.customWidth,height:r.customHeight,label:`${r.customWidth.toFixed(1)}"Ã${r.customHeight.toFixed(1)}"`}:null)}function er(e){return jt.ovals.some(r=>r.type===e)}function wr(e){return e&&e.startsWith("rect-")}function Il(){return"model-"+Date.now()+"-"+Math.random().toString(36).substr(2,9)}function Fi(){const{subscribe:e,set:r,update:n}=dt([]);return{subscribe:e,set:r,update:n,add(a,i,s,o,c=null){const l=Il(),d={id:l,baseType:a,playerId:i,x:s,y:o,rotation:0};return c&&c.width&&c.height&&(d.customWidth=c.width,d.customHeight=c.height),n(v=>[...v,d]),l},updateModel(a,i){n(s=>s.map(o=>o.id===a?{...o,...i}:o))},remove(a){n(i=>i.filter(s=>s.id!==a))},removeByPlayer(a){n(i=>i.filter(s=>s.playerId!==a))},clear(){r([])}}}const bt=Fi(),Ol=mr(bt,e=>e.filter(r=>r.playerId===1)),Nl=mr(bt,e=>e.filter(r=>r.playerId===2)),vr=dt(null);mr([bt,vr],([e,r])=>r?e.find(n=>n.id===r):null);const hr=Fi(),br=dt(null);mr([hr,br],([e,r])=>r?e.find(n=>n.id===r):null);var Wl=le('<g><rect role="button" tabindex="0" class="svelte-hycs6b"></rect></g>'),jl=le('<g><ellipse role="button" tabindex="0" class="svelte-hycs6b"></ellipse></g>'),Hl=le('<circle role="button" tabindex="0" class="svelte-hycs6b"></circle>'),Yl=le('<text text-anchor="middle" dominant-baseline="middle" font-size="0.4" font-weight="bold" fill="white" pointer-events="none" class="model-name"> </text>'),Bl=le('<line stroke-width="0.08" stroke-dasharray="0.2,0.1"></line><circle r="0.6" stroke-width="0.08" role="button" tabindex="0" class="rotate-handle svelte-hycs6b"></circle>',1),Fl=le("<g><!><!><!></g>");function Pn(e,r){Ht(r,!1);const n=$(),a=$(),i=$(),s=$(),o=$(),c=$(),l=$(),d=$(),v=$(),g=$(),h=$(),y=$(),S=$(),P=$(),m=$();let L=Se(r,"id",8),M=Se(r,"x",8),z=Se(r,"y",8),q=Se(r,"baseType",8),J=Se(r,"playerId",8),ye=Se(r,"rotation",8,0),be=Se(r,"selected",8,!1),C=Se(r,"name",8,""),de=Se(r,"customWidth",8,null),ee=Se(r,"customHeight",8,null),Te=Se(r,"screenToSvg",8),Oe=Se(r,"onSelect",8,()=>{}),Pe=Se(r,"onDrag",8,()=>{}),ve=Se(r,"onRotate",8,()=>{}),ue=Se(r,"onRename",8,()=>{}),te=$(!1),we=!1,Z={x:0,y:0};function he(ae){ae.stopPropagation(),Oe()(L())}function K(ae){ae.stopPropagation();const k=prompt("Model name:",C());k!==null&&ue()(L(),k)}function re(ae){if(ae.button!==0)return;ae.preventDefault(),ae.stopPropagation(),Oe()(L()),b(te,!0);const k=Te()(ae.clientX,ae.clientY);Z={x:k.x-M(),y:k.y-z()},window.addEventListener("mousemove",ge),window.addEventListener("mouseup",ne)}function ge(ae){if(!t(te))return;const k=Te()(ae.clientX,ae.clientY);let O=k.x-Z.x,ie=k.y-Z.y;Pe()(L(),O,ie)}function ne(){b(te,!1),window.removeEventListener("mousemove",ge),window.removeEventListener("mouseup",ne)}function Me(ae){ae.preventDefault(),ae.stopPropagation(),we=!0,window.addEventListener("mousemove",ke),window.addEventListener("mouseup",Ce)}function ke(ae){if(!we)return;const k=Te()(ae.clientX,ae.clientY),O=k.x-M(),ie=k.y-z();let We=Math.atan2(ie,O)*180/Math.PI+45;ae.shiftKey||(We=Math.round(We/15)*15),ve()(L(),We)}function Ce(){we=!1,window.removeEventListener("mousemove",ke),window.removeEventListener("mouseup",Ce)}G(()=>(R(de()),R(ee())),()=>{b(n,{customWidth:de(),customHeight:ee()})}),G(()=>(R(q()),t(n)),()=>{b(a,Qt(q(),t(n)))}),G(()=>R(q()),()=>{b(i,er(q()))}),G(()=>R(q()),()=>{b(s,wr(q()))}),G(()=>R(J()),()=>{b(o,J()===1?"#3b82f6":"#ef4444")}),G(()=>R(J()),()=>{b(c,J()===1?"rgba(59, 130, 246, 0.5)":"rgba(239, 68, 68, 0.5)")}),G(()=>R(be()),()=>{b(l,be()?.15:.1)}),G(()=>t(a),()=>{b(d,t(a)?.radius||.5)}),G(()=>t(a),()=>{b(v,t(a)?.width?t(a).width/2:0)}),G(()=>t(a),()=>{b(g,t(a)?.height?t(a).height/2:0)}),G(()=>(t(s),R(de())),()=>{b(h,t(s)&&de()||0)}),G(()=>(t(s),R(ee())),()=>{b(y,t(s)&&ee()||0)}),G(()=>(t(i),t(v),t(g),t(s),t(h),t(y)),()=>{b(S,t(i)?Math.max(t(v),t(g))+1:t(s)?Math.max(t(h),t(y))/2+1:0)}),G(()=>(R(M()),t(S),R(ye())),()=>{b(P,M()+t(S)*Math.cos((ye()-45)*Math.PI/180))}),G(()=>(R(z()),t(S),R(ye())),()=>{b(m,z()+t(S)*Math.sin((ye()-45)*Math.PI/180))}),_r(),zt();var tt=Fl();let Q;var U=x(tt);{var pe=ae=>{var k=Wl(),O=x(k);I(()=>{f(k,"transform",`rotate(${ye()??""}, ${M()??""}, ${z()??""})`),f(O,"x",M()-t(h)/2),f(O,"y",z()-t(y)/2),f(O,"width",t(h)),f(O,"height",t(y)),f(O,"fill",be()?t(o):t(c)),f(O,"stroke",t(o)),f(O,"stroke-width",t(l))}),F("click",O,he),F("dblclick",O,K),F("mousedown",O,re),w(ae,k)},B=ae=>{var k=et(),O=_e(k);{var ie=Ne=>{var $e=jl(),Ue=x($e);I(()=>{f($e,"transform",`rotate(${ye()??""}, ${M()??""}, ${z()??""})`),f(Ue,"cx",M()),f(Ue,"cy",z()),f(Ue,"rx",t(v)),f(Ue,"ry",t(g)),f(Ue,"fill",be()?t(o):t(c)),f(Ue,"stroke",t(o)),f(Ue,"stroke-width",t(l))}),F("click",Ue,he),F("dblclick",Ue,K),F("mousedown",Ue,re),w(Ne,$e)},We=Ne=>{var $e=Hl();I(()=>{f($e,"cx",M()),f($e,"cy",z()),f($e,"r",t(d)),f($e,"fill",be()?t(o):t(c)),f($e,"stroke",t(o)),f($e,"stroke-width",t(l))}),F("click",$e,he),F("dblclick",$e,K),F("mousedown",$e,re),w(Ne,$e)};oe(O,Ne=>{t(i)?Ne(ie):Ne(We,!1)},!0)}w(ae,k)};oe(U,ae=>{t(s)?ae(pe):ae(B,!1)})}var st=p(U);{var at=ae=>{var k=Yl(),O=x(k);I(()=>{f(k,"x",M()),f(k,"y",z()),Ee(O,C())}),w(ae,k)};oe(st,ae=>{C()&&ae(at)})}var Ze=p(st);{var Re=ae=>{var k=Bl(),O=_e(k),ie=p(O);I(()=>{f(O,"x1",M()),f(O,"y1",z()),f(O,"x2",t(P)),f(O,"y2",t(m)),f(O,"stroke",t(o)),f(ie,"cx",t(P)),f(ie,"cy",t(m)),f(ie,"fill",t(o)),f(ie,"stroke",J()===1?"#1d4ed8":"#b91c1c")}),F("mousedown",ie,Me),w(ae,k)};oe(Ze,ae=>{be()&&(t(i)||t(s))&&ae(Re)})}I(()=>Q=Ut(tt,0,"model-base svelte-hycs6b",null,Q,{selected:be(),dragging:t(te)})),w(e,tt),Yt()}var Xl=le('<ellipse fill="none" stroke-width="2"></ellipse>'),Ul=le('<circle fill="none" stroke-width="2"></circle>'),Kl=se('<button class="palette-item svelte-1urec28"><svg class="svelte-1urec28"><!></svg> <span class="label svelte-1urec28"> </span></button>');function $n(e,r){Ht(r,!1);const n=$(),a=$(),i=$(),s=$(),o=$(),c=$();let l=Se(r,"baseSize",8),d=Se(r,"playerId",8),v=Se(r,"onDragStart",8,()=>{});const g=3;function h(q){q.button===0&&(q.preventDefault(),v()(l(),q))}G(()=>R(d()),()=>{b(n,d()===1?"#3b82f6":"#ef4444")}),G(()=>R(l()),()=>{b(a,l().width!==void 0)}),G(()=>(t(a),R(l())),()=>{b(i,t(a)?null:l().radius*g)}),G(()=>(t(a),R(l())),()=>{b(s,t(a)?l().width/2*g:null)}),G(()=>(t(a),R(l())),()=>{b(o,t(a)?l().height/2*g:null)}),G(()=>(t(a),R(l())),()=>{b(c,t(a)?Math.max(l().width,l().height)*g:l().radius*2*g)}),_r(),zt();var y=Kl(),S=x(y),P=x(S);{var m=q=>{var J=Xl();I(()=>{f(J,"cx",(t(c)+8)/2),f(J,"cy",(t(c)+8)/2),f(J,"rx",t(s)),f(J,"ry",t(o)),f(J,"stroke",t(n))}),w(q,J)},L=q=>{var J=Ul();I(()=>{f(J,"cx",(t(c)+8)/2),f(J,"cy",(t(c)+8)/2),f(J,"r",t(i)),f(J,"stroke",t(n))}),w(q,J)};oe(P,q=>{t(a)?q(m):q(L,!1)})}var M=p(S,2),z=x(M);I(()=>{io(y,`border-color: ${t(n)??""}`),f(y,"title",(R(l()),u(()=>l().label))),f(S,"width",t(c)+8),f(S,"height",t(c)+8),f(S,"viewBox",`0 0 ${t(c)+8} ${t(c)+8}`),Ee(z,(R(l()),u(()=>l().label)))}),F("mousedown",y,h),w(e,y),Yt()}var Vl=se('<div class="player-toggle svelte-1g40uyy"><button>Player 1</button> <button>Player 2</button></div> <div class="base-palette svelte-1g40uyy"><div class="palette-section svelte-1g40uyy"><h4 class="svelte-1g40uyy">Circles</h4> <div class="palette-grid svelte-1g40uyy"></div></div> <div class="palette-section svelte-1g40uyy"><h4 class="svelte-1g40uyy">Ovals</h4> <div class="palette-grid svelte-1g40uyy"></div></div></div>',1),Zl=se('<div class="rect-hull-form svelte-1g40uyy"><div class="field svelte-1g40uyy"><label for="rect-width" class="svelte-1g40uyy">Width (inches)</label> <input id="rect-width" type="number" min="1" max="20" step="0.5" class="svelte-1g40uyy"/></div> <div class="field svelte-1g40uyy"><label for="rect-height" class="svelte-1g40uyy">Height (inches)</label> <input id="rect-height" type="number" min="1" max="20" step="0.5" class="svelte-1g40uyy"/></div> <button class="svelte-1g40uyy"> </button></div>'),zl=se('<div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Rotation</span> <span class="value svelte-1g40uyy"> </span></div>'),ql=se('<div class="field svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> Show Debug Rays</label></div>'),Gl=se('<div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">LoS Status</span> <span class="value svelte-1g40uyy"> </span></div>'),Jl=se('<div class="edit-form svelte-1g40uyy"><div class="field svelte-1g40uyy"><label for="model-name">Name</label> <input id="model-name" type="text"/></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Base Type</span> <span class="value svelte-1g40uyy"> </span></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Player</span> <span class="value svelte-1g40uyy"> </span></div> <div class="field svelte-1g40uyy"><span class="label-text svelte-1g40uyy">Position</span> <span class="value svelte-1g40uyy"> </span></div> <!> <div class="field svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> Show Line of Sight</label></div> <!> <!> <button class="danger svelte-1g40uyy">Remove</button></div>'),Ql=se('<p class="hint svelte-1g40uyy">Click a model to select it</p>'),ec=se('<div class="visualization-options svelte-1g40uyy"><label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> P1 Denial Zones (9")</label> <label class="checkbox-label svelte-1g40uyy"><input type="checkbox" class="svelte-1g40uyy"/> P2 Denial Zones (9")</label></div>'),tc=se('<div class="button-group vertical svelte-1g40uyy"><button class="svelte-1g40uyy">Save State</button> <button class="svelte-1g40uyy">Restore State</button> <button class="secondary svelte-1g40uyy">Clear All Models</button> <button class="secondary svelte-1g40uyy">Clear Saved State</button></div>'),rc=le('<path stroke-width="0.10" stroke-dasharray="0.5,0.25" pointer-events="none"></path>'),nc=le('<circle stroke-width="0.05" stroke-dasharray="0.3,0.15" pointer-events="none"></circle><circle stroke="#000" stroke-width="0.06" pointer-events="none"></circle><circle r="0.15" fill="#000" pointer-events="none"></circle>',1),ac=le("<!><!>",1),ic=le('<g><rect fill="rgba(59, 130, 246, 0.1)" stroke="rgba(59, 130, 246, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></rect></g>'),sc=le('<g><ellipse fill="rgba(59, 130, 246, 0.1)" stroke="rgba(59, 130, 246, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></ellipse></g>'),oc=le('<circle fill="rgba(59, 130, 246, 0.1)" stroke="rgba(59, 130, 246, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></circle>'),lc=le('<g><rect fill="rgba(239, 68, 68, 0.1)" stroke="rgba(239, 68, 68, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></rect></g>'),cc=le('<g><ellipse fill="rgba(239, 68, 68, 0.1)" stroke="rgba(239, 68, 68, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></ellipse></g>'),uc=le('<circle fill="rgba(239, 68, 68, 0.1)" stroke="rgba(239, 68, 68, 0.3)" stroke-width="0.1" stroke-dasharray="0.5,0.3" pointer-events="none"></circle>'),dc=le('<g><rect fill="rgba(139, 90, 43, 0.2)" stroke="#8b5a2b" stroke-width="0.1" pointer-events="none"></rect></g>'),fc=le('<g opacity="0.5" pointer-events="none"><!></g>'),vc=le('<line stroke-width="0.05" pointer-events="none"></line>'),hc=le('<line stroke="#22c55e" stroke-width="0.15" opacity="0.7" pointer-events="none"></line>'),yc=le('<line stroke="#ef4444" stroke-width="0.1" stroke-dasharray="0.5 0.25" opacity="0.7" pointer-events="none"></line>'),gc=le("<!><!><!><!><!><!><!><!><!><!>",1),pc=se('<main class="svelte-1g40uyy"><div class="header svelte-1g40uyy"><h1 class="svelte-1g40uyy">Deployment Practice</h1> <nav class="nav-links svelte-1g40uyy"><a href="#/setup" class="svelte-1g40uyy">Battlefield Setup</a> <a href="#/deployment" class="active svelte-1g40uyy">Deployment</a> <a href="#/" class="svelte-1g40uyy">Layout Builder</a> <a href="#/debug" class="svelte-1g40uyy">Debug Mode</a></nav></div> <div class="layout svelte-1g40uyy"><div class="sidebar svelte-1g40uyy"><!> <!> <!> <!> <!></div> <div class="battlefield-area svelte-1g40uyy"><div class="battlefield-container svelte-1g40uyy" role="presentation"><!></div> <div class="info svelte-1g40uyy"><p class="svelte-1g40uyy"> </p> <p class="hint svelte-1g40uyy">Press 1/2 to switch player | Press L to toggle LoS | Drag models to move</p></div></div></div></main>');function xc(e,r){Ht(r,!1);const n=()=>Je(bn,"$selectedDeployment",v),a=()=>Je(Wr,"$selectedLayoutName",v),i=()=>Je(sn,"$selectedLayoutType",v),s=()=>Je(bt,"$models",v),o=()=>Je(vr,"$selectedModelId",v),c=()=>Je(Bi,"$loadedTerrain",v),l=()=>Je(Ol,"$player1Models",v),d=()=>Je(Nl,"$player2Models",v),[v,g]=In(),h=$(),y=$(),S=$(),P=$(),m=$();let L=$(1),M=$(null),z=!1,q=null,J=$(null),ye=$(!1),be=$(!1),C=$(!1),de=$(!1),ee=$(5.5),Te=$(3);const Oe=5,Pe=9,ve="warhammer-deployment-state";function ue(){const _={deployment:n()?.name||null,layout:a()||null,layoutType:i()||null,models:s()};localStorage.setItem(ve,JSON.stringify(_))}function te(){const _=localStorage.getItem(ve);if(_)try{const T=JSON.parse(_);T.models&&Array.isArray(T.models)&&bt.set(T.models)}catch(T){console.error("Failed to restore deployment state:",T)}}function we(){localStorage.removeItem(ve),bt.clear()}Gr(()=>{window.addEventListener("keydown",Z)}),Ei(()=>{window.removeEventListener("keydown",Z)});function Z(_){if(_.target.tagName==="INPUT")return;const T=o();if(_.key==="1"){_.preventDefault(),b(L,1);return}if(_.key==="2"){_.preventDefault(),b(L,2);return}if(_.key==="l"||_.key==="L"){_.preventDefault(),b(ye,!t(ye));return}if((_.key==="Delete"||_.key==="Backspace")&&T){_.preventDefault(),Q();return}if(T&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(_.key)){_.preventDefault();const A=_.shiftKey?.1:1;let N=0,X=0;switch(_.key){case"ArrowUp":X=-A;break;case"ArrowDown":X=A;break;case"ArrowLeft":N=-A;break;case"ArrowRight":N=A;break}if(o()){const V=s().find(Y=>Y.id===o());V&&bt.updateModel(o(),{x:V.x+N,y:V.y+X})}return}if(_.key==="Escape"){he();return}}function he(){vr.set(null)}function K(_,T){if(!t(J))return;z=!0,q={x:T.clientX,y:T.clientY};const A=t(J)(T.clientX,T.clientY);b(M,{baseType:_.type,x:A.x,y:A.y}),window.addEventListener("mousemove",re),window.addEventListener("mouseup",ge)}function re(_){if(!z||!t(M)||!t(J))return;const T=t(J)(_.clientX,_.clientY);b(M,{...t(M),x:T.x,y:T.y})}function ge(_){if(!z||!t(M)){z=!1,b(M,null),q=null,window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ge);return}const T=_.clientX-q.x,A=_.clientY-q.y,N=Math.sqrt(T*T+A*A);let X,V;N<Oe?(X=30,V=22):(X=t(M).x,V=t(M).y);const Y=t(M).customWidth&&t(M).customHeight?{width:t(M).customWidth,height:t(M).customHeight}:null,W=bt.add(t(M).baseType,t(L),X,V,Y);vr.set(W),b(M,null),z=!1,q=null,window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",ge)}function ne(){const A={width:t(ee),height:t(Te)},N=bt.add("rect-custom",t(L),30,22,A);vr.set(N)}function Me(_){vr.set(_)}function ke(_,T,A){bt.updateModel(_,{x:T,y:A})}function Ce(_,T){bt.updateModel(_,{rotation:T})}function tt(_,T){bt.updateModel(_,{name:T})}function Q(){o()&&(bt.remove(o()),vr.set(null))}function U(){confirm("Clear all models?")&&(bt.clear(),vr.set(null))}function pe(_){if(wr(_.baseType))return{x:_.x,y:_.y,width:_.customWidth,height:_.customHeight,rotation:_.rotation||0,isRectangle:!0};const T=Qt(_.baseType,_);return er(_.baseType)?{x:_.x,y:_.y,rx:T.width/2,ry:T.height/2,rotation:_.rotation||0}:{x:_.x,y:_.y,radius:T.radius}}G(()=>(s(),o()),()=>{b(h,s().find(_=>_.id===o()))}),G(()=>(t(h),s()),()=>{b(y,t(h)?s().filter(_=>_.playerId!==t(h).playerId):[])}),G(()=>(c(),ln),()=>{b(S,c().terrains.map(_=>({id:_.id,vertices:ln(_)})))}),G(()=>(c(),Ur),()=>{b(P,c().walls.map(_=>da(Ur(_.shape),_.x,_.y,_.rotation)))}),G(()=>(t(h),t(ye),t(y),t(S),t(P)),()=>{b(m,t(h)&&t(ye)&&t(y).length>0?t(y).map(_=>{const T=$i(pe(t(h)),pe(_),t(S),t(P));return{targetId:_.id,target:_,canSee:T.canSee,firstClearRay:T.firstClearRay,rays:T.rays}}):[])}),_r(),zt();var B=pc(),st=p(x(B),2),at=x(st),Ze=x(at);pt(Ze,{title:"Add Models",children:(_,T)=>{var A=Vl(),N=_e(A),X=x(N);let V;var Y=p(X,2);let W;var H=p(N,2),ze=x(H),je=p(x(ze),2);me(je,5,()=>(R(jt),u(()=>jt.circles)),Ie,(ut,gt)=>{$n(ut,{get baseSize(){return t(gt)},get playerId(){return t(L)},onDragStart:K})});var Ye=p(ze,2),ct=p(x(Ye),2);me(ct,5,()=>(R(jt),u(()=>jt.ovals)),Ie,(ut,gt)=>{$n(ut,{get baseSize(){return t(gt)},get playerId(){return t(L)},onDragStart:K})}),I(()=>{V=Ut(X,1,"toggle-btn svelte-1g40uyy",null,V,{active:t(L)===1}),W=Ut(Y,1,"toggle-btn svelte-1g40uyy",null,W,{active:t(L)===2})}),F("click",X,()=>b(L,1)),F("click",Y,()=>b(L,2)),w(_,A)},$$slots:{default:!0}});var Re=p(Ze,2);pt(Re,{title:"Add Hull (Vehicle)",children:(_,T)=>{var A=Zl(),N=x(A),X=p(x(N),2),V=p(N,2),Y=p(x(V),2),W=p(V,2),H=x(W);I(()=>Ee(H,`Add ${t(ee)??""}" Ã ${t(Te)??""}" Hull`)),an(X,()=>t(ee),ze=>b(ee,ze)),an(Y,()=>t(Te),ze=>b(Te,ze)),F("click",W,ne),w(_,A)},$$slots:{default:!0}});var ae=p(Re,2);pt(ae,{title:"Selected Model",children:(_,T)=>{var A=et(),N=_e(A);{var X=Y=>{var W=Jl(),H=x(W),ze=p(x(H),2),je=p(H,2),Ye=p(x(je),2),ct=x(Ye),ut=p(je,2),gt=p(x(ut),2),rt=x(gt),He=p(ut,2),Ge=p(x(He),2),$t=x(Ge),ur=p(He,2);{var qt=Le=>{var De=zl(),Xe=p(x(De),2),Dt=x(Xe);I(nt=>Ee(Dt,`${nt??""}Â°`),[()=>(t(h),u(()=>Math.round(t(h).rotation||0)))]),w(Le,De)};oe(ur,Le=>{R(er),t(h),u(()=>er(t(h).baseType))&&Le(qt)})}var xe=p(ur,2),j=x(xe),qe=x(j),Fe=p(xe,2);{var E=Le=>{var De=ql(),Xe=x(De),Dt=x(Xe);en(Dt,()=>t(be),nt=>b(be,nt)),w(Le,De)};oe(Fe,Le=>{t(ye)&&Le(E)})}var ce=p(Fe,2);{var ot=Le=>{var De=Gl(),Xe=p(x(De),2),Dt=x(Xe);I(nt=>Ee(Dt,`${nt??""}/${t(m),u(()=>t(m).length)??""} visible`),[()=>(t(m),u(()=>t(m).filter(nt=>nt.canSee).length))]),w(Le,De)};oe(ce,Le=>{t(ye),t(m),u(()=>t(ye)&&t(m).length>0)&&Le(ot)})}var xt=p(ce,2);I((Le,De,Xe)=>{lo(ze,(t(h),u(()=>t(h).name||""))),Ee(ct,Le),Ee(rt,`Player ${t(h),u(()=>t(h).playerId)??""}`),Ee($t,`${De??""}", ${Xe??""}"`)},[()=>(R(Qt),t(h),u(()=>Qt(t(h).baseType,t(h))?.label||"Unknown")),()=>(t(h),u(()=>t(h).x.toFixed(1))),()=>(t(h),u(()=>t(h).y.toFixed(1)))]),F("change",ze,Le=>tt(t(h).id,Le.target.value)),en(qe,()=>t(ye),Le=>b(ye,Le)),F("click",xt,Q),w(Y,W)},V=Y=>{var W=Ql();w(Y,W)};oe(N,Y=>{t(h)?Y(X):Y(V,!1)})}w(_,A)},$$slots:{default:!0}});var k=p(ae,2);pt(k,{title:"Visualization",children:(_,T)=>{var A=ec(),N=x(A),X=x(N),V=p(N,2),Y=x(V);en(X,()=>t(C),W=>b(C,W)),en(Y,()=>t(de),W=>b(de,W)),w(_,A)},$$slots:{default:!0}});var O=p(k,2);pt(O,{title:"Actions",children:(_,T)=>{var A=tc(),N=x(A),X=p(N,2),V=p(X,2),Y=p(V,2);F("click",N,ue),F("click",X,te),F("click",V,U),F("click",Y,we),w(_,A)},$$slots:{default:!0}});var ie=p(at,2),We=x(ie),Ne=x(We);On(Ne,{children:na,$$slots:{default:(_,T)=>{const A=Ve(()=>T.screenToSvg);var N=gc(),X=_e(N);{var V=xe=>{var j=Li();I(()=>Ee(j,(t(J),R(t(A)),u(()=>(b(J,t(A)),""))))),w(xe,j)};oe(X,xe=>{t(A)&&!t(J)&&xe(V)})}var Y=p(X);{var W=xe=>{var j=ac(),qe=_e(j);me(qe,1,()=>(n(),u(()=>n().zones)),Ie,(E,ce)=>{var ot=rc();I(xt=>{f(ot,"d",xt),f(ot,"fill",(t(ce),u(()=>t(ce).color))),f(ot,"stroke",(t(ce),u(()=>t(ce).borderColor)))},[()=>(R(Gn),t(ce),u(()=>Gn(t(ce).path)))]),w(E,ot)});var Fe=p(qe);me(Fe,1,()=>(n(),u(()=>n().objectives)),Ie,(E,ce)=>{const ot=Ve(()=>(t(ce),u(()=>t(ce).isPrimary?"#fbbf24":"#9ca3af"))),xt=Ve(()=>(t(ce),u(()=>t(ce).isPrimary?"rgba(251, 191, 36, 0.15)":"rgba(156, 163, 175, 0.15)")));var Le=nc(),De=_e(Le),Xe=p(De),Dt=p(Xe);I(()=>{f(De,"cx",(t(ce),u(()=>t(ce).x))),f(De,"cy",(t(ce),u(()=>t(ce).y))),f(De,"r",Hi),f(De,"fill",t(xt)),f(De,"stroke",t(ot)),f(Xe,"cx",(t(ce),u(()=>t(ce).x))),f(Xe,"cy",(t(ce),u(()=>t(ce).y))),f(Xe,"r",ji),f(Xe,"fill",t(ot)),f(Dt,"cx",(t(ce),u(()=>t(ce).x))),f(Dt,"cy",(t(ce),u(()=>t(ce).y)))}),w(E,Le)}),w(xe,j)};oe(Y,xe=>{n()&&xe(W)})}var H=p(Y);{var ze=xe=>{var j=et(),qe=_e(j);me(qe,1,l,Fe=>Fe.id,(Fe,E)=>{const ce=Ve(()=>(R(Qt),t(E),u(()=>Qt(t(E).baseType,t(E))))),ot=Ve(()=>(R(er),t(E),u(()=>er(t(E).baseType)))),xt=Ve(()=>(R(wr),t(E),u(()=>wr(t(E).baseType))));var Le=et(),De=_e(Le);{var Xe=nt=>{var St=ic(),Mt=x(St);I(()=>{f(St,"transform",`rotate(${t(E),u(()=>t(E).rotation||0)??""}, ${t(E),u(()=>t(E).x)??""}, ${t(E),u(()=>t(E).y)??""})`),f(Mt,"x",(t(E),u(()=>t(E).x-(t(E).customWidth/2+Pe)))),f(Mt,"y",(t(E),u(()=>t(E).y-(t(E).customHeight/2+Pe)))),f(Mt,"width",(t(E),u(()=>t(E).customWidth+2*Pe))),f(Mt,"height",(t(E),u(()=>t(E).customHeight+2*Pe)))}),w(nt,St)},Dt=nt=>{var St=et(),Mt=_e(St);{var Nn=kt=>{var ft=sc(),Gt=x(ft);I(()=>{f(ft,"transform",`rotate(${t(E),u(()=>t(E).rotation||0)??""}, ${t(E),u(()=>t(E).x)??""}, ${t(E),u(()=>t(E).y)??""})`),f(Gt,"cx",(t(E),u(()=>t(E).x))),f(Gt,"cy",(t(E),u(()=>t(E).y))),f(Gt,"rx",(R(t(ce)),u(()=>t(ce).width/2+Pe))),f(Gt,"ry",(R(t(ce)),u(()=>t(ce).height/2+Pe)))}),w(kt,ft)},Wn=kt=>{var ft=oc();I(()=>{f(ft,"cx",(t(E),u(()=>t(E).x))),f(ft,"cy",(t(E),u(()=>t(E).y))),f(ft,"r",(R(t(ce)),u(()=>t(ce).radius+Pe)))}),w(kt,ft)};oe(Mt,kt=>{t(ot)?kt(Nn):kt(Wn,!1)},!0)}w(nt,St)};oe(De,nt=>{t(xt)?nt(Xe):nt(Dt,!1)})}w(Fe,Le)}),w(xe,j)};oe(H,xe=>{t(C)&&xe(ze)})}var je=p(H);{var Ye=xe=>{var j=et(),qe=_e(j);me(qe,1,d,Fe=>Fe.id,(Fe,E)=>{const ce=Ve(()=>(R(Qt),t(E),u(()=>Qt(t(E).baseType,t(E))))),ot=Ve(()=>(R(er),t(E),u(()=>er(t(E).baseType)))),xt=Ve(()=>(R(wr),t(E),u(()=>wr(t(E).baseType))));var Le=et(),De=_e(Le);{var Xe=nt=>{var St=lc(),Mt=x(St);I(()=>{f(St,"transform",`rotate(${t(E),u(()=>t(E).rotation||0)??""}, ${t(E),u(()=>t(E).x)??""}, ${t(E),u(()=>t(E).y)??""})`),f(Mt,"x",(t(E),u(()=>t(E).x-(t(E).customWidth/2+Pe)))),f(Mt,"y",(t(E),u(()=>t(E).y-(t(E).customHeight/2+Pe)))),f(Mt,"width",(t(E),u(()=>t(E).customWidth+2*Pe))),f(Mt,"height",(t(E),u(()=>t(E).customHeight+2*Pe)))}),w(nt,St)},Dt=nt=>{var St=et(),Mt=_e(St);{var Nn=kt=>{var ft=cc(),Gt=x(ft);I(()=>{f(ft,"transform",`rotate(${t(E),u(()=>t(E).rotation||0)??""}, ${t(E),u(()=>t(E).x)??""}, ${t(E),u(()=>t(E).y)??""})`),f(Gt,"cx",(t(E),u(()=>t(E).x))),f(Gt,"cy",(t(E),u(()=>t(E).y))),f(Gt,"rx",(R(t(ce)),u(()=>t(ce).width/2+Pe))),f(Gt,"ry",(R(t(ce)),u(()=>t(ce).height/2+Pe)))}),w(kt,ft)},Wn=kt=>{var ft=uc();I(()=>{f(ft,"cx",(t(E),u(()=>t(E).x))),f(ft,"cy",(t(E),u(()=>t(E).y))),f(ft,"r",(R(t(ce)),u(()=>t(ce).radius+Pe)))}),w(kt,ft)};oe(Mt,kt=>{t(ot)?kt(Nn):kt(Wn,!1)},!0)}w(nt,St)};oe(De,nt=>{t(xt)?nt(Xe):nt(Dt,!1)})}w(Fe,Le)}),w(xe,j)};oe(je,xe=>{t(de)&&xe(Ye)})}var ct=p(je);me(ct,1,()=>(c(),u(()=>c().terrains)),Ie,(xe,j)=>{var qe=dc(),Fe=x(qe);I(()=>{f(qe,"transform",`rotate(${t(j),u(()=>t(j).rotation)??""}, ${t(j),u(()=>t(j).x+t(j).width/2)??""}, ${t(j),u(()=>t(j).y+t(j).height/2)??""})`),f(Fe,"x",(t(j),u(()=>t(j).x))),f(Fe,"y",(t(j),u(()=>t(j).y))),f(Fe,"width",(t(j),u(()=>t(j).width))),f(Fe,"height",(t(j),u(()=>t(j).height)))}),w(xe,qe)});var ut=p(ct);me(ut,1,()=>(c(),u(()=>c().walls)),Ie,(xe,j)=>{var qe=fc(),Fe=x(qe);va(Fe,{get id(){return t(j),u(()=>t(j).id)},get x(){return t(j),u(()=>t(j).x)},get y(){return t(j),u(()=>t(j).y)},get shape(){return t(j),u(()=>t(j).shape)},get rotation(){return t(j),u(()=>t(j).rotation)},selected:!1,get screenToSvg(){return t(A)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}}),w(xe,qe)});var gt=p(ut);me(gt,1,s,xe=>xe.id,(xe,j)=>{{let qe=Ve(()=>(t(j),u(()=>t(j).name||""))),Fe=Ve(()=>(t(j),o(),u(()=>t(j).id===o())));Pn(xe,{get id(){return t(j),u(()=>t(j).id)},get x(){return t(j),u(()=>t(j).x)},get y(){return t(j),u(()=>t(j).y)},get baseType(){return t(j),u(()=>t(j).baseType)},get playerId(){return t(j),u(()=>t(j).playerId)},get rotation(){return t(j),u(()=>t(j).rotation)},get name(){return t(qe)},get customWidth(){return t(j),u(()=>t(j).customWidth)},get customHeight(){return t(j),u(()=>t(j).customHeight)},get selected(){return t(Fe)},get screenToSvg(){return t(A)},onSelect:Me,onDrag:ke,onRotate:Ce,onRename:tt})}});var rt=p(gt);{var He=xe=>{Pn(xe,{id:"phantom",get x(){return t(M),u(()=>t(M).x)},get y(){return t(M),u(()=>t(M).y)},get baseType(){return t(M),u(()=>t(M).baseType)},get playerId(){return t(L)},rotation:0,get customWidth(){return t(M),u(()=>t(M).customWidth)},get customHeight(){return t(M),u(()=>t(M).customHeight)},selected:!1,get screenToSvg(){return t(A)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}})};oe(rt,xe=>{t(M)&&xe(He)})}var Ge=p(rt);{var $t=xe=>{var j=et(),qe=_e(j);me(qe,1,()=>t(m),Ie,(Fe,E)=>{var ce=et(),ot=_e(ce);me(ot,1,()=>(t(E),u(()=>t(E).rays)),Ie,(xt,Le)=>{var De=vc();I(()=>{f(De,"x1",(t(Le),u(()=>t(Le).from.x))),f(De,"y1",(t(Le),u(()=>t(Le).from.y))),f(De,"x2",(t(Le),u(()=>t(Le).to.x))),f(De,"y2",(t(Le),u(()=>t(Le).to.y))),f(De,"stroke",(t(Le),u(()=>t(Le).blocked?"#ff000033":"#00ff0033")))}),w(xt,De)}),w(Fe,ce)}),w(xe,j)};oe(Ge,xe=>{t(be),t(ye),t(h),t(m),u(()=>t(be)&&t(ye)&&t(h)&&t(m).length>0)&&xe($t)})}var ur=p(Ge);{var qt=xe=>{var j=et(),qe=_e(j);me(qe,1,()=>t(m),Ie,(Fe,E)=>{var ce=et(),ot=_e(ce);{var xt=De=>{var Xe=hc();I(()=>{f(Xe,"x1",(t(E),u(()=>t(E).firstClearRay.from.x))),f(Xe,"y1",(t(E),u(()=>t(E).firstClearRay.from.y))),f(Xe,"x2",(t(E),u(()=>t(E).firstClearRay.to.x))),f(Xe,"y2",(t(E),u(()=>t(E).firstClearRay.to.y)))}),w(De,Xe)},Le=De=>{var Xe=yc();I(()=>{f(Xe,"x1",(t(h),u(()=>t(h).x))),f(Xe,"y1",(t(h),u(()=>t(h).y))),f(Xe,"x2",(t(E),u(()=>t(E).target.x))),f(Xe,"y2",(t(E),u(()=>t(E).target.y)))}),w(De,Xe)};oe(ot,De=>{t(E),u(()=>t(E).firstClearRay)?De(xt):De(Le,!1)})}w(Fe,ce)}),w(xe,j)};oe(ur,xe=>{t(ye),t(h),t(m),u(()=>t(ye)&&t(h)&&t(m).length>0)&&xe(qt)})}w(_,N)}}});var $e=p(We,2),Ue=x($e),D=x(Ue);I(()=>Ee(D,`Battlefield: 60" x 44" | ${l(),u(()=>l().length)??""} P1 models | ${d(),u(()=>d().length)??""} P2 models`)),F("click",We,he),w(e,B),Yt(),g()}var _c=se("<span> </span>"),mc=se('<span class="los-status svelte-12aohay">No enemies</span>'),bc=se('<div class="controls svelte-12aohay"><label class="svelte-12aohay"><input type="checkbox" class="svelte-12aohay"/> Show debug rays</label> <!></div>'),wc=se('<button class="svelte-12aohay"> </button>'),Lc=se('<div class="button-group svelte-12aohay"></div>'),Sc=se('<button class="svelte-12aohay"> </button>'),Mc=se('<div class="button-group svelte-12aohay"></div>'),kc=se('<div class="player-toggle svelte-12aohay"><button>Player 1</button> <button>Player 2</button></div> <div class="base-palette svelte-12aohay"><div class="palette-section svelte-12aohay"><h4 class="svelte-12aohay">Circles</h4> <div class="palette-grid svelte-12aohay"></div></div> <div class="palette-section svelte-12aohay"><h4 class="svelte-12aohay">Ovals</h4> <div class="palette-grid svelte-12aohay"></div></div></div>',1),Ec=le('<line stroke-width="0.05"></line>'),Tc=le('<line stroke="#22c55e" stroke-width="0.15" opacity="0.7" pointer-events="none"></line>'),Pc=le('<line stroke="#ef4444" stroke-width="0.1" stroke-dasharray="0.5 0.25" opacity="0.7" pointer-events="none"></line>'),$c=le("<!><!><!><!><!><!><!>",1),Dc=se('<p class="svelte-12aohay"> </p>'),Ac=se('<main class="svelte-12aohay"><div class="header svelte-12aohay"><h1 class="svelte-12aohay">Debug Mode</h1> <nav class="nav-links svelte-12aohay"><a href="#/setup" class="svelte-12aohay">Battlefield Setup</a> <a href="#/deployment" class="svelte-12aohay">Deployment</a> <a href="#/" class="svelte-12aohay">Layout Builder</a> <a href="#/debug" class="active svelte-12aohay">Debug Mode</a></nav></div> <div class="layout svelte-12aohay"><div class="sidebar svelte-12aohay"><!> <!> <!> <!></div> <div class="battlefield-area svelte-12aohay"><div class="battlefield-container svelte-12aohay"><!></div> <div class="info svelte-12aohay"><p class="svelte-12aohay"> </p> <!> <p class="hint svelte-12aohay">Scroll to zoom | Space+drag to pan | Double-click to reset view</p></div></div></div></main>');function Cc(e,r){Ht(r,!1);const n=()=>Je(hr,"$debugModels",d),a=()=>Je(br,"$debugSelectedModelId",d),i=()=>Je(gn,"$debugTerrains",d),s=()=>Je(pn,"$debugWalls",d),o=()=>Je(Ca,"$debugMode",d),c=()=>Je(xn,"$debugSelectedTerrainId",d),l=()=>Je(_n,"$debugSelectedWallId",d),[d,v]=In(),g=$(),h=$(),y=$(),S=$(),P=$();function m(k,O){gn.add(k,O)}function L(k){pn.add(k)}function M(k){xn.set(k),_n.set(null),br.set(null)}function z(k){_n.set(k),xn.set(null),br.set(null)}function q(k,O,ie){gn.updateTerrain(k,{x:O,y:ie})}function J(k,O,ie){pn.updateWall(k,{x:O,y:ie})}function ye(k,O){gn.updateTerrain(k,{rotation:O})}function be(k,O){pn.updateWall(k,{rotation:O})}let C=$(1),de=$(null),ee=!1,Te=null,Oe=$(null);const Pe=5;Gr(()=>{if(n().length===0){const k=hr.add("32mm",1,10,22);hr.add("32mm",2,50,22),br.set(k)}});function ve(k,O){if(!t(Oe))return;ee=!0,Te={x:O.clientX,y:O.clientY};const ie=t(Oe)(O.clientX,O.clientY);b(de,{baseType:k.type,x:ie.x,y:ie.y}),window.addEventListener("mousemove",ue),window.addEventListener("mouseup",te)}function ue(k){if(!ee||!t(de)||!t(Oe))return;const O=t(Oe)(k.clientX,k.clientY);b(de,{...t(de),x:O.x,y:O.y})}function te(k){if(!ee||!t(de)){ee=!1,b(de,null),Te=null,window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",te);return}const O=k.clientX-Te.x,ie=k.clientY-Te.y,We=Math.sqrt(O*O+ie*ie);let Ne,$e;We<Pe?(Ne=30,$e=22):(Ne=t(de).x,$e=t(de).y);const Ue=hr.add(t(de).baseType,t(C),Ne,$e);br.set(Ue),b(de,null),ee=!1,Te=null,window.removeEventListener("mousemove",ue),window.removeEventListener("mouseup",te)}function we(k){br.set(k),xn.set(null),_n.set(null)}function Z(k,O,ie){hr.updateModel(k,{x:O,y:ie})}function he(k,O){hr.updateModel(k,{rotation:O})}function K(k,O){hr.updateModel(k,{name:O})}function re(k){const O=Qt(k.baseType);return er(k.baseType)?{x:k.x,y:k.y,rx:O.width/2,ry:O.height/2,rotation:k.rotation||0}:{x:k.x,y:k.y,radius:O.radius}}G(()=>(n(),a()),()=>{b(g,n().find(k=>k.id===a()))}),G(()=>(t(g),n()),()=>{b(h,t(g)?n().filter(k=>k.playerId!==t(g).playerId):[])}),G(()=>(i(),ln),()=>{b(y,i().map(k=>({id:k.id,vertices:ln(k)})))}),G(()=>(s(),Ur),()=>{b(S,s().map(k=>da(Ur(k.shape),k.x,k.y,k.rotation)))}),G(()=>(t(g),t(h),t(y),t(S)),()=>{b(P,t(g)&&t(h).length>0?t(h).map(k=>{const O=$i(re(t(g)),re(k),t(y),t(S));return{targetId:k.id,target:k,canSee:O.canSee,firstClearRay:O.firstClearRay,rays:O.rays}}):[])}),_r(),zt();var ge=Ac(),ne=p(x(ge),2),Me=x(ne),ke=x(Me);pt(ke,{title:"LOS Debug",children:(k,O)=>{var ie=bc(),We=x(ie),Ne=x(We),$e=p(We,2);{var Ue=_=>{var T=_c();let A;var N=x(T);I((X,V)=>{A=Ut(T,1,"los-status svelte-12aohay",null,A,X),Ee(N,`${V??""}/${t(P),u(()=>t(P).length)??""} visible`)},[()=>({"can-see":t(P).some(X=>X.canSee),blocked:!t(P).some(X=>X.canSee)}),()=>(t(P),u(()=>t(P).filter(X=>X.canSee).length))]),w(_,T)},D=_=>{var T=mc();w(_,T)};oe($e,_=>{t(g),t(P),u(()=>t(g)&&t(P).length>0)?_(Ue):_(D,!1)})}en(Ne,o,_=>vo(Ca,_)),w(k,ie)},$$slots:{default:!0}});var Ce=p(ke,2);pt(Ce,{title:"Add Terrain",defaultOpen:!1,children:(k,O)=>{var ie=Lc();me(ie,5,()=>Ri,Ie,(We,Ne)=>{var $e=wc(),Ue=x($e);I(()=>Ee(Ue,(t(Ne),u(()=>t(Ne).label)))),F("click",$e,()=>m(t(Ne).width,t(Ne).height)),w(We,$e)}),w(k,ie)},$$slots:{default:!0}});var tt=p(Ce,2);pt(tt,{title:"Add Wall",defaultOpen:!1,children:(k,O)=>{var ie=Mc();me(ie,5,()=>qn,Ie,(We,Ne)=>{var $e=Sc(),Ue=x($e);I(()=>Ee(Ue,(t(Ne),u(()=>t(Ne).label)))),F("click",$e,()=>L(t(Ne).shape)),w(We,$e)}),w(k,ie)},$$slots:{default:!0}});var Q=p(tt,2);pt(Q,{title:"Add Models",defaultOpen:!1,children:(k,O)=>{var ie=kc(),We=_e(ie),Ne=x(We);let $e;var Ue=p(Ne,2);let D;var _=p(We,2),T=x(_),A=p(x(T),2);me(A,5,()=>(R(jt),u(()=>jt.circles)),Ie,(V,Y)=>{$n(V,{get baseSize(){return t(Y)},get playerId(){return t(C)},onDragStart:ve})});var N=p(T,2),X=p(x(N),2);me(X,5,()=>(R(jt),u(()=>jt.ovals)),Ie,(V,Y)=>{$n(V,{get baseSize(){return t(Y)},get playerId(){return t(C)},onDragStart:ve})}),I(()=>{$e=Ut(Ne,1,"toggle-btn svelte-12aohay",null,$e,{active:t(C)===1}),D=Ut(Ue,1,"toggle-btn svelte-12aohay",null,D,{active:t(C)===2})}),F("click",Ne,()=>b(C,1)),F("click",Ue,()=>b(C,2)),w(k,ie)},$$slots:{default:!0}});var U=p(Me,2),pe=x(U),B=x(pe);On(B,{children:na,$$slots:{default:(k,O)=>{const ie=Ve(()=>O.screenToSvg);var We=$c(),Ne=_e(We);{var $e=W=>{var H=Li();I(()=>Ee(H,(t(Oe),R(t(ie)),u(()=>(b(Oe,t(ie)),""))))),w(W,H)};oe(Ne,W=>{t(ie)&&!t(Oe)&&W($e)})}var Ue=p(Ne);{var D=W=>{var H=et(),ze=_e(H);me(ze,1,()=>t(P),Ie,(je,Ye)=>{var ct=et(),ut=_e(ct);me(ut,1,()=>(t(Ye),u(()=>t(Ye).rays)),Ie,(gt,rt)=>{var He=Ec();I(()=>{f(He,"x1",(t(rt),u(()=>t(rt).from.x))),f(He,"y1",(t(rt),u(()=>t(rt).from.y))),f(He,"x2",(t(rt),u(()=>t(rt).to.x))),f(He,"y2",(t(rt),u(()=>t(rt).to.y))),f(He,"stroke",(t(rt),u(()=>t(rt).blocked?"#ff000033":"#00ff0033")))}),w(gt,He)}),w(je,ct)}),w(W,H)};oe(Ue,W=>{o(),t(g),t(P),u(()=>o()&&t(g)&&t(P).length>0)&&W(D)})}var _=p(Ue);me(_,1,i,W=>W.id,(W,H)=>{{let ze=Ve(()=>(t(H),c(),u(()=>t(H).id===c())));Ai(W,{get id(){return t(H),u(()=>t(H).id)},get x(){return t(H),u(()=>t(H).x)},get y(){return t(H),u(()=>t(H).y)},get width(){return t(H),u(()=>t(H).width)},get height(){return t(H),u(()=>t(H).height)},get rotation(){return t(H),u(()=>t(H).rotation)},get selected(){return t(ze)},get screenToSvg(){return t(ie)},onSelect:M,onDrag:q,onRotate:ye})}});var T=p(_);me(T,1,s,W=>W.id,(W,H)=>{{let ze=Ve(()=>(t(H),l(),u(()=>t(H).id===l())));va(W,{get id(){return t(H),u(()=>t(H).id)},get x(){return t(H),u(()=>t(H).x)},get y(){return t(H),u(()=>t(H).y)},get shape(){return t(H),u(()=>t(H).shape)},get rotation(){return t(H),u(()=>t(H).rotation)},get selected(){return t(ze)},get screenToSvg(){return t(ie)},onSelect:z,onDrag:J,onRotate:be})}});var A=p(T);me(A,1,n,W=>W.id,(W,H)=>{{let ze=Ve(()=>(t(H),u(()=>t(H).name||""))),je=Ve(()=>(t(H),a(),u(()=>t(H).id===a())));Pn(W,{get id(){return t(H),u(()=>t(H).id)},get x(){return t(H),u(()=>t(H).x)},get y(){return t(H),u(()=>t(H).y)},get baseType(){return t(H),u(()=>t(H).baseType)},get playerId(){return t(H),u(()=>t(H).playerId)},get rotation(){return t(H),u(()=>t(H).rotation)},get name(){return t(ze)},get selected(){return t(je)},get screenToSvg(){return t(ie)},onSelect:we,onDrag:Z,onRotate:he,onRename:K})}});var N=p(A);{var X=W=>{var H=et(),ze=_e(H);me(ze,1,()=>t(P),Ie,(je,Ye)=>{var ct=et(),ut=_e(ct);{var gt=He=>{var Ge=Tc();I(()=>{f(Ge,"x1",(t(Ye),u(()=>t(Ye).firstClearRay.from.x))),f(Ge,"y1",(t(Ye),u(()=>t(Ye).firstClearRay.from.y))),f(Ge,"x2",(t(Ye),u(()=>t(Ye).firstClearRay.to.x))),f(Ge,"y2",(t(Ye),u(()=>t(Ye).firstClearRay.to.y)))}),w(He,Ge)},rt=He=>{var Ge=Pc();I(()=>{f(Ge,"x1",(t(g),u(()=>t(g).x))),f(Ge,"y1",(t(g),u(()=>t(g).y))),f(Ge,"x2",(t(Ye),u(()=>t(Ye).target.x))),f(Ge,"y2",(t(Ye),u(()=>t(Ye).target.y)))}),w(He,Ge)};oe(ut,He=>{t(Ye),u(()=>t(Ye).firstClearRay)?He(gt):He(rt,!1)})}w(je,ct)}),w(W,H)};oe(N,W=>{o(),t(g),t(P),u(()=>o()&&t(g)&&t(P).length>0)&&W(X)})}var V=p(N);{var Y=W=>{Pn(W,{id:"phantom",get x(){return t(de),u(()=>t(de).x)},get y(){return t(de),u(()=>t(de).y)},get baseType(){return t(de),u(()=>t(de).baseType)},get playerId(){return t(C)},rotation:0,selected:!1,get screenToSvg(){return t(ie)},onSelect:()=>{},onDrag:()=>{},onRotate:()=>{}})};oe(V,W=>{t(de)&&W(Y)})}w(k,We)}}});var st=p(pe,2),at=x(st),Ze=x(at),Re=p(at,2);{var ae=k=>{var O=Dc(),ie=x(O);I(We=>Ee(ie,`Selected model LOS: ${We??""}/${t(P),u(()=>t(P).length)??""} visible`),[()=>(t(P),u(()=>t(P).filter(We=>We.canSee).length))]),w(k,O)};oe(Re,k=>{o(),t(g),t(P),u(()=>o()&&t(g)&&t(P).length>0)&&k(ae)})}I(()=>Ee(Ze,`Battlefield: 60" x 44" | ${i(),u(()=>i().length)??""} terrain | ${s(),u(()=>s().length)??""} walls | ${n(),u(()=>n().length)??""} models`)),w(e,ge),Yt(),v()}function Rc(e,r){Ht(r,!1);let n=$("main");function a(){const l=window.location.hash;l==="#/debug"?b(n,"debug"):l==="#/setup"?b(n,"setup"):l==="#/deployment"?b(n,"deployment"):b(n,"setup")}Gr(()=>(a(),window.addEventListener("hashchange",a),()=>window.removeEventListener("hashchange",a))),zt();var i=et(),s=_e(i);{var o=l=>{Cc(l,{})},c=l=>{var d=et(),v=_e(d);{var g=y=>{Rl(y,{})},h=y=>{var S=et(),P=_e(S);{var m=M=>{xc(M,{})},L=M=>{fl(M,{})};oe(P,M=>{t(n)==="deployment"?M(m):M(L,!1)},!0)}w(y,S)};oe(v,y=>{t(n)==="setup"?y(g):y(h,!1)},!0)}w(l,d)};oe(s,l=>{t(n)==="debug"?l(o):l(c,!1)})}w(e,i),Yt()}qs(Rc,{target:document.getElementById("app")});
//# sourceMappingURL=index-C-hRsOqa.js.map
